

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Differential Expression analysis between P1 &amp; P2 &mdash; Isoform Specific Perturb-Seq  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Investigating Copy Number Variation Across KD Populations" href="9A_cnv_score.html" />
    <link rel="prev" title="Cell Assignment Model from FUCCI-Matched Single-Cell Paper" href="7_cellphase_model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Isoform Specific Perturb-Seq
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Analysis Pipeline:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../promoter_identification.html">Promoter Identification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide_design.html">Guide Design</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../analysis_scripts.html">Analysis Scripts &amp; Pipelines</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../analysis_scripts.html#preprocessing-guide-calling">Preprocessing &amp; Guide Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis_scripts.html#transcript-quantification">Transcript Quantification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis_scripts.html#transcriptional-divergence-e-stats">Transcriptional Divergence (E-Stats)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis_scripts.html#cell-phase-pathway-modeling">Cell Phase &amp; Pathway Modeling</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../analysis_scripts.html#clinical-differential-expression">Clinical &amp; Differential Expression</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="2A_cellranger_guidecalling.html">Guide Calling for Dual Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="2B_guide_calling_cellrangerfilter4_idealguides.html">Filtering for Cells with Ideal Combination of Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_estatistic_gene_guide.html">Guide Calling Using the Cellranger Module HDF5 File</a></li>
<li class="toctree-l3"><a class="reference internal" href="5_genekd_neighbouring_gene_expression.html">Target gene and neighbouring gene expression</a></li>
<li class="toctree-l3"><a class="reference internal" href="6_perturbseq_tsne_kldivergence_umap.html">Quantitative individual UMAPs per gene of interest</a></li>
<li class="toctree-l3"><a class="reference internal" href="7_cellphase_model.html">Cell Assignment Model from FUCCI-Matched Single-Cell Paper</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Differential Expression analysis between P1 &amp; P2</a></li>
<li class="toctree-l3"><a class="reference internal" href="9A_cnv_score.html">Investigating Copy Number Variation Across KD Populations</a></li>
<li class="toctree-l3"><a class="reference internal" href="9B_velocity_loom.html">Velocity and pyGSEA calculations of ESR1</a></li>
<li class="toctree-l3"><a class="reference internal" href="11_spectra.html">Spectra Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="12_negativecontrol.html">Guide Calling Using the Cellranger Module HDF5 File</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Isoform Specific Perturb-Seq</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../analysis_scripts.html">Analysis Scripts &amp; Pipelines</a></li>
      <li class="breadcrumb-item active">Differential Expression analysis between P1 &amp; P2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/scripts/3_analysis_scripts/8_perturbseq_differentialexpression.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Differential-Expression-analysis-between-P1-&amp;-P2">
<h1>Differential Expression analysis between P1 &amp; P2<a class="headerlink" href="#Differential-Expression-analysis-between-P1-&-P2" title="Link to this heading">ÔÉÅ</a></h1>
<ol class="arabic simple">
<li><p>Run through the 10x Cellranger pipeline and velocyto for single cell RNAseq quatification and using (2) guides quantifiction. all found in the cellranger files folder <strong>bash</strong></p></li>
<li><p>Guide Calling for dual guide. Use repogle method to take molecule.h5 generated by cellranger and py to run through repogle version of guide calling or use cellranger_guidecalling.ipynb for Direct Capture Perturb-Seq dual guide. Formed guide-specific lists of cells.</p></li>
<li><p>Pseudobulk analysis. A. Seperation of guide-specific fastq files. <strong>bash</strong> B. Whippet pseudobulk for transcript specific analysis, post UMI deduplication. <strong>bash</strong> C. Transcript quality control. <strong>R</strong> D. Whippet result visualisation.</p></li>
<li><p>Normalisation of adata object and E-distance of KD</p></li>
<li><p>Check gene and neighboring gene expression</p></li>
<li><p>Create individual umaps per gene of interest A. UMAPs B. Rand Index score</p></li>
<li><p>Cell phase assignment model from FUCCI-matched single cell paper (GSE146773)</p></li>
<li><p><strong>Differential Expression analysis.</strong> A. Find the shared P1 and P2 genes. B. Check the shared P1 and P2 across different protospacers with the same A/B and C/D.</p></li>
<li><p>CNV Score &amp; Numbat to quantify and Velocity quantification with loom file</p></li>
<li><p>ESR1-specific analysis from proliferation analysis to rt-qpcr</p></li>
<li><p>Spectra analysis and visualisation for pathway enrichment</p></li>
</ol>
<p>It performs the Systematic Differential Expression (DE) Analysis requested by reviewers to quantify and compare the transcriptional effects of P1 and P2 promoter knockdowns. The notebook identifies which genes change significantly in expression following the knockdown of a specific promoter compared to non-targeting controls (NTC).</p>
<p>Methodology: It utilizes the scanpy.tl.rank_genes_groups function, applying a t-test or Mann-Whitney U test (Z-score) to identify differentially expressed genes (DEGs).</p>
<p>Filtering Criteria: DEGs are strictly filtered based on a <span class="math notranslate nohighlight">\(log_{2}FC &gt; 0.5\)</span>, an adjusted p-value <span class="math notranslate nohighlight">\(&lt; 0.05\)</span>, and a requirement that the gene is expressed in <span class="math notranslate nohighlight">\(&gt; 10\%\)</span> of the cells in the perturbed population.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1">#general</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">anndata</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ad</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hdf5plugin</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gseapy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gp</span>

<span class="c1">#form a location</span>
<span class="n">loc</span><span class="o">=</span><span class="s2">&quot;../alt-prom-crispr-fiveprime/&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.notebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scperturb</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;scripts/&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">apu_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scperturb</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">infercnvpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cnv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">apu_analysis.cell_import</span><span class="w"> </span><span class="kn">import</span> <span class="n">CellPopulation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1">#for this python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">rel_entr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cluster</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">umap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.multitest</span><span class="w"> </span><span class="kn">import</span> <span class="n">multipletests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">reshape</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">array</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ttest_ind</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.multitest</span><span class="w"> </span><span class="kn">import</span> <span class="n">multipletests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">mannwhitneyu</span>

<span class="c1"># Taken from:</span>
<span class="c1"># Adamson, B.A., Norman, T.M., *et al.* &quot;A multiplexed CRISPR screening platform enables systematic dissection of the unfolded protein response&quot;, *Cell*, 2016.</span>
<span class="c1"># My experiment deals with two KDs- one of the MP, one of the AP using two guides. Positve controls include GINS1 ect. This is a combnatorial KD double for the same gene. No treatments were used</span>

<span class="c1"># colours using garvan</span>
<span class="n">color1</span> <span class="o">=</span><span class="s1">&#39;#4d00c7&#39;</span>
<span class="n">palecolor1</span><span class="o">=</span><span class="s2">&quot;#b366ff&quot;</span>
<span class="n">color2</span><span class="o">=</span> <span class="s1">&#39;#da3c07&#39;</span>
<span class="n">palecolor2</span><span class="o">=</span><span class="s2">&quot;#ff8954&quot;</span>
<span class="n">color3</span><span class="o">=</span><span class="s1">&#39;#05d3d3&#39;</span>
<span class="n">color4</span><span class="o">=</span><span class="s1">&#39;#c6c7c5&#39;</span>
<span class="n">color4</span><span class="o">=</span><span class="s2">&quot;#434541&quot;</span>
<span class="n">color5</span><span class="o">=</span><span class="s2">&quot;#eb31e1&quot;</span>
<span class="n">color6</span><span class="o">=</span><span class="s2">&quot;#3175eb&quot;</span>
<span class="n">color7</span><span class="o">=</span><span class="s2">&quot;#a7eb31&quot;</span>
<span class="n">color8</span><span class="o">=</span><span class="s2">&quot;#b366ff&quot;</span>
<span class="n">color9</span><span class="o">=</span><span class="s2">&quot;#ff8954&quot;</span>
<span class="n">color10</span><span class="o">=</span><span class="s2">&quot;#35c9d4&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_gsea_for_gene</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">gene</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gene</span><span class="p">)</span>

    <span class="n">gene_AP</span> <span class="o">=</span> <span class="n">gene</span> <span class="o">+</span> <span class="s2">&quot;_AP&quot;</span>
    <span class="n">gene_MP</span> <span class="o">=</span> <span class="n">gene</span> <span class="o">+</span> <span class="s2">&quot;_MP&quot;</span>

    <span class="c1"># ---------- MP GUIDE ----------</span>
    <span class="c1"># get full DE table (NO pval/logFC cutoff for GSEA)</span>
    <span class="n">MP_rank</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_MP</span><span class="p">,</span> <span class="n">pval_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># make a 2-column ranking like your STIM example:</span>
    <span class="c1">#   [names, logfoldchanges]</span>
    <span class="n">mp_rnk</span> <span class="o">=</span> <span class="n">MP_rank</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># run prerank</span>
    <span class="n">pre_res_mp</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">prerank</span><span class="p">(</span>
        <span class="n">rnk</span><span class="o">=</span><span class="n">mp_rnk</span><span class="p">,</span>                 <span class="c1"># DataFrame with [gene, score]</span>
        <span class="n">gene_sets</span><span class="o">=</span><span class="s2">&quot;GO_Biological_Process_2021&quot;</span><span class="p">,</span>      <span class="c1"># or your favourite collection</span>
        <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                <span class="c1"># don&#39;t write files</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span>
    <span class="p">)</span>

    <span class="c1"># grab the result table</span>
    <span class="n">mp_res_df</span> <span class="o">=</span> <span class="n">pre_res_mp</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene</span>
    <span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_MP</span>
    <span class="c1"># classify direction by NES sign</span>
    <span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">,</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span>
    <span class="n">gsea_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp_res_df</span><span class="p">)</span>

    <span class="c1"># ---------- AP GUIDE ----------</span>
    <span class="n">AP_rank</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_AP</span><span class="p">,</span> <span class="n">pval_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">ap_rnk</span> <span class="o">=</span> <span class="n">AP_rank</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="n">pre_res_ap</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">prerank</span><span class="p">(</span>
        <span class="n">rnk</span><span class="o">=</span><span class="n">ap_rnk</span><span class="p">,</span>
        <span class="n">gene_sets</span><span class="o">=</span><span class="s2">&quot;GO_Biological_Process_2021&quot;</span><span class="p">,</span>
        <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span>
    <span class="p">)</span>

    <span class="n">ap_res_df</span> <span class="o">=</span> <span class="n">pre_res_ap</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene</span>
    <span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_AP</span>
    <span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">,</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span>
    <span class="c1">#add together ap_ res_df and mp_res_df</span>
    <span class="n">combined_res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mp_res_df</span><span class="p">,</span> <span class="n">ap_res_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combined_res_df</span> <span class="p">,</span><span class="n">pre_res_ap</span><span class="p">,</span> <span class="n">pre_res_mp</span>

<span class="n">FDR</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">LOG_FOLD_CHANGE</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># Create the color palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">([</span><span class="n">palecolor1</span><span class="p">,</span><span class="n">palecolor2</span><span class="p">,</span><span class="n">color3</span><span class="p">,</span><span class="n">color4</span><span class="p">])</span>
<span class="n">palette2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">([</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span> <span class="n">palecolor1</span><span class="p">,</span> <span class="n">palecolor2</span><span class="p">,</span><span class="n">color5</span><span class="p">,</span><span class="n">color6</span> <span class="p">,</span><span class="n">color7</span><span class="p">])</span>

<span class="c1"># # Create the color palette</span>
<span class="c1"># palette = sns.color_palette([color1, color2,color3])</span>
<span class="n">new_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">([</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">,</span> <span class="n">color3</span><span class="p">,</span> <span class="n">color4</span><span class="p">])</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randrange</span>
<span class="n">pvalue</span><span class="o">=</span><span class="mf">0.05</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scanpy&quot;</span><span class="p">,</span> <span class="n">sc</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
Scanpy 1.10.3
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;files/adata_normalised_cellcycle.h5ad&quot;</span><span class="p">)</span>
<span class="c1">#set the directio</span>
<span class="c1">#perform log1p on the data</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_assignment_simple&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(((</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_assignment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;non&quot;</span><span class="p">))</span><span class="o">|</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_assignment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Non&quot;</span><span class="p">))),</span> <span class="s2">&quot;non-targeting&quot;</span><span class="p">,</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_assignment&quot;</span><span class="p">])</span>
<span class="n">gene_list_select</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_assignment_simple&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_assignment_simple&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="c1"># sc.tl.rank_genes_groups(adata, &#39;guide_assignment_simple&#39;, groups=gene_list_select,reference=&quot;non-targeting&quot;, method=&#39;wilcoxon&#39;, use_raw=False)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_genes_groups</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">&#39;guide_assignment_simple&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">gene_list_select</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s2">&quot;non-targeting&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;t-test&#39;</span><span class="p">,</span> <span class="n">use_raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
... storing &#39;guide_assignment_simple&#39; as categorical
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get the differentially expressed genes</span>
<span class="c1"># %%capture</span>
<span class="n">gene_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pvalue</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">number</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">sortby</span><span class="o">=</span><span class="s2">&quot;pvals_adj_1&quot;</span>
<span class="n">min_fc</span><span class="o">=</span><span class="mf">0.5</span>
<span class="c1">#get the highly_variable genes</span>
<span class="n">extract_highly_variable_genes</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;highly_variable&quot;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">gene_list_recursive</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;perturbation&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#remove ARNT and if gene_A CSNK1E</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get the differentially expressed genes</span>
<span class="c1"># %%capture</span>
<span class="n">gene_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pvalue</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">logFC</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">number</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">sortby</span><span class="o">=</span><span class="s2">&quot;rank_1&quot;</span>
<span class="n">min_fc</span><span class="o">=</span><span class="mi">1</span>
<span class="c1">#get the highly_variable genes</span>
<span class="n">extract_highly_variable_genes</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;highly_variable&quot;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">gene_list_recursive</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;perturbation&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#remove ARNT and if gene_A CSNK1E</span>
<span class="n">gene_list_recursive</span><span class="o">=</span><span class="n">gene_list_recursive</span><span class="p">[</span><span class="o">~</span><span class="n">gene_list_recursive</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;ARNT&quot;</span><span class="p">,</span><span class="s2">&quot;CSNK1E&quot;</span><span class="p">])]</span>
<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;perturbation&quot;</span><span class="p">][(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;successfulKD&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;True&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># print(gene)</span>
    <span class="c1">#AP</span>
    <span class="n">gene_AP</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_AP&quot;</span>
    <span class="k">if</span> <span class="n">gene_AP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="n">gene</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ARNT&quot;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ARNT&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">promoter</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MP&quot;</span><span class="p">,</span><span class="s2">&quot;AP&quot;</span><span class="p">]:</span>
            <span class="n">gene_promoter</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">gene_promoter_2</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">gene_promoter_random_1</span><span class="o">=</span><span class="n">gene_list_recursive</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list_recursive</span><span class="p">))]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">gene_promoter_random_2</span><span class="o">=</span><span class="n">gene_list_recursive</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list_recursive</span><span class="p">))]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1">##form a dataframe with custom colummns</span>
            <span class="c1">#subset random gene from gene list</span>
            <span class="n">protospacer_1</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="c1">#order by the absolute value of the logfoldchange</span>
            <span class="n">protospacer_1</span><span class="p">[</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">protospacer_1</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
            <span class="n">protospacer_1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1">#add a rank column</span>
            <span class="n">protospacer_1</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">protospacer_2</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter_2</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_2</span><span class="p">[</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">protospacer_2</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
            <span class="n">protospacer_2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1">#add a rank column</span>
            <span class="n">protospacer_2</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">protospacer_1_random</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter_random_1</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_1_random</span><span class="p">[</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">protospacer_1_random</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
            <span class="n">protospacer_1_random</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1">#add a rank column</span>
            <span class="n">protospacer_1_random</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_1_random</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">protospacer_2_random</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter_random_2</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_2_random</span><span class="p">[</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">protospacer_2_random</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
            <span class="n">protospacer_2_random</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;abs_logfoldchanges&quot;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1">#add a rank column</span>
            <span class="n">protospacer_2_random</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_2_random</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">gene_df</span><span class="o">=</span><span class="n">protospacer_1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">protospacer_2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_1&#39;</span><span class="p">,</span> <span class="s1">&#39;_2&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="c1">#filter for highly variable genes</span>
            <span class="n">gene_df_random_1</span><span class="o">=</span><span class="n">protospacer_1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">protospacer_1_random</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_1&#39;</span><span class="p">,</span> <span class="s1">&#39;_2&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">gene_df_random_2</span><span class="o">=</span><span class="n">protospacer_1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">protospacer_2_random</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_1&#39;</span><span class="p">,</span> <span class="s1">&#39;_2&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">rank_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rank_1&quot;</span><span class="p">,</span><span class="s2">&quot;rank_2&quot;</span><span class="p">]</span>
            <span class="c1">#get the correlation for  scores_1 and scores_2 for corr</span>
            <span class="n">correlation_1</span><span class="o">=</span><span class="n">gene_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">sortby</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">rank_columns</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">,</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">correlation_random_1</span><span class="o">=</span><span class="n">gene_df_random_1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">sortby</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">rank_columns</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">,</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">correlation_random_2</span><span class="o">=</span><span class="n">gene_df_random_2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">sortby</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">rank_columns</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">,</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1">#create a row wtht he gene name</span>
            <span class="n">gene_list_row</span><span class="o">=</span><span class="p">[</span><span class="n">gene</span><span class="p">,</span><span class="n">promoter</span><span class="p">]</span>
            <span class="n">gene_list_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">correlation_1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;rank_1&quot;</span><span class="p">,</span><span class="s2">&quot;rank_2&quot;</span><span class="p">],</span><span class="n">correlation_random_1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;rank_1&quot;</span><span class="p">,</span><span class="s2">&quot;rank_2&quot;</span><span class="p">],</span><span class="n">correlation_random_2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;rank_1&quot;</span><span class="p">,</span><span class="s2">&quot;rank_2&quot;</span><span class="p">]])</span>
            <span class="n">gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene_list_row</span><span class="p">)</span>


<span class="c1">#flatten list of lists into dataframe</span>
<span class="n">gene_df_final</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gene_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span><span class="s2">&quot;promoter&quot;</span><span class="p">,</span><span class="s2">&quot;scores_1_targeted&quot;</span><span class="p">,</span><span class="s2">&quot;scores_1_random&quot;</span><span class="p">,</span><span class="s2">&quot;scores_2_random&quot;</span><span class="p">])</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get the differentially expressed genes</span>
<span class="c1"># %%capture</span>
<span class="c1"># pvalue=0.05</span>
<span class="n">gene_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">gene_list_recursive</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;perturbation&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#remove ARNT and if gene_A CSNK1E</span>
<span class="n">gene_list_recursive</span><span class="o">=</span><span class="n">gene_list_recursive</span><span class="p">[</span><span class="o">~</span><span class="n">gene_list_recursive</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;ARNT&quot;</span><span class="p">,</span><span class="s2">&quot;CSNK1E&quot;</span><span class="p">])]</span>
<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;perturbation&quot;</span><span class="p">][(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;successfulKD&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;True&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gene</span><span class="p">)</span>
    <span class="c1">#AP</span>
    <span class="n">gene_AP</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_AP&quot;</span>
    <span class="k">if</span> <span class="n">gene_AP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="n">gene</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ARNT&quot;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ARNT&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">promoter</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MP&quot;</span><span class="p">,</span><span class="s2">&quot;AP&quot;</span><span class="p">]:</span>
            <span class="n">gene_promoter</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">protospacer_1</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_1</span><span class="o">=</span><span class="n">protospacer_1</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">gene_promoter</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">protospacer_2</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_2</span><span class="o">=</span><span class="n">protospacer_2</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">gene_promoter</span><span class="o">=</span><span class="n">gene_list_recursive</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list_recursive</span><span class="p">))]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">protospacer_1_random</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_1_random</span><span class="o">=</span><span class="n">protospacer_1_random</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">gene_promoter</span><span class="o">=</span><span class="n">gene_list_recursive</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list_recursive</span><span class="p">))]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">promoter</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">protospacer_2_random</span><span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_promoter</span><span class="p">,</span><span class="n">pval_cutoff</span><span class="o">=</span><span class="n">pvalue</span><span class="p">)</span>
            <span class="n">protospacer_2_random</span><span class="o">=</span><span class="n">protospacer_2_random</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


            <span class="n">overlap</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">protospacer_1</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">protospacer_2</span><span class="p">]</span>
            <span class="n">overlap_random_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">overlap</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">protospacer_1_random</span><span class="p">]</span>
            <span class="n">overlap_random_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">overlap</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">protospacer_2_random</span><span class="p">]</span>
            <span class="c1">#if overlap protospacer_1 protospacer_2 overlap_random_2 overlap_random_1 = 0 set to 1</span>
            <span class="c1"># print(protospacer_1,protospacer_2,overlap,overlap_random_1,overlap_random_2)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">overlap_1</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_1</span><span class="p">)</span>
                <span class="n">overlap_2</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_2</span><span class="p">)</span>
                <span class="n">overlap_random_1</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">overlap_random_1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_1_random</span><span class="p">)</span>
                <span class="n">overlap_random_2</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">overlap_random_2</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">protospacer_2_random</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
                <span class="n">overlap_1</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">overlap_2</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">overlap_random_1</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">overlap_random_2</span><span class="o">=</span><span class="mi">0</span>

            <span class="n">gene_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">gene</span><span class="p">,</span><span class="n">promoter</span><span class="p">,</span><span class="n">overlap_1</span><span class="p">,</span><span class="n">overlap_2</span><span class="p">,</span><span class="n">overlap_random_1</span><span class="p">,</span><span class="n">overlap_random_2</span><span class="p">]])</span>
            <span class="c1"># gene_df_details=pd.DataFrame([[gene,promoter,protospacer_1,protospacer_2,overlap,len(protospacer_1),len(protospacer_2),len(overlap)]])</span>

            <span class="c1"># print(gene_df.shape)</span>
            <span class="n">gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene_df</span><span class="p">)</span>
            <span class="c1"># break</span>


<span class="c1"># col_names=[&quot;Gene&quot;,&quot;Promoter&quot;,&quot;Protospacer_1&quot;,&quot;Protospacer_2&quot;,&quot;Overlap&quot;,&quot;Protospacer_Random_1&quot;,&quot;Protospacer_Random_2&quot;]</span>
<span class="c1">#add col_names</span>
<span class="n">col_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gene&quot;</span><span class="p">,</span><span class="s2">&quot;Promoter&quot;</span><span class="p">,</span><span class="s2">&quot;Overlap_1&quot;</span><span class="p">,</span><span class="s2">&quot;Overlap_2&quot;</span><span class="p">,</span><span class="s2">&quot;Overlap_Random_1&quot;</span><span class="p">,</span><span class="s2">&quot;Overlap_Random_2&quot;</span><span class="p">]</span>
<span class="nb">all</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gene_list</span><span class="p">))</span>
<span class="nb">all</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">col_names</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AHCYL1
SP1
TGIF1
YWHAZ
P4HB
NCOR2
JARID2
ESR1
PA2G4
GPBP1
DHX30
SAFB
NFE2L2
CHD8
SIN3A
PSMC5
RC3H2
ZNF3
GTF2F1
ADAR
NR2F2
BZW1
FHL2
SET
MYBBP1A
CUX1
NBN
CALR
APP
STAG2
PKM
BRIP1
GATA3
RBM47
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get the tests between two unpaired parametric groups</span>
<span class="c1">#melt for random</span>
<span class="n">all_melt</span><span class="o">=</span><span class="nb">all</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gene&quot;</span><span class="p">,</span><span class="s2">&quot;Promoter&quot;</span><span class="p">])</span>
<span class="nb">all</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Gene&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Promoter&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_1&quot;</span><span class="p">],</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_2&quot;</span><span class="p">],</span><span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_Random_1&quot;</span><span class="p">],</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_Random_2&quot;</span><span class="p">],</span><span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_1&quot;</span><span class="p">],</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_Random_1&quot;</span><span class="p">],</span><span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_2&quot;</span><span class="p">],</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_Random_2&quot;</span><span class="p">],</span><span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TtestResult(statistic=-1.200758436011414, pvalue=0.23196364293947955, df=133.97197243239725)
TtestResult(statistic=-0.8170297166398177, pvalue=0.4153781706070453, df=132.49121568852897)
TtestResult(statistic=10.428675297500293, pvalue=2.596256035375967e-18, df=114.67625808804517)
TtestResult(statistic=10.723518386158062, pvalue=2.9404501919466304e-19, df=120.79414195321442)
</pre></div></div>
</div>
<p>A central goal of this notebook is to determine the degree of overlap between the pathways regulated by different promoters of the same gene.</p>
<p>Limited Overlap: The analysis reveals that for most genes, there is minimal overlap between the DEGs affected by P1 versus P2 knockdown. This supports the conclusion that alternative promoters regulate largely distinct downstream pathways.</p>
<p>Z-Score Correlation: For the small subset of shared DEGs, the notebook calculates Pearson correlations of Z-scores. As shown in the study, these shared genes typically show high positive correlations, indicating a coherent regulatory response even when the number of shared genes is small.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plot the overlap between the two guides</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">new_pallete</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">([</span><span class="s2">&quot;#B4D88C&quot;</span><span class="p">,</span><span class="s2">&quot;#C67B6A&quot;</span><span class="p">,</span><span class="s2">&quot;#53449B&quot;</span><span class="p">,</span><span class="s2">&quot;#8C1F1C&quot;</span><span class="p">])</span>
<span class="c1">#show the percentage over &quot;Overlap_length&quot;/&quot;Protospacer_1_length&quot;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">all_melt</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="n">new_pallete</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1">#save plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;figures/overlap_gene_signature.pdf&quot;</span><span class="p">)</span>
<span class="n">gene_list_select</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_genes_groups</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">&#39;guide_id&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">gene_list_select</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span><span class="n">reference</span><span class="o">=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;t-test&#39;</span><span class="p">)</span>
<span class="n">genelist</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;guide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/r_/bqnt2f_d6919cz7v1yzx2ykc0000gn/T/ipykernel_22880/105156496.py:12: FutureWarning: Categorical.to_list is deprecated and will be removed in a future version. Use obj.tolist() instead
  sc.tl.rank_genes_groups(adata, &#39;guide_id&#39;, groups=gene_list_select.to_list(),reference=&#34;non-targeting_Control&#34;, method=&#39;t-test&#39;)
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:435: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;names&#34;] = self.var_names[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:437: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;scores&#34;] = scores[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:440: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals&#34;] = pvals[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:450: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;pvals_adj&#34;] = pvals_adj[global_indices]
/Users/helenking/anaconda3/envs/apu/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py:461: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self.stats[group_name, &#34;logfoldchanges&#34;] = np.log2(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_9_1.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_9_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># comp_gene_list MP vs AP summary table for each candidate gene</span>
<span class="c1"># all_genes_df full DE results for all guides (MP and AP)</span>
<span class="c1"># all_genes_df_filt statistically significant DEGs used for downstream signature analysis</span>

<span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_genes_groups</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">&#39;guide_id&#39;</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">genelist</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">,</span> <span class="n">use_raw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pts</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1">#get target gene logfoldchanges</span>
<span class="c1">#get the differentially expressed genes</span>
<span class="n">gene_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">comp_gene_list</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;perturbation&quot;</span><span class="p">][(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;successfulKD&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;True&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># print(gene)</span>
    <span class="c1">#AP</span>
    <span class="n">gene_AP</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_AP&quot;</span>
    <span class="n">gene_MP</span><span class="o">=</span><span class="n">gene</span><span class="o">+</span><span class="s2">&quot;_MP&quot;</span>

    <span class="k">if</span> <span class="n">gene_AP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">][(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;successfulKD&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;True&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">##form a dataframe with custom colummns</span>
        <span class="n">MP</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_MP</span><span class="p">)</span>
        <span class="n">MP_filt</span> <span class="o">=</span> <span class="n">MP</span><span class="p">[(</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">gene</span><span class="p">)]</span>
        <span class="n">AP</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_AP</span><span class="p">)</span>
        <span class="n">AP_filt</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[(</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">gene</span><span class="p">)]</span>
        <span class="c1">#do it for every gene</span>
        <span class="n">MP</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">gene_MP</span>
        <span class="n">AP</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">gene_AP</span>
        <span class="n">gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MP</span><span class="p">)</span>
        <span class="n">gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AP</span><span class="p">)</span>
        <span class="n">promoter_line</span><span class="o">=</span><span class="p">[</span><span class="n">gene</span><span class="p">,</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;scores&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;pvals_adj&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;scores&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;pvals_adj&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">comp_gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">promoter_line</span><span class="p">)</span>
<span class="c1">#convert to dataframe</span>
<span class="n">comp_gene_list</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">comp_gene_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span><span class="s2">&quot;MP_zscore&quot;</span><span class="p">,</span><span class="s2">&quot;MP_logfoldchange&quot;</span><span class="p">,</span><span class="s2">&quot;MP_pvalue&quot;</span><span class="p">,</span><span class="s2">&quot;AP_zscore&quot;</span><span class="p">,</span><span class="s2">&quot;AP_logfoldchange&quot;</span><span class="p">,</span><span class="s2">&quot;AP_pvalue&quot;</span><span class="p">])</span>

<span class="c1">#merge all gene dfs</span>
<span class="n">all_genes_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gene_list</span><span class="p">))</span>
<span class="c1">#change the column names</span>
<span class="n">all_genes_df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span><span class="s2">&quot;scores&quot;</span><span class="p">,</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">,</span><span class="s2">&quot;pvals&quot;</span><span class="p">,</span><span class="s2">&quot;pvals_adj&quot;</span><span class="p">,</span><span class="s2">&quot;pct_nz_group&quot;</span><span class="p">,</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span>
<span class="c1">#filter for logfoldchange &gt; 0.5 and pvalue &lt; 0.05</span>
<span class="n">all_genes_df_filt</span><span class="o">=</span><span class="n">all_genes_df</span><span class="p">[(</span><span class="n">all_genes_df</span><span class="p">[</span><span class="s2">&quot;pvals_adj&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">all_genes_df</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)]</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># Run DE once</span>
<span class="c1"># all  ‚Üí Summary of MP/AP DEG counts &amp; correlations (one row per target gene)</span>
<span class="c1"># directional_genes_df ‚Üí Up- and down-regulated DEG signatures per target</span>
<span class="c1"># all_filt ‚Üí Summary table filtered for successful KD</span>

<span class="n">gene_list</span> <span class="o">=</span> <span class="p">[]</span>          <span class="c1"># per-target summary (MP/AP counts, overlap, correlation)</span>
<span class="n">comp_gene_list</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># full DE tables for each MP/AP guide</span>
<span class="n">directional_genes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># per-target, per-direction summary (Up / Down)</span>

<span class="c1"># Cache valid guides to avoid recomputing each loop</span>
<span class="n">valid_guides</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">,</span> <span class="s2">&quot;guide_id&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="n">perturbations</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">,</span> <span class="s2">&quot;perturbation&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">perturbations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gene</span><span class="p">)</span>

    <span class="n">gene_AP</span> <span class="o">=</span> <span class="n">gene</span> <span class="o">+</span> <span class="s2">&quot;_AP&quot;</span>
    <span class="n">gene_MP</span> <span class="o">=</span> <span class="n">gene</span> <span class="o">+</span> <span class="s2">&quot;_MP&quot;</span>

    <span class="c1"># skip if there is no AP guide for this gene</span>
    <span class="k">if</span> <span class="n">gene_AP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_guides</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># ------- MP -------</span>
    <span class="n">MP</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_MP</span><span class="p">,</span> <span class="n">pval_cutoff</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">MP</span> <span class="o">=</span> <span class="n">MP</span><span class="p">[</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="n">MP_names</span> <span class="o">=</span> <span class="n">MP</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">MP_up</span> <span class="o">=</span> <span class="n">MP</span><span class="p">[</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">MP_up_names</span> <span class="o">=</span> <span class="n">MP_up</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">MP_down</span> <span class="o">=</span> <span class="n">MP</span><span class="p">[</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">MP_down_names</span> <span class="o">=</span> <span class="n">MP_down</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># ------- AP -------</span>
    <span class="n">AP</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_AP</span><span class="p">,</span> <span class="n">pval_cutoff</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">AP</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="n">AP_names</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">AP_up</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">AP_up_names</span> <span class="o">=</span> <span class="n">AP_up</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">AP_down</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">AP_down_names</span> <span class="o">=</span> <span class="n">AP_down</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># ------- Overlaps -------</span>
    <span class="n">overlap</span>       <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">MP_names</span>      <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">AP_names</span><span class="p">]</span>
    <span class="n">overlap_up</span>    <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">MP_up_names</span>   <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">AP_up_names</span><span class="p">]</span>
    <span class="n">overlap_down</span>  <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">MP_down_names</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">AP_down_names</span><span class="p">]</span>

    <span class="c1"># correlation of scores for overlapping genes (MP vs AP)</span>
    <span class="n">correlation_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">corr_df</span> <span class="o">=</span> <span class="n">MP</span><span class="p">[</span><span class="n">MP</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">overlap</span><span class="p">)]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">AP</span><span class="p">[</span><span class="n">AP</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">overlap</span><span class="p">)],</span>
            <span class="n">on</span><span class="o">=</span><span class="s2">&quot;names&quot;</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_MP&quot;</span><span class="p">,</span> <span class="s2">&quot;_AP&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">corr_mat</span> <span class="o">=</span> <span class="n">corr_df</span><span class="p">[[</span><span class="s2">&quot;scores_MP&quot;</span><span class="p">,</span> <span class="s2">&quot;scores_AP&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">correlation_value</span> <span class="o">=</span> <span class="n">corr_mat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;scores_MP&quot;</span><span class="p">,</span> <span class="s2">&quot;scores_AP&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">correlation_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>

    <span class="c1"># ------- per-gene summary row -------</span>
    <span class="n">gene_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">[[</span>
            <span class="n">gene</span><span class="p">,</span>
            <span class="n">MP_names</span><span class="p">,</span>
            <span class="n">AP_names</span><span class="p">,</span>
            <span class="n">overlap</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">MP_names</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">AP_names</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">overlap</span><span class="p">),</span>
            <span class="n">correlation_value</span>
        <span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene_row</span><span class="p">)</span>

    <span class="c1"># ------- directional (Up / Down) rows -------</span>
    <span class="n">gene_direction_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">gene</span><span class="p">,</span>
                <span class="n">MP_up_names</span><span class="p">,</span>
                <span class="n">AP_up_names</span><span class="p">,</span>
                <span class="n">overlap_up</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">MP_up_names</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">AP_up_names</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">overlap_up</span><span class="p">),</span>
                <span class="s2">&quot;Up&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">gene</span><span class="p">,</span>
                <span class="n">MP_down_names</span><span class="p">,</span>
                <span class="n">AP_down_names</span><span class="p">,</span>
                <span class="n">overlap_down</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">MP_down_names</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">AP_down_names</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">overlap_down</span><span class="p">),</span>
                <span class="s2">&quot;Down&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">directional_genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene_direction_df</span><span class="p">)</span>

    <span class="c1"># ------- full DE tables with guide labels -------</span>
    <span class="n">MP</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_MP</span>
    <span class="n">AP</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_AP</span>
    <span class="n">comp_gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MP</span><span class="p">)</span>
    <span class="n">comp_gene_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AP</span><span class="p">)</span>

<span class="c1"># ---------- build final dataframes ----------</span>

<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Target_Gene&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MP_Genes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AP_Genes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Overlap_Genes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MP_Gene_Num&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AP_Gene_Num&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Overlap_Gene_Num&quot;</span><span class="p">,</span>
    <span class="s2">&quot;correlation_value&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="nb">all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gene_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">all</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">col_names</span>

<span class="c1"># only directional</span>
<span class="n">directional_genes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">directional_genes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">directional_genes_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Target_Gene&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MP_Genes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AP_Genes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Overlap_Genes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MP_Gene_Num&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AP_Gene_Num&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Overlap_Gene_Num&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Direction&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># filter to successful KDs</span>
<span class="n">successful</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;successfulKD&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="n">directional_genes_df</span> <span class="o">=</span> <span class="n">directional_genes_df</span><span class="p">[</span>
    <span class="n">directional_genes_df</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">successful</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">all_filt</span> <span class="o">=</span> <span class="nb">all</span><span class="p">[</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">successful</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># save if you want</span>
<span class="c1"># all_filt.to_csv(loc+&quot;files/singlecell_shortread_analysis/differential_exp_list.csv&quot;)</span>
<span class="n">all_filt</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;files/singlecell_shortread_analysis/differential_exp_list_corr.csv&quot;</span><span class="p">)</span>
<span class="n">comp_gene_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">comp_gene_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">comp_gene_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;files/singlecell_shortread_analysis/differential_exp_fulltable.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">directional_genes_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;files/singlecell_shortread_analysis/differential_exp_directional_genes.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plot all_filt</span>
<span class="c1">#plot the correlation_value</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">all_filt</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;correlation_value&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Correlation between Z-Scores </span><span class="se">\n</span><span class="s2"> from Overlapping DEGs in P1 and P2 &quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count of Target Genes&quot;</span><span class="p">)</span>
<span class="c1">#add the number of genes with a value not na and all the genes</span>
<span class="n">num_genes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">all_filt</span><span class="p">)</span>
<span class="n">signif_genes</span><span class="o">=</span><span class="n">all_filt</span><span class="p">[</span><span class="n">all_filt</span><span class="p">[</span><span class="s2">&quot;correlation_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
<span class="n">num_signif_genes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">signif_genes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Significant n=</span><span class="si">{</span><span class="n">num_signif_genes</span><span class="si">}</span><span class="s1"> / Total n=</span><span class="si">{</span><span class="n">num_genes</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1"># all_filt</span>
<span class="c1">#save</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;figures/correlation_DEG_Zscores_MP_AP.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_13_0.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_13_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#save directional_genes_df to csv</span>
<span class="n">directional_genes_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;files/singlecell_shortread_analysis/differential_exp_directional_genes.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># long format for plotting distributions</span>
<span class="n">long</span> <span class="o">=</span> <span class="n">directional_genes_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">,</span> <span class="s2">&quot;Direction&quot;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MP_Gene_Num&quot;</span><span class="p">,</span> <span class="s2">&quot;AP_Gene_Num&quot;</span><span class="p">,</span> <span class="s2">&quot;Overlap_Gene_Num&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;N_genes&quot;</span>
<span class="p">)</span>

<span class="c1"># optional: nicer labels</span>
<span class="n">long</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">long</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
    <span class="s2">&quot;MP_Gene_Num&quot;</span><span class="p">:</span> <span class="s2">&quot;P1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AP_Gene_Num&quot;</span><span class="p">:</span> <span class="s2">&quot;P2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Overlap_Gene_Num&quot;</span><span class="p">:</span> <span class="s2">&quot;Overlap&quot;</span>
<span class="p">})</span>

<span class="c1"># Add log10 transform column</span>
<span class="n">long</span><span class="p">[</span><span class="s2">&quot;log10_N_genes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;N_genes&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">1e-7</span><span class="p">)</span>  <span class="c1"># replaces 0 by 1</span>
<span class="c1">#add log appropriate long[&quot;N_genes&quot;] by assigning it as +0.0000001</span>
<span class="c1">#drop duplicates</span>
<span class="n">long</span><span class="p">[</span><span class="s2">&quot;N_adj&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">long</span><span class="p">[</span><span class="s2">&quot;N_genes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">long</span> <span class="o">=</span> <span class="n">long</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#make the background axes lines</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># ---- UP ----</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">long</span><span class="p">[</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Up&quot;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;N_adj&quot;</span><span class="p">,</span>
    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">long</span><span class="p">[</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Up&quot;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;N_adj&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Up-regulated DEGs (log10)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# DE genes per target&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># ---- DOWN ----</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">long</span><span class="p">[</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Down&quot;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;N_adj&quot;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span>
    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">long</span><span class="p">[</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Down&quot;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;N_adj&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Down-regulated DEGs (log10)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# DE genes per target&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Category&quot;</span><span class="p">)</span>
<span class="c1">#change 10-1 to 0 on y axis</span>
<span class="n">tick_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">tick_vals</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">])</span>

<span class="c1">#repeat for both axes</span>

<span class="c1">#save as pdf</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;figures/DEG_counts_per_target_promoter.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/r_/bqnt2f_d6919cz7v1yzx2ykc0000gn/T/ipykernel_22880/435962864.py:29: FutureWarning:

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.boxplot(
/var/folders/r_/bqnt2f_d6919cz7v1yzx2ykc0000gn/T/ipykernel_22880/435962864.py:52: FutureWarning:

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.boxplot(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_15_1.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_15_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find the top overlapping genes</span>
<span class="n">long</span><span class="p">[(</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">long</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Overlap&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;N_genes&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Target_Gene</th>
      <th>Direction</th>
      <th>Category</th>
      <th>N_genes</th>
      <th>log10_N_genes</th>
      <th>N_adj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>185</th>
      <td>MYBBP1A</td>
      <td>Down</td>
      <td>Overlap</td>
      <td>33</td>
      <td>1.5185</td>
      <td>33.0000</td>
    </tr>
    <tr>
      <th>151</th>
      <td>ESR1</td>
      <td>Down</td>
      <td>Overlap</td>
      <td>21</td>
      <td>1.3222</td>
      <td>21.0000</td>
    </tr>
    <tr>
      <th>201</th>
      <td>GATA3</td>
      <td>Down</td>
      <td>Overlap</td>
      <td>20</td>
      <td>1.3010</td>
      <td>20.0000</td>
    </tr>
    <tr>
      <th>203</th>
      <td>RBM47</td>
      <td>Down</td>
      <td>Overlap</td>
      <td>18</td>
      <td>1.2553</td>
      <td>18.0000</td>
    </tr>
    <tr>
      <th>169</th>
      <td>RC3H2</td>
      <td>Down</td>
      <td>Overlap</td>
      <td>18</td>
      <td>1.2553</td>
      <td>18.0000</td>
    </tr>
    <tr>
      <th>149</th>
      <td>JARID2</td>
      <td>Down</td>
      <td>Overlap</td>
      <td>17</td>
      <td>1.2304</td>
      <td>17.0000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#can check that there are no genes with logfoldchange between -0.5 and 0.5 ad that pvals_adj</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_genes_df_filt</span><span class="p">[(</span><span class="n">all_genes_df_filt</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&lt;=</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">all_genes_df_filt</span><span class="p">[</span><span class="s2">&quot;pvals_adj&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">#chec number of genes with sig. DEG all_genes_df_filt ESR1_MP ESR1_AP</span>
<span class="c1">#plot the distribution of logfoldchanges for ESR1_MP and ESR1_AP</span>
<span class="n">all_genes_df_esr1</span><span class="o">=</span><span class="n">all_genes_df_filt</span><span class="p">[</span><span class="n">all_genes_df_filt</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;ESR1_MP&quot;</span><span class="p">,</span><span class="s2">&quot;ESR1_AP&quot;</span><span class="p">])]</span>
<span class="n">all_genes_df_esr1</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_genes_df_esr1</span><span class="p">[</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">,</span><span class="s2">&quot;Down&quot;</span><span class="p">)</span>
<span class="c1">#check the number of MP and AP genes per target gene and their overlap using</span>
<span class="n">number_of_genes</span><span class="o">=</span><span class="n">all_genes_df_esr1</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">,</span><span class="s2">&quot;Direction&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#see the number of gene that overlap between MP and AP</span>
<span class="n">overlap_genes</span><span class="o">=</span><span class="n">all_genes_df_esr1</span><span class="p">[</span><span class="n">all_genes_df_esr1</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ESR1_MP&quot;</span><span class="p">][</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">all_genes_df_esr1</span><span class="p">[</span><span class="n">all_genes_df_esr1</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ESR1_AP&quot;</span><span class="p">][</span><span class="s2">&quot;gene&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">number_of_genes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of overlapping genes between ESR1_MP and ESR1_AP:&quot;</span><span class="p">,</span> <span class="n">overlap_genes</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0, 7)
Direction      Down   Up
targeted_gene
ESR1_AP         634  355
ESR1_MP         154    0
Number of overlapping genes between ESR1_MP and ESR1_AP: 21
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/r_/bqnt2f_d6919cz7v1yzx2ykc0000gn/T/ipykernel_22880/1044356788.py:7: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  all_genes_df_esr1[&#34;Direction&#34;]=np.where(all_genes_df_esr1[&#34;logfoldchanges&#34;]&gt;0, &#34;Up&#34;,&#34;Down&#34;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><br/><span></span><span class="n">genes_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JARID2&quot;</span><span class="p">,</span> <span class="s2">&quot;RC3H2&quot;</span><span class="p">,</span> <span class="s2">&quot;RBM47&quot;</span><span class="p">,</span><span class="s2">&quot;GATA3&quot;</span><span class="p">,</span> <span class="s2">&quot;ESR1&quot;</span><span class="p">,</span> <span class="s2">&quot;MYBBP1A&quot;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Determine grid shape</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">genes_of_interest</span><span class="p">)</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>



<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mi">3</span> <span class="p">),</span>
        <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span>   <span class="c1"># &lt;-- keep y shared, but NOT x</span>
    <span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="c1">#sub genes_of_interest list for current row</span>
    <span class="n">row_genes_of_interest</span> <span class="o">=</span> <span class="n">genes_of_interest</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">ncols</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ncols</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">tg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">row_genes_of_interest</span><span class="p">):</span>

        <span class="n">mp</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">all_genes_df_filt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">all_genes_df_filt</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tg</span><span class="si">}</span><span class="s2">_MP&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="s2">&quot;scores&quot;</span><span class="p">]</span>
            <span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scores&quot;</span><span class="p">:</span> <span class="s2">&quot;score_MP&quot;</span><span class="p">})</span>
        <span class="p">)</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">all_genes_df_filt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">all_genes_df_filt</span><span class="p">[</span><span class="s2">&quot;targeted_gene&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tg</span><span class="si">}</span><span class="s2">_AP&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="s2">&quot;scores&quot;</span><span class="p">]</span>
            <span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scores&quot;</span><span class="p">:</span> <span class="s2">&quot;score_AP&quot;</span><span class="p">})</span>
        <span class="p">)</span>

        <span class="n">overlap</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">overlap</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tg</span><span class="si">}</span><span class="s2">: no overlapping genes&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">overlap</span><span class="p">[</span><span class="s2">&quot;score_MP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">overlap</span><span class="p">[</span><span class="s2">&quot;score_AP&quot;</span><span class="p">])</span>

        <span class="c1"># draw heatmap</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
            <span class="n">overlap</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Z-Score&quot;</span><span class="p">},</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
        <span class="p">)</span>

        <span class="c1"># ---- force ALL gene labels to show ----</span>
        <span class="n">genes</span> <span class="o">=</span> <span class="n">overlap</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">genes</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">)</span>        <span class="c1"># centers of cells</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">genes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#remove yticklabels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tg</span><span class="si">}</span><span class="se">\n</span><span class="s2">n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span><span class="si">}</span><span class="s2">, r=</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="c1">#save</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;figures/DEG_Zscore_heatmap_MP_AP_row</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_18_1.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_18_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_18_2.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_18_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_18_3.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_18_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#change MP to P1 and AP to P2</span>
<span class="n">comp_gene_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_gene_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_MP&quot;</span><span class="p">,</span> <span class="s2">&quot;_P1&quot;</span><span class="p">)</span>
<span class="n">comp_gene_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_gene_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_AP&quot;</span><span class="p">,</span> <span class="s2">&quot;_P2&quot;</span><span class="p">)</span>
<span class="n">pivot_df</span> <span class="o">=</span> <span class="n">comp_gene_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;names&quot;</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Guide&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;logfoldchanges&quot;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;median&quot;</span>
<span class="p">)</span>

<span class="n">pivot_df</span> <span class="o">=</span> <span class="n">pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="c1">#make figure larger</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1">#make max and min +2 and -2</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">pivot_df</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>   <span class="c1"># set to True if you want labels (but 17k genes = unreadable)</span>
    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;LogFC Heatmap for all guides&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Guide&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Genes&quot;</span><span class="p">)</span>
<span class="c1">#remove vadj</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1">#make x smaller size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#add colorbar label titlee saying Log Fold Change</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Log Fold Change (Capped ¬±2)&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_19_0.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_19_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make a correlation between the logfoldchanges for MP vs AP for all genes</span>
<span class="n">corr</span><span class="o">=</span><span class="n">pivot_df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#plot the correlation as a heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">corr</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span>

<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap of LogFC between Guides&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Guide&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Guide&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([  0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,
          9.5,  10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,
         18.5,  19.5,  20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,
         27.5,  28.5,  29.5,  30.5,  31.5,  32.5,  33.5,  34.5,  35.5,
         36.5,  37.5,  38.5,  39.5,  40.5,  41.5,  42.5,  43.5,  44.5,
         45.5,  46.5,  47.5,  48.5,  49.5,  50.5,  51.5,  52.5,  53.5,
         54.5,  55.5,  56.5,  57.5,  58.5,  59.5,  60.5,  61.5,  62.5,
         63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,  70.5,  71.5,
         72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,  80.5,
         81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5,
         90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
         99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5]),
 [Text(0, 0.5, &#39;ADAR_P1&#39;),
  Text(0, 1.5, &#39;ADAR_P2&#39;),
  Text(0, 2.5, &#39;AHCYL1_P1&#39;),
  Text(0, 3.5, &#39;AHCYL1_P2&#39;),
  Text(0, 4.5, &#39;APP_P1&#39;),
  Text(0, 5.5, &#39;APP_P2&#39;),
  Text(0, 6.5, &#39;ARNT_P1&#39;),
  Text(0, 7.5, &#39;ARNT_P2&#39;),
  Text(0, 8.5, &#39;BRIP1_P1&#39;),
  Text(0, 9.5, &#39;BRIP1_P2&#39;),
  Text(0, 10.5, &#39;BZW1_P1&#39;),
  Text(0, 11.5, &#39;BZW1_P2&#39;),
  Text(0, 12.5, &#39;CALR_P1&#39;),
  Text(0, 13.5, &#39;CALR_P2&#39;),
  Text(0, 14.5, &#39;CCND1_P1&#39;),
  Text(0, 15.5, &#39;CCND1_P2&#39;),
  Text(0, 16.5, &#39;CHD4_P1&#39;),
  Text(0, 17.5, &#39;CHD4_P2&#39;),
  Text(0, 18.5, &#39;CHD8_P1&#39;),
  Text(0, 19.5, &#39;CHD8_P2&#39;),
  Text(0, 20.5, &#39;CTNNB1_P1&#39;),
  Text(0, 21.5, &#39;CTNNB1_P2&#39;),
  Text(0, 22.5, &#39;CUX1_P1&#39;),
  Text(0, 23.5, &#39;CUX1_P2&#39;),
  Text(0, 24.5, &#39;DHX30_P1&#39;),
  Text(0, 25.5, &#39;DHX30_P2&#39;),
  Text(0, 26.5, &#39;EEF2_P1&#39;),
  Text(0, 27.5, &#39;EEF2_P2&#39;),
  Text(0, 28.5, &#39;ESR1_P1&#39;),
  Text(0, 29.5, &#39;ESR1_P2&#39;),
  Text(0, 30.5, &#39;FHL2_P1&#39;),
  Text(0, 31.5, &#39;FHL2_P2&#39;),
  Text(0, 32.5, &#39;GATA3_P1&#39;),
  Text(0, 33.5, &#39;GATA3_P2&#39;),
  Text(0, 34.5, &#39;GPBP1_P1&#39;),
  Text(0, 35.5, &#39;GPBP1_P2&#39;),
  Text(0, 36.5, &#39;GTF2F1_P1&#39;),
  Text(0, 37.5, &#39;GTF2F1_P2&#39;),
  Text(0, 38.5, &#39;HNRNPU_P1&#39;),
  Text(0, 39.5, &#39;HNRNPU_P2&#39;),
  Text(0, 40.5, &#39;JARID2_P1&#39;),
  Text(0, 41.5, &#39;JARID2_P2&#39;),
  Text(0, 42.5, &#39;KDM2A_P1&#39;),
  Text(0, 43.5, &#39;KDM2A_P2&#39;),
  Text(0, 44.5, &#39;MYBBP1A_P1&#39;),
  Text(0, 45.5, &#39;MYBBP1A_P2&#39;),
  Text(0, 46.5, &#39;NAP1L1_P1&#39;),
  Text(0, 47.5, &#39;NAP1L1_P2&#39;),
  Text(0, 48.5, &#39;NBN_P1&#39;),
  Text(0, 49.5, &#39;NBN_P2&#39;),
  Text(0, 50.5, &#39;NCOR2_P1&#39;),
  Text(0, 51.5, &#39;NCOR2_P2&#39;),
  Text(0, 52.5, &#39;NFE2L2_P1&#39;),
  Text(0, 53.5, &#39;NFE2L2_P2&#39;),
  Text(0, 54.5, &#39;NME2_P1&#39;),
  Text(0, 55.5, &#39;NME2_P2&#39;),
  Text(0, 56.5, &#39;NR2F2_P1&#39;),
  Text(0, 57.5, &#39;NR2F2_P2&#39;),
  Text(0, 58.5, &#39;P4HB_P1&#39;),
  Text(0, 59.5, &#39;P4HB_P2&#39;),
  Text(0, 60.5, &#39;PA2G4_P1&#39;),
  Text(0, 61.5, &#39;PA2G4_P2&#39;),
  Text(0, 62.5, &#39;PKM_P1&#39;),
  Text(0, 63.5, &#39;PKM_P2&#39;),
  Text(0, 64.5, &#39;PRRC2C_P1&#39;),
  Text(0, 65.5, &#39;PRRC2C_P2&#39;),
  Text(0, 66.5, &#39;PSMC5_P1&#39;),
  Text(0, 67.5, &#39;PSMC5_P2&#39;),
  Text(0, 68.5, &#39;RBM47_P1&#39;),
  Text(0, 69.5, &#39;RBM47_P2&#39;),
  Text(0, 70.5, &#39;RC3H2_P1&#39;),
  Text(0, 71.5, &#39;RC3H2_P2&#39;),
  Text(0, 72.5, &#39;SAFB_P1&#39;),
  Text(0, 73.5, &#39;SAFB_P2&#39;),
  Text(0, 74.5, &#39;SET_P1&#39;),
  Text(0, 75.5, &#39;SET_P2&#39;),
  Text(0, 76.5, &#39;SIN3A_P1&#39;),
  Text(0, 77.5, &#39;SIN3A_P2&#39;),
  Text(0, 78.5, &#39;SLTM_P1&#39;),
  Text(0, 79.5, &#39;SLTM_P2&#39;),
  Text(0, 80.5, &#39;SMARCA4_P1&#39;),
  Text(0, 81.5, &#39;SMARCA4_P2&#39;),
  Text(0, 82.5, &#39;SP1_P1&#39;),
  Text(0, 83.5, &#39;SP1_P2&#39;),
  Text(0, 84.5, &#39;SRSF5_P1&#39;),
  Text(0, 85.5, &#39;SRSF5_P2&#39;),
  Text(0, 86.5, &#39;STAG2_P1&#39;),
  Text(0, 87.5, &#39;STAG2_P2&#39;),
  Text(0, 88.5, &#39;STAT3_P1&#39;),
  Text(0, 89.5, &#39;STAT3_P2&#39;),
  Text(0, 90.5, &#39;STAU2_P1&#39;),
  Text(0, 91.5, &#39;STAU2_P2&#39;),
  Text(0, 92.5, &#39;TGIF1_P1&#39;),
  Text(0, 93.5, &#39;TGIF1_P2&#39;),
  Text(0, 94.5, &#39;TPD52L1_P1&#39;),
  Text(0, 95.5, &#39;TPD52L1_P2&#39;),
  Text(0, 96.5, &#39;UPF3B_P1&#39;),
  Text(0, 97.5, &#39;UPF3B_P2&#39;),
  Text(0, 98.5, &#39;XRCC5_P1&#39;),
  Text(0, 99.5, &#39;XRCC5_P2&#39;),
  Text(0, 100.5, &#39;YWHAZ_P1&#39;),
  Text(0, 101.5, &#39;YWHAZ_P2&#39;),
  Text(0, 102.5, &#39;ZNF217_P1&#39;),
  Text(0, 103.5, &#39;ZNF217_P2&#39;),
  Text(0, 104.5, &#39;ZNF3_P1&#39;),
  Text(0, 105.5, &#39;ZNF3_P2&#39;)])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_20_1.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_20_1.png" />
</div>
</div>
<p>Pathway and GO Enrichment Analysis To move from individual gene lists to biological functions, the notebook conducts pathway enrichment analysis.</p>
<p>GSEA and pyGSEA: It performs pre-ranked Gene Set Enrichment Analysis (GSEA) using the <a class="reference external" href="GO:BP">GO:BP</a> (Gene Ontology: Biological Process) database.</p>
<p>NES Differences: The code quantifies differences between P1 and P2 at the pathway level by calculating the difference in Normalized Enrichment Scores (NES)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list to collect per-guide GSEA results</span>
<span class="n">gsea_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># cache valid guides to avoid recomputing</span>
<span class="n">valid_guides</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">,</span> <span class="s2">&quot;guide_id&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># list of perturbed genes</span>
<span class="n">perturbations</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;non-targeting_Control&quot;</span><span class="p">,</span> <span class="s2">&quot;perturbation&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">perturbations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gene</span><span class="p">)</span>

    <span class="n">gene_AP</span> <span class="o">=</span> <span class="n">gene</span> <span class="o">+</span> <span class="s2">&quot;_AP&quot;</span>
    <span class="n">gene_MP</span> <span class="o">=</span> <span class="n">gene</span> <span class="o">+</span> <span class="s2">&quot;_MP&quot;</span>

    <span class="c1"># skip if no AP guide for this gene</span>
    <span class="k">if</span> <span class="n">gene_AP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_guides</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># ---------- MP GUIDE ----------</span>
    <span class="c1"># get full DE table (NO pval/logFC cutoff for GSEA)</span>
    <span class="n">MP_rank</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_MP</span><span class="p">,</span> <span class="n">pval_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># make a 2-column ranking like your STIM example:</span>
    <span class="c1">#   [names, logfoldchanges]</span>
    <span class="n">mp_rnk</span> <span class="o">=</span> <span class="n">MP_rank</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># run prerank</span>
    <span class="n">pre_res_mp</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">prerank</span><span class="p">(</span>
        <span class="n">rnk</span><span class="o">=</span><span class="n">mp_rnk</span><span class="p">,</span>                 <span class="c1"># DataFrame with [gene, score]</span>
        <span class="n">gene_sets</span><span class="o">=</span><span class="s2">&quot;GO_Biological_Process_2021&quot;</span><span class="p">,</span>      <span class="c1"># or your favourite collection</span>
        <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                <span class="c1"># don&#39;t write files</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span>
    <span class="p">)</span>

    <span class="c1"># grab the result table</span>
    <span class="n">mp_res_df</span> <span class="o">=</span> <span class="n">pre_res_mp</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene</span>
    <span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_MP</span>
    <span class="c1"># classify direction by NES sign</span>
    <span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mp_res_df</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">,</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span>
    <span class="n">gsea_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp_res_df</span><span class="p">)</span>

    <span class="c1"># ---------- AP GUIDE ----------</span>
    <span class="n">AP_rank</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">rank_genes_groups_df</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">gene_AP</span><span class="p">,</span> <span class="n">pval_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">ap_rnk</span> <span class="o">=</span> <span class="n">AP_rank</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="s2">&quot;logfoldchanges&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="n">pre_res_ap</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">prerank</span><span class="p">(</span>
        <span class="n">rnk</span><span class="o">=</span><span class="n">ap_rnk</span><span class="p">,</span>
        <span class="n">gene_sets</span><span class="o">=</span><span class="s2">&quot;GO_Biological_Process_2021&quot;</span><span class="p">,</span>
        <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span>
    <span class="p">)</span>

    <span class="n">ap_res_df</span> <span class="o">=</span> <span class="n">pre_res_ap</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene</span>
    <span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_AP</span>
    <span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ap_res_df</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">,</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span>
    <span class="n">gsea_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ap_res_df</span><span class="p">)</span>

<span class="n">gsea_results</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[         Name                                               Term      ES  \
 0     prerank       regulation of T cell activation (GO:0050863)  0.6302
 1     prerank                protein polymerization (GO:0051258)  0.5084
 2     prerank  regulation of cation transmembrane transport (...  0.6119
 3     prerank  regulation of viral entry into host cell (GO:0...  0.5995
 4     prerank     sulfur compound catabolic process (GO:0044273)  0.5643
 ...       ...                                                ...     ...
 2032  prerank  regulation of protein dephosphorylation (GO:00... -0.1366
 2033  prerank                   selective autophagy (GO:0061912) -0.1340
 2034  prerank    cellular response to interleukin-1 (GO:0071347) -0.1318
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1214
 2036  prerank      pre-replicative complex assembly (GO:0036388) -0.0861

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.5964    0.0417    1.0000     0.9970    4/17   5.90%
 1     1.5878    0.0220    1.0000     0.9980   14/39  18.79%
 2     1.5872    0.0337    1.0000     0.9990    6/17  10.60%
 3     1.5784    0.0332    1.0000     0.9990    6/23   9.67%
 4     1.5410    0.0311    1.0000     1.0000    7/23  12.41%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2072    1.0000    1.0000     1.0000   12/35  33.96%
 2033 -0.2031    1.0000    1.0000     1.0000   15/49  32.07%
 2034 -0.2026    1.0000    1.0000     1.0000  16/101  22.81%
 2035 -0.1849    1.0000    1.0000     1.0000   8/160  12.47%
 2036 -0.1298    1.0000    1.0000     1.0000    1/59   5.45%

                                              Lead_genes Target_Gene     Guide  \
 0                                 IL4I1;PAG1;KAT2A;JAK3       STAU2  STAU2_MP
 1     VIL1;TRPV4;WASF3;CORO7;TRIM6;MAP7D3;ARL6;UBE2S...       STAU2  STAU2_MP
 2                 RANGRF;KCNN2;SCN5A;KCNH2;SNTA1;KCNIP3       STAU2  STAU2_MP
 3               CD74;TRIM14;TRIM38;TRIM6;IFITM1;TMPRSS4       STAU2  STAU2_MP
 4                  CSPG4;CHAC1;CTH;GGT7;NUDT7;GLB1;HEXA       STAU2  STAU2_MP
 ...                                                 ...         ...       ...
 2032  DLC1;NSMF;PPP1R15A;PPP6R2;SYMPK;TSC1;PPP1R2;HT...       STAU2  STAU2_MP
 2033  ATG14;WDFY3;AMBRA1;ATG5;PEX5;UFL1;DYNC1I2;ACBD...       STAU2  STAU2_MP
 2034  GBP3;MAPK13;IL1R1;DAB2IP;TOLLIP;TAB1;HYAL2;GBP...       STAU2  STAU2_MP
 2035      TUT1;CASC3;PATL1;HELZ2;ERI1;CTIF;MTPAP;CNOT10       STAU2  STAU2_MP
 2036                                               MCM8       STAU2  STAU2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of peptide hormone secreti...  0.7452
 1     prerank  adenylate cyclase-activating G protein-coupled...  0.6922
 2     prerank   phosphatidic acid metabolic process (GO:0046473)  0.6465
 3     prerank  phosphatidic acid biosynthetic process (GO:000...  0.6387
 4     prerank  adenylate cyclase-inhibiting G protein-coupled...  0.6757
 ...       ...                                                ...     ...
 2032  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1139
 2033  prerank  RNA splicing, via transesterification reaction... -0.1136
 2034  prerank  regulation of hematopoietic stem cell differen... -0.1162
 2035  prerank  regulation of transcription from RNA polymeras... -0.0951
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0809

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8521    0.0000    0.7642     0.4460    5/17   9.10%
 1     1.8263    0.0000    0.5187     0.5440   10/25   9.03%
 2     1.7933    0.0065    0.5458     0.6850   15/30  18.71%
 3     1.7652    0.0064    0.5873     0.7950   14/29  18.71%
 4     1.7277    0.0119    0.7189     0.9140   11/22   9.03%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2013    1.0000    1.0000     1.0000  33/260  22.64%
 2033 -0.1996    1.0000    1.0000     1.0000  29/239  22.64%
 2034 -0.1972    1.0000    1.0000     1.0000   18/60  37.92%
 2035 -0.1628    1.0000    1.0000     1.0000   25/65  41.36%
 2036 -0.1423    1.0000    1.0000     1.0000   6/160  13.29%

                                              Lead_genes Target_Gene     Guide  \
 0                          HFE;ACSL4;DRD2;LRRC8A;CAPN10       STAU2  STAU2_AP
 1     PTHLH;ADCY7;PTGER2;MC1R;ADRB1;S1PR2;GNAL;DRD2;...       STAU2  STAU2_AP
 2     DGKG;ABHD4;LIPH;SLC27A1;ACP6;PLA2G6;DGKQ;GPAM;...       STAU2  STAU2_AP
 3     DGKG;ABHD4;LIPH;SLC27A1;ACP6;DGKQ;GPAM;ABHD8;A...       STAU2  STAU2_AP
 4     ADCY7;HTR1E;GPR37L1;GPR37;GRM4;CHRM1;GNAL;DRD2...       STAU2  STAU2_AP
 ...                                                 ...         ...       ...
 2032  USP49;ELAVL2;ISY1;RBM19;FRG1;CWF19L2;DHX35;U2A...       STAU2  STAU2_AP
 2033  USP49;ELAVL2;ISY1;RBM19;FRG1;CWF19L2;DHX35;U2A...       STAU2  STAU2_AP
 2034  ITCH;SETD1A;PSMD14;EIF2AK2;YTHDF2;PSMD13;PSMB4...       STAU2  STAU2_AP
 2035  EPAS1;EGLN2;PSMD14;LIMD1;NOTCH1;PSMD13;PSMB4;P...       STAU2  STAU2_AP
 2036                 CTIF;PAN2;CNOT8;DHX34;CNOT3;CNOT10       STAU2  STAU2_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank           neural crest cell migration (GO:0001755)  0.7027
 1     prerank          response to interferon-gamma (GO:0034341)  0.6467
 2     prerank  regulation of activated T cell proliferation (...  0.7130
 3     prerank   semaphorin-plexin signaling pathway (GO:0071526)  0.6423
 4     prerank  positive regulation of fibroblast proliferatio...  0.6960
 ...       ...                                                ...     ...
 2032  prerank  nuclear-transcribed mRNA catabolic process, no... -0.1311
 2033  prerank              mitotic nuclear division (GO:0140014) -0.1180
 2034  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1057
 2035  prerank                       rRNA processing (GO:0006364) -0.1053
 2036  prerank                rRNA metabolic process (GO:0016072) -0.0948

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8844    0.0000    0.4190     0.2910     9/22   8.77%
 1     1.7994    0.0037    0.6867     0.6420     7/27   9.74%
 2     1.7824    0.0029    0.5707     0.7170     5/18   4.61%
 3     1.7751    0.0036    0.4674     0.7480     9/26  11.22%
 4     1.7435    0.0064    0.5505     0.8580     7/18  16.62%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2061    1.0000    1.0000     1.0000  110/110  87.02%
 2033 -0.1876    1.0000    1.0000     1.0000    14/66  27.71%
 2034 -0.1675    1.0000    1.0000     1.0000     4/52  17.62%
 2035 -0.1664    1.0000    1.0000     1.0000    9/165  16.07%
 2036 -0.1502    1.0000    1.0000     1.0000    7/150  14.68%

                                              Lead_genes Target_Gene  \
 0     NRTN;SEMA6A;SEMA6D;SEMA4F;SEMA6B;PITX2;FOLR1;S...      AHCYL1
 1                GBP1;GBP3;IFITM1;TLR2;CD74;CXCL16;CD58      AHCYL1
 2                        IGF2;FOXP3;CD274;IL27RA;ICOSLG      AHCYL1
 3     NRP2;SEMA6A;SEMA6D;PLXNA4;SEMA4F;SEMA6B;SEMA4A...      AHCYL1
 4                PDGFC;CD74;LIG4;DDR2;NDUFS4;CDK6;SPHK1      AHCYL1
 ...                                                 ...         ...
 2032  SMG6;SMG1;DHX34;CASC3;PNRC2;UPF2;PPP2R2A;UPF1;...      AHCYL1
 2033  CHMP7;ESPL1;KIF3B;KPNB1;KIFC2;SPAG5;KIFC1;KNST...      AHCYL1
 2034                          LAS1L;MAK16;PAK1IP1;WDR12      AHCYL1
 2035  DDX47;FCF1;DHX37;LAS1L;MAK16;UTP14A;UTP3;RRP12...      AHCYL1
 2036           DDX47;FCF1;DHX37;LAS1L;UTP14A;UTP3;RRP12      AHCYL1

           Guide Direction
 0     AHCYL1_MP        Up
 1     AHCYL1_MP        Up
 2     AHCYL1_MP        Up
 3     AHCYL1_MP        Up
 4     AHCYL1_MP        Up
 ...         ...       ...
 2032  AHCYL1_MP      Down
 2033  AHCYL1_MP      Down
 2034  AHCYL1_MP      Down
 2035  AHCYL1_MP      Down
 2036  AHCYL1_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of endothelial cell proliferation (...  0.5924
 1     prerank  positive regulation of endothelial cell prolif...  0.5717
 2     prerank                 metal ion homeostasis (GO:0055065)  0.6808
 3     prerank            endothelial cell migration (GO:0043542)  0.6194
 4     prerank   response to reactive oxygen species (GO:0000302)  0.5517
 ...       ...                                                ...     ...
 2032  prerank                 RNA catabolic process (GO:0006401) -0.1302
 2033  prerank  anaphase-promoting complex-dependent catabolic... -0.1257
 2034  prerank  regulation of cell cycle phase transition (GO:... -0.1092
 2035  prerank                           translation (GO:0006412) -0.1011
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.0691

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7980    0.0000    0.9968     0.5340   12/51   6.44%
 1     1.7140    0.0035    1.0000     0.8970   10/49   6.44%
 2     1.7108    0.0072    1.0000     0.9090    8/23   6.10%
 3     1.6676    0.0151    1.0000     0.9810    6/26   9.76%
 4     1.6598    0.0029    1.0000     0.9880    6/44   7.11%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2107    1.0000    1.0000     1.0000   41/41  87.03%
 2033 -0.2066    1.0000    1.0000     1.0000   31/77  35.64%
 2034 -0.1779    1.0000    1.0000     1.0000   28/85  33.87%
 2035 -0.1735    1.0000    1.0000     1.0000  11/187  15.13%
 2036 -0.1160    1.0000    1.0000     1.0000  20/121  26.49%

                                              Lead_genes Target_Gene  \
 0     NRP2;APOE;ECM1;PGF;VASH2;STAT5A;CAV1;SULF1;CAV...      AHCYL1
 1     NRP2;IGF2;ECM1;PGF;HMOX1;VASH2;STAT5A;THBS4;PI...      AHCYL1
 2     SCNN1A;SLC12A6;ATP6V1B1;KCNH2;CAV1;GRIN1;SLC7A...      AHCYL1
 3               S100A2;PTP4A3;LOXL2;PLEKHG5;LPXN;PLXND1      AHCYL1
 4                        HBA1;APOE;HMOX1;FYN;AGAP3;PDK2      AHCYL1
 ...                                                 ...         ...
 2032  SIDT2;RNASEH2B;METTL3;ISG20;NUDT12;HNRNPD;FEN1...      AHCYL1
 2033  FBXO31;CDC20;CDC16;PSMC1;SKP2;PTTG1;BUB1B;PSMB...      AHCYL1
 2034  BTRC;DBF4B;DBF4;CDC20;CDC16;XPC;PSMC1;BUB1B;TF...      AHCYL1
 2035  GTPBP1;LARS2;EEF1G;FASTKD2;PTCD3;DARS2;IGHMBP2...      AHCYL1
 2036  GCFC2;SMN1;GEMIN5;SNUPN;CPSF7;CLP1;MDN1;SART3;...      AHCYL1

           Guide Direction
 0     AHCYL1_AP        Up
 1     AHCYL1_AP        Up
 2     AHCYL1_AP        Up
 3     AHCYL1_AP        Up
 4     AHCYL1_AP        Up
 ...         ...       ...
 2032  AHCYL1_AP      Down
 2033  AHCYL1_AP      Down
 2034  AHCYL1_AP      Down
 2035  AHCYL1_AP      Down
 2036  AHCYL1_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  glucose 6-phosphate metabolic process (GO:0051...  0.7667
 1     prerank  positive regulation of potassium ion transport...  0.7394
 2     prerank  regulation of potassium ion transmembrane tran...  0.6627
 3     prerank                      skin development (GO:0043588)  0.5582
 4     prerank                     lipid homeostasis (GO:0055088)  0.6086
 ...       ...                                                ...     ...
 2032  prerank          regulation of mRNA stability (GO:0043488) -0.1234
 2033  prerank                   mitotic cytokinesis (GO:0000281) -0.1156
 2034  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1113
 2035  prerank  cellular response to ionizing radiation (GO:00... -0.1035
 2036  prerank  transcription-coupled nucleotide-excision repa... -0.0892

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9287    0.0000    0.2687     0.1730    3/17   1.47%
 1     1.8924    0.0025    0.2356     0.2740    4/16   5.02%
 2     1.8806    0.0000    0.1862     0.3120    8/26  11.88%
 3     1.8265    0.0000    0.2943     0.5370   12/47  12.52%
 4     1.8051    0.0000    0.3065     0.6330    9/39   7.14%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2010    1.0000    1.0000     1.0000  10/128  16.64%
 2033 -0.1875    1.0000    1.0000     1.0000   45/45  88.49%
 2034 -0.1796    1.0000    1.0000     1.0000  86/160  42.32%
 2035 -0.1657    1.0000    1.0000     1.0000   43/43  89.69%
 2036 -0.1438    1.0000    1.0000     1.0000   24/73  37.60%

                                              Lead_genes Target_Gene   Guide  \
 0                                      PGM2L1;H6PD;SHPK         SP1  SP1_MP
 1                           GABBR2;ADRA2A;KCNMB4;KCNMB3         SP1  SP1_MP
 2     GABBR2;BIN1;KCNMB4;KCNMB3;CAV1;CACNA1D;KCNAB2;...         SP1  SP1_MP
 3     ANXA1;ABCB6;CDSN;CLDN1;OPN3;ADAM9;COL3A1;ABCA1...         SP1  SP1_MP
 4     RCN3;APOE;MLXIPL;PRKAA2;ABHD8;NR1H3;TLCD2;DGAT...         SP1  SP1_MP
 ...                                                 ...         ...     ...
 2032  DND1;AXIN2;FASTKD3;FASTKD1;PCID2;METTL14;METTL...         SP1  SP1_MP
 2033  SNX33;BBS4;MITD1;TTC19;CENPA;ROCK1;EFHC1;NUSAP...         SP1  SP1_MP
 2034  AGO1;NBAS;HELZ2;DCPS;MAGOHB;XRN1;SAMD4A;MAGOH;...         SP1  SP1_MP
 2035  RAD9B;INTS7;LIG4;HUS1;XRCC5;SPIDR;MDM2;CLOCK;R...         SP1  SP1_MP
 2036  POLD3;PPIE;GTF2H2;ERCC8;POLK;ERCC5;COPS5;CDK7;...         SP1  SP1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of T cell proliferation (G...  0.6845
 1     prerank       regulation of T cell activation (GO:0050863)  0.7524
 2     prerank  regulation of humoral immune response (GO:0002...  0.7215
 3     prerank                    lipid modification (GO:0030258)  0.6924
 4     prerank  regulation of defense response to virus by hos...  0.6482
 ...       ...                                                ...     ...
 2032  prerank         DNA-dependent DNA replication (GO:0006261) -0.1200
 2033  prerank    positive regulation of translation (GO:0045727) -0.1127
 2034  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0976
 2035  prerank                       gene expression (GO:0010467) -0.0928
 2036  prerank  regulation of hematopoietic progenitor cell di... -0.0736

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8415    0.0063    0.7744     0.4560    8/27   5.72%
 1     1.8324    0.0000    0.4348     0.4960    9/17  14.81%
 2     1.7575    0.0026    0.7776     0.8010    6/17   8.95%
 3     1.7309    0.0053    0.7941     0.8890    5/16   5.61%
 4     1.7258    0.0000    0.6732     0.8960    4/23   1.58%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2003    1.0000    1.0000     1.0000  42/122  39.58%
 2033 -0.1856    1.0000    1.0000     1.0000   81/82  84.22%
 2034 -0.1660    1.0000    1.0000     1.0000  18/160  27.34%
 2035 -0.1557    1.0000    1.0000     1.0000  54/324  28.56%
 2036 -0.1246    1.0000    1.0000     1.0000    1/63   5.38%

                                              Lead_genes Target_Gene   Guide  \
 0         IL15;IL23A;IGF2;AGER;TNFSF9;ICOSLG;JAK3;ANXA1         SP1  SP1_AP
 1     TNFSF9;IL4I1;JAK3;PAG1;PTPN22;CCDC88B;ABL1;LAT...         SP1  SP1_AP
 2                     C1R;CCR7;PROS1;C5AR1;FCGR2B;SUSD4         SP1  SP1_AP
 3                        DGKG;CYP3A5;PORCN;SGPP2;LPCAT3         SP1  SP1_AP
 4                            TRIM6;IL23A;TNFAIP3;ZDHHC1         SP1  SP1_AP
 ...                                                 ...         ...     ...
 2032  PRIMPOL;GINS3;SIRT7;WDHD1;RFC2;POLA2;NOC3L;POL...         SP1  SP1_AP
 2033  PASK;POLDIP3;METTL14;USP16;METTL5;NSUN5;EIF2B5...         SP1  SP1_AP
 2034  HELZ2;DCP1B;TUT1;MTPAP;DHX34;AGO1;CNOT6;PDE12;...         SP1  SP1_AP
 2035  ATXN1;NKX2-8;NOVA1;NUP85;SCX;POLDIP3;CPSF1;RBM...         SP1  SP1_AP
 2036                                               ITCH         SP1  SP1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank   response to organic cyclic compound (GO:0014070)  0.6938
 1     prerank  positive regulation of organelle organization ...  0.7131
 2     prerank         response to hydrogen peroxide (GO:0042542)  0.6106
 3     prerank  positive regulation of response to wounding (G...  0.7459
 4     prerank     actin cytoskeleton reorganization (GO:0031532)  0.6058
 ...       ...                                                ...     ...
 2032  prerank         regulation of mRNA processing (GO:0050684) -0.1370
 2033  prerank  regulation of cellular amine metabolic process... -0.1375
 2034  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1264
 2035  prerank           nuclear membrane reassembly (GO:0031468) -0.1200
 2036  prerank  microtubule cytoskeleton organization involved... -0.1155

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9263    0.0000    0.2324     0.1470    7/28   8.59%
 1     1.9167    0.0000    0.1346     0.1680    2/23   0.08%
 2     1.8174    0.0000    0.3654     0.4950    5/39   2.65%
 3     1.8126    0.0027    0.2932     0.5170    5/17   6.12%
 4     1.8034    0.0000    0.2695     0.5620    9/46   6.33%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2094    1.0000    1.0000     1.0000   33/33  86.35%
 2033 -0.2072    1.0000    1.0000     1.0000    4/45  19.05%
 2034 -0.1932    1.0000    1.0000     1.0000  38/121  34.22%
 2035 -0.1811    1.0000    1.0000     1.0000    9/54  24.25%
 2036 -0.1794    1.0000    1.0000     1.0000   5/116   8.81%

                                              Lead_genes Target_Gene     Guide  \
 0              ANXA1;AQP3;GGT1;SLC1A1;IGFBP5;GGT7;SOCS2       UPF3B  UPF3B_MP
 1                                        ANXA1;PPARGC1A       UPF3B  UPF3B_MP
 2                             ANXA1;HBA1;FYN;PAX2;HMOX1       UPF3B  UPF3B_MP
 3                          ANXA1;CLDN1;DMTN;HBEGF;PRKCE       UPF3B  UPF3B_MP
 4     ANXA1;CXADR;S1PR2;PHACTR1;ANTXR1;DMTN;AUTS2;RI...       UPF3B  UPF3B_MP
 ...                                                 ...         ...       ...
 2032  METTL16;RBM23;SRSF10;SAFB2;KHDRBS1;CDK11B;SRPK...       UPF3B  UPF3B_MP
 2033                             OAZ3;OAZ2;PSME4;PSMD10       UPF3B  UPF3B_MP
 2034  SMN1;PRPF18;GEMIN4;RPF2;DDX23;CPSF6;SHQ1;ZRSR2...       UPF3B  UPF3B_MP
 2035  UBXN2B;CHMP4A;NUP188;REEP4;NUP85;CHMP3;CHMP4C;...       UPF3B  UPF3B_MP
 2036                        KNTC1;TUBG2;SKA1;STIL;CENPI       UPF3B  UPF3B_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of chemokine production (G...  0.7486
 1     prerank  positive regulation of organelle organization ...  0.6392
 2     prerank  positive regulation of interferon-beta product...  0.6049
 3     prerank      fatty-acyl-CoA metabolic process (GO:0035337)  0.6494
 4     prerank   fatty-acyl-CoA biosynthetic process (GO:0046949)  0.6058
 ...       ...                                                ...     ...
 2032  prerank          sister chromatid segregation (GO:0000819) -0.1339
 2033  prerank  positive regulation of transcription from RNA ... -0.1285
 2034  prerank  SRP-dependent cotranslational protein targetin... -0.1267
 2035  prerank                        nuclear export (GO:0051168) -0.1130
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.0819

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.0275    0.0000    0.0541     0.0440   10/24  10.04%
 1     1.7094    0.0047    1.0000     0.9140    4/23   6.83%
 2     1.6921    0.0052    1.0000     0.9400    7/27   8.33%
 3     1.6770    0.0138    1.0000     0.9570    2/19   1.93%
 4     1.6747    0.0149    0.9280     0.9590    3/23   1.93%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1961    1.0000    1.0000     1.0000   13/31  41.47%
 2033 -0.1916    1.0000    1.0000     1.0000    1/21   9.32%
 2034 -0.1867    1.0000    1.0000     1.0000   88/89  78.72%
 2035 -0.1672    1.0000    1.0000     1.0000   11/76  25.63%
 2036 -0.1202    1.0000    1.0000     1.0000  32/121  39.95%

                                              Lead_genes Target_Gene     Guide  \
 0     CD74;OAS1;TLR2;F2RL1;AGER;OAS3;C5;FFAR2;TIRAP;...       UPF3B  UPF3B_AP
 1                            ANXA1;PPARGC1A;SMCR8;C2CD5       UPF3B  UPF3B_AP
 2                   OAS1;TLR2;ISG15;OAS3;IRF1;IRF5;IRF7       UPF3B  UPF3B_AP
 3                                            ACSL4;PPT2       UPF3B  UPF3B_AP
 4                                     ACSL4;ACSBG1;PPT2       UPF3B  UPF3B_AP
 ...                                                 ...         ...       ...
 2032  TUBG2;SPAG5;TOP2A;ZW10;ZWINT;LATS1;INO80;KLHL2...       UPF3B  UPF3B_AP
 2033                                             NOTCH1       UPF3B  UPF3B_AP
 2034  SEC61A2;SRP68;SRP72;SEC61A1;SRP9;RPL13A;RPL24;...       UPF3B  UPF3B_AP
 2035  NUP62CL;XPO4;NUP214;CHP1;ATXN1;DHX38;STRADA;TH...       UPF3B  UPF3B_AP
 2036  PPAN;PRMT7;MDN1;ZRSR2;SART3;DDX23;DHX29;GEMIN4...       UPF3B  UPF3B_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank             cellular response to heat (GO:0034605)  0.6958
 1     prerank  positive regulation of wound healing (GO:0090303)  0.6617
 2     prerank  negative regulation of reactive oxygen species...  0.7322
 3     prerank  regulation of release of sequestered calcium i...  0.6753
 4     prerank  regulation of nervous system development (GO:0...  0.6415
 ...       ...                                                ...     ...
 2032  prerank  mitotic G1 DNA damage checkpoint signaling (GO... -0.1424
 2033  prerank                 RNA 3&#39;-end processing (GO:0031123) -0.1402
 2034  prerank  regulation of G2/M transition of mitotic cell ... -0.1229
 2035  prerank                   endocytic recycling (GO:0032456) -0.1222
 2036  prerank  regulation of mRNA catabolic process (GO:0061013) -0.0918

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8657    0.0000    0.5419     0.3290    4/31   4.79%
 1     1.7386    0.0059    1.0000     0.8600    6/25   6.19%
 2     1.7140    0.0047    1.0000     0.9130    4/15   5.65%
 3     1.7005    0.0027    1.0000     0.9420    4/19   4.57%
 4     1.6796    0.0085    1.0000     0.9670    6/24   5.65%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2217    1.0000    1.0000     1.0000    2/60   5.60%
 2033 -0.2212    1.0000    1.0000     1.0000   11/62  22.20%
 2034 -0.1974    1.0000    1.0000     1.0000  18/136  20.03%
 2035 -0.1945    1.0000    1.0000     1.0000   10/41  25.99%
 2036 -0.1462    1.0000    1.0000     1.0000  32/112  34.43%

                                              Lead_genes Target_Gene     Guide  \
 0                                ANO1;TRPV4;HMOX1;HSPA6       TGIF1  TGIF1_MP
 1                   ADRA2A;ANXA1;HBEGF;HPSE;DMTN;FERMT1       TGIF1  TGIF1_MP
 2                              SLC18A2;PPARA;PAX2;SIRT2       TGIF1  TGIF1_MP
 3                             LIME1;UBASH3B;GPER1;PTK2B       TGIF1  TGIF1_MP
 4                      WNT3;NPHP3;DLL1;TENM4;GBX2;SIRT2       TGIF1  TGIF1_MP
 ...                                                 ...         ...       ...
 2032                                        TFDP2;PIDD1       TGIF1  TGIF1_MP
 2033  TUT1;U2AF1L4;PNPT1;RPRD1B;SYMPK;CLP1;RPRD2;THO...       TGIF1  TGIF1_MP
 2034  CEP41;NDE1;HAUS2;HAUS7;TUBA4A;CEP131;CEP63;SFI...       TGIF1  TGIF1_MP
 2035  EHD3;VPS53;SNX12;EHD1;VPS52;RAB17;RAB7A;VPS26A...       TGIF1  TGIF1_MP
 2036  TNFSF13;NUP214;PNPT1;MOV10;UPF1;PSMC6;PSMF1;DI...       TGIF1  TGIF1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of biosynthetic process (G...  0.7262
 1     prerank  negative regulation of T cell activation (GO:0...  0.6857
 2     prerank  regulation of potassium ion transmembrane tran...  0.6034
 3     prerank        in utero embryonic development (GO:0001701) -0.9568
 4     prerank  negative regulation of type I interferon-media...  0.7089
 ...       ...                                                ...     ...
 2032  prerank        nucleic acid metabolic process (GO:0090304) -0.1373
 2033  prerank  regulation of transcription from RNA polymeras... -0.1381
 2034  prerank                 protein stabilization (GO:0050821) -0.1363
 2035  prerank    positive regulation of translation (GO:0045727) -0.1345
 2036  prerank  regulation of cell cycle G1/S phase transition... -0.1227

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9967    0.0000    0.0651     0.0590    5/25   3.00%
 1     1.7498    0.0097    1.0000     0.8820    7/17   7.73%
 2     1.7054    0.0028    1.0000     0.9520    9/26  13.18%
 3    -1.6973    0.0016    1.0000     0.6640    4/21   1.31%
 4     1.6822    0.0090    1.0000     0.9760    4/15   5.38%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2372    1.0000    1.0000     1.0000   31/67  38.58%
 2033 -0.2365    1.0000    1.0000     1.0000   17/65  30.85%
 2034 -0.2337    1.0000    1.0000     1.0000  13/147  15.92%
 2035 -0.2274    1.0000    1.0000     1.0000   15/82  26.50%
 2036 -0.2129    1.0000    1.0000     1.0000    5/29  26.89%

                                              Lead_genes Target_Gene     Guide  \
 0                      MLXIPL;CREB3L1;SORBS1;SIRT4;WNT4       TGIF1  TGIF1_AP
 1          HLA-G;HLA-DRB1;JAK3;IL4I1;FOXP3;FCGR2B;VTCN1       TGIF1  TGIF1_AP
 2     GABBR2;KCNH2;KCNIP3;AMIGO1;NEDD4;BIN1;KCNMB4;K...       TGIF1  TGIF1_AP
 3                                 BMP2;IGF2;FOXD3;EGFL8       TGIF1  TGIF1_AP
 4                                NLRC5;OAS1;SAMHD1;MUL1       TGIF1  TGIF1_AP
 ...                                                 ...         ...       ...
 2032  DNASE1L2;GTF2F2;WRN;POLR2B;SETMAR;POLR2A;ATXN2...       TGIF1  TGIF1_AP
 2033  STOX1;RBPJ;PSMD5;EPAS1;PSMC6;PSME3;UBC;PSMD13;...       TGIF1  TGIF1_AP
 2034  HYPK;NAA16;PER3;USP27X;NCLN;TRIM39;STK3;DVL1;M...       TGIF1  TGIF1_AP
 2035  CPEB3;EIF5AL1;NSUN5;FASTKD2;DDX3X;NAT10;KHDRBS...       TGIF1  TGIF1_AP
 2036                     TRIM39;ATP2B4;PSME3;CDC73;TAF1       TGIF1  TGIF1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3         Down
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                           JNK cascade (GO:0007254)  0.6575
 1     prerank  negative regulation of proteolysis involved in...  0.7044
 2     prerank  positive regulation of protein localization to...  0.6240
 3     prerank       long-chain fatty acid transport (GO:0015909) -0.9352
 4     prerank  positive regulation of viral life cycle (GO:19...  0.6891
 ...       ...                                                ...     ...
 2032  prerank    positive regulation of translation (GO:0045727) -0.1100
 2033  prerank  regulation of G2/M transition of mitotic cell ... -0.1061
 2034  prerank                rRNA metabolic process (GO:0016072) -0.1045
 2035  prerank                      ncRNA processing (GO:0034470) -0.1013
 2036  prerank                       rRNA processing (GO:0006364) -0.0777

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8364    0.0028    0.6997     0.4560    11/35  14.95%
 1     1.7924    0.0026    0.6684     0.6740     3/22   5.28%
 2     1.7842    0.0031    0.4918     0.7030    19/41  20.30%
 3    -1.7255    0.0000    1.0000     0.7040     3/22   0.96%
 4     1.7248    0.0123    0.8108     0.9290     4/19   5.45%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1897    1.0000    1.0000     1.0000    12/82  21.07%
 2033 -0.1841    1.0000    1.0000     1.0000   34/136  29.48%
 2034 -0.1823    1.0000    1.0000     1.0000   28/150  30.85%
 2035 -0.1772    1.0000    1.0000     1.0000   40/185  30.85%
 2036 -0.1355    1.0000    1.0000     1.0000  164/165  87.34%

                                              Lead_genes Target_Gene     Guide  \
 0     ARHGEF6;DUSP9;MAP3K10;MAP4K2;MAPK10;TRAF6;TAB1...       YWHAZ  YWHAZ_MP
 1                                      HFE;QRICH2;EPHA4       YWHAZ  YWHAZ_MP
 2     CLIP3;RANGRF;LRP1;PRKCE;EPHA3;SORBS1;PTPN9;ZDH...       YWHAZ  YWHAZ_MP
 3                                     PRKAA2;APOE;CPT1B       YWHAZ  YWHAZ_MP
 4                           CD74;TRIM38;HLA-DRB1;VPS37B       YWHAZ  YWHAZ_MP
 ...                                                 ...         ...       ...
 2032  EIF5AL1;CPEB3;FASTKD2;TRMT10C;METTL14;MRPS27;U...       YWHAZ  YWHAZ_MP
 2033  PSMB9;NINL;HAUS5;PINX1;CNTRL;PCM1;CEP164;CKAP5...       YWHAZ  YWHAZ_MP
 2034  DEDD2;DDX47;DHX37;EXOSC9;PIH1D1;RRP12;DDX10;SE...       YWHAZ  YWHAZ_MP
 2035  DDX47;INTS9;DHX37;MRPL44;EXOSC9;INTS5;INTS1;FA...       YWHAZ  YWHAZ_MP
 2036  ERI1;DDX47;DHX37;EXOSC9;PIH1D1;NAT10;RRP12;DDX...       YWHAZ  YWHAZ_MP

      Direction
 0           Up
 1           Up
 2           Up
 3         Down
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  heparan sulfate proteoglycan metabolic process...  0.7260
 1     prerank  regulation of T cell differentiation (GO:0045580) -0.9435
 2     prerank                    retina homeostasis (GO:0001895) -0.9549
 3     prerank                lamellipodium assembly (GO:0030032)  0.6575
 4     prerank  positive regulation of wound healing (GO:0090303)  0.5906
 ...       ...                                                ...     ...
 2032  prerank  regulation of translational initiation (GO:000... -0.1279
 2033  prerank  nuclear-transcribed mRNA catabolic process, de... -0.1230
 2034  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1168
 2035  prerank                      ncRNA processing (GO:0034470) -0.1027
 2036  prerank  negative regulation of mitotic cell cycle phas... -0.0981

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8239    0.0025    1.0000     0.5960    8/18  11.09%
 1    -1.6566    0.0000    0.9239     0.6000    4/20   2.28%
 2    -1.6397    0.0034    0.9810     0.8430    2/15   0.92%
 3     1.6327    0.0305    1.0000     0.9980    3/17   3.02%
 4     1.6261    0.0206    1.0000     0.9980    9/25  18.75%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2094    1.0000    1.0000     1.0000   21/59  34.30%
 2033 -0.2038    1.0000    1.0000     1.0000   13/51  29.18%
 2034 -0.1962    1.0000    1.0000     1.0000  62/160  37.65%
 2035 -0.1724    1.0000    1.0000     1.0000  70/185  37.75%
 2036 -0.1644    1.0000    1.0000     1.0000    9/74  20.79%

                                              Lead_genes Target_Gene     Guide  \
 0     HPSE;HS3ST3B1;XYLT1;EXTL3;SULF1;XYLT2;HS6ST1;EXT1       YWHAZ  YWHAZ_AP
 1                                 TCF7;FOXP3;PRDM1;RHOH       YWHAZ  YWHAZ_AP
 2                                             POTEI;LYZ       YWHAZ  YWHAZ_AP
 3                                ARHGEF6;ABLIM3;ARHGEF4       YWHAZ  YWHAZ_AP
 4     ANXA1;HPSE;ADRA2A;HBEGF;PRKCE;CLDN1;ST3GAL4;RR...       YWHAZ  YWHAZ_AP
 ...                                                 ...         ...       ...
 2032  KLHL25;ALKBH1;EIF1B;YTHDF2;MIF4GD;EIF2AK4;LARP...       YWHAZ  YWHAZ_AP
 2033  SAMD4A;DCPS;SKIV2L;TNKS1BP1;LSM6;EXOSC9;ZFP36;...       YWHAZ  YWHAZ_AP
 2034  SAMD4A;DCPS;TUT1;ZC3H12A;TNKS1BP1;DHX34;XRN1;R...       YWHAZ  YWHAZ_AP
 2035  INTS4;SMAD1;INTS9;ZCCHC8;INTS1;RPP30;TUT1;DDX4...       YWHAZ  YWHAZ_AP
 2036  MYO16;CDK6;PSME1;PKD2;PSMB9;PSMB6;USP47;CDKN1A...       YWHAZ  YWHAZ_AP

      Direction
 0           Up
 1         Down
 2         Down
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of glucose transmembrane t...  0.6900
 1     prerank        glycoprotein metabolic process (GO:0009100)  0.6028
 2     prerank  positive regulation of glucose import (GO:0046...  0.7016
 3     prerank  positive regulation of phospholipase activity ... -0.9546
 4     prerank                 transferrin transport (GO:0033572)  0.6041
 ...       ...                                                ...     ...
 2032  prerank                   ribosome biogenesis (GO:0042254) -0.1245
 2033  prerank                      ncRNA processing (GO:0034470) -0.1213
 2034  prerank                rRNA metabolic process (GO:0016072) -0.1182
 2035  prerank    positive regulation of translation (GO:0045727) -0.0982
 2036  prerank                       rRNA processing (GO:0006364) -0.0833

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7733    0.0079    1.0000     0.7650    5/21   6.82%
 1     1.7596    0.0000    1.0000     0.8200   14/37  14.08%
 2     1.7196    0.0125    1.0000     0.9240    4/17   6.82%
 3    -1.6885    0.0050    0.1416     0.1250    3/15   1.78%
 4     1.6814    0.0029    1.0000     0.9850   11/29  21.39%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2090    1.0000    1.0000     1.0000  31/181  28.34%
 2033 -0.2028    1.0000    1.0000     1.0000  25/185  23.36%
 2034 -0.1987    1.0000    1.0000     1.0000  18/150  23.36%
 2035 -0.1640    1.0000    1.0000     1.0000   81/82  84.90%
 2036 -0.1399    1.0000    1.0000     1.0000  19/165  23.36%

                                              Lead_genes Target_Gene    Guide  \
 0                     CLIP3;SORBS1;CAPN10;CLTCL1;CREBL2        P4HB  P4HB_MP
 1     ADAMTS13;ENGASE;ADAMTS9;MAN1C1;ST6GALNAC6;HPSE...        P4HB  P4HB_MP
 2                           SORBS1;CAPN10;CLTCL1;CREBL2        P4HB  P4HB_MP
 3                                      FLT1;NTRK3;AGTR1        P4HB  P4HB_MP
 4     HFE;ATP6V0A4;ATP6V1E2;ATP6V0A1;ATP6V1C1;STEAP3...        P4HB  P4HB_MP
 ...                                                 ...         ...      ...
 2032  SENP3;ZNF658;WDR36;PAK1IP1;FCF1;DDX31;UTP15;MD...        P4HB  P4HB_MP
 2033  SENP3;WDR36;ZCCHC8;FCF1;AGO4;DGCR8;UTP15;MDN1;...        P4HB  P4HB_MP
 2034  SENP3;WDR36;XRN1;FCF1;UTP15;MDN1;KRR1;NOB1;RPF...        P4HB  P4HB_MP
 2035  ZCCHC4;FASTKD3;THBS1;PASK;HABP4;EIF2S3;RPS27L;...        P4HB  P4HB_MP
 2036  SENP3;WDR36;FCF1;UTP15;MDN1;KRR1;NOB1;RPF1;UTP...        P4HB  P4HB_MP

      Direction
 0           Up
 1           Up
 2           Up
 3         Down
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of intrinsic apoptotic sig...  0.5986
 1     prerank        regulation of synapse assembly (GO:0051963)  0.6360
 2     prerank  positive regulation of vascular endothelial gr...  0.6815
 3     prerank  regulation of vascular endothelial growth fact...  0.6815
 4     prerank  regulation of sodium ion transmembrane transpo...  0.6092
 ...       ...                                                ...     ...
 2032  prerank      aerobic electron transport chain (GO:0019646) -0.1250
 2033  prerank              translational elongation (GO:0006414) -0.1197
 2034  prerank  regulation of stem cell differentiation (GO:20... -0.1183
 2035  prerank               protein targeting to ER (GO:0045047) -0.1200
 2036  prerank  mitochondrial respiratory chain complex assemb... -0.1067

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.6895    0.0157    1.0000     0.9670    9/24  17.07%
 1     1.6444    0.0331    1.0000     0.9910    3/19   1.04%
 2     1.6365    0.0093    1.0000     0.9940    6/15  15.65%
 3     1.6365    0.0093    1.0000     0.9940    6/15  15.65%
 4     1.6154    0.0248    1.0000     0.9970    9/23  10.50%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1945    1.0000    1.0000     1.0000   29/64  44.35%
 2033 -0.1870    1.0000    1.0000     1.0000  28/101  34.08%
 2034 -0.1865    1.0000    1.0000     1.0000    1/71   3.73%
 2035 -0.1858    1.0000    1.0000     1.0000   2/100   9.01%
 2036 -0.1664    1.0000    1.0000     1.0000   37/82  42.73%

                                              Lead_genes Target_Gene    Guide  \
 0     CD74;CCAR2;TRIM32;ZNF385A;TMEM161A;TAF9;DDIAS;...        P4HB  P4HB_AP
 1                                    BHLHB9;CLSTN3;TLR2        P4HB  P4HB_AP
 2                         HPSE;RORA;SULF1;FLT4;C5;GATA4        P4HB  P4HB_AP
 3                         HPSE;RORA;SULF1;FLT4;C5;GATA4        P4HB  P4HB_AP
 4     FGF13;FGF11;PRKCE;SCN1B;PTPN3;CAMK2D;UTRN;GLRX...        P4HB  P4HB_AP
 ...                                                 ...         ...      ...
 2032  UQCRHL;COX10;NDUFA8;UQCRH;NDUFB1;NDUFS6;NDUFB7...        P4HB  P4HB_AP
 2033  MRPL32;MRPS31;MRPL53;GTPBP2;MRPL30;MRPL38;MRPL...        P4HB  P4HB_AP
 2034                                               LMO1        P4HB  P4HB_AP
 2035                                       CHMP4A;EDEM1        P4HB  P4HB_AP
 2036  IMMP2L;SDHAF1;OMA1;FOXRED1;COX19;ECSIT;CHCHD4;...        P4HB  P4HB_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of cardiac muscle contraction (GO:0...  0.7727
 1     prerank  positive regulation of immune response (GO:005...  0.6309
 2     prerank    hepaticobiliary system development (GO:0061008)  0.7156
 3     prerank              aortic valve development (GO:0003176)  0.6561
 4     prerank  positive regulation of lipid biosynthetic proc...  0.6412
 ...       ...                                                ...     ...
 2032  prerank             regulation of cytokinesis (GO:0032465) -0.1530
 2033  prerank                postreplication repair (GO:0006301) -0.1459
 2034  prerank   mitochondrial membrane organization (GO:0007006) -0.1452
 2035  prerank  regulation of mitotic cell cycle phase transit... -0.1181
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1086

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8786    0.0000    0.4649     0.2920    3/16   1.52%
 1     1.8103    0.0040    0.6206     0.5840   12/37  13.84%
 2     1.7564    0.0114    0.8324     0.8090    5/18  15.96%
 3     1.7316    0.0092    0.8386     0.9010    5/24   6.12%
 4     1.7158    0.0111    0.8068     0.9370    7/23   9.85%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2482    1.0000    1.0000     1.0000   12/67  22.17%
 2033 -0.2425    1.0000    1.0000     1.0000    9/41  24.70%
 2034 -0.2398    1.0000    1.0000     1.0000   10/27  35.02%
 2035 -0.1987    1.0000    1.0000     1.0000  28/174  26.18%
 2036 -0.1800    1.0000    1.0000     1.0000  16/160  23.89%

                                              Lead_genes Target_Gene     Guide  \
 0                                      CHGA;SCN5A;PDE4D       NCOR2  NCOR2_MP
 1     IL15;HLA-DRA;CD74;CYBA;HLA-DRB1;ITGB2;POLR3F;S...       NCOR2  NCOR2_MP
 2                          TGFBR3;NKX2-8;MET;WNT4;CEBPA       NCOR2  NCOR2_MP
 3                      SNAI2;TWIST1;EMILIN1;SLIT2;SMAD6       NCOR2  NCOR2_MP
 4         SORBS1;APOE;PPARA;SLC45A3;NR1H3;SLC27A1;PLIN5       NCOR2  NCOR2_MP
 ...                                                 ...         ...       ...
 2032  FSD1;CXCR5;KLHL9;MAP10;MYO19;CENPV;UVRAG;SVIL;...       NCOR2  NCOR2_MP
 2033  PRIMPOL;POLD3;POLH;ISG15;UBE2V1;RFC4;TRIM25;RE...       NCOR2  NCOR2_MP
 2034  BAK1;APOO;MFN1;BCL2;SPG7;TMEM11;IMMT;PMAIP1;TI...       NCOR2  NCOR2_MP
 2035  PSMB9;SIRT2;TUBA4A;CEP72;CLASP1;NEK6;CEP63;CEP...       NCOR2  NCOR2_MP
 2036  DIS3L2;TUT1;PAN3;PATL1;SAMD4A;PAN2;SMG9;PARN;E...       NCOR2  NCOR2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of glucose transmembrane t...  0.7013
 1     prerank  positive regulation of release of cytochrome c...  0.6795
 2     prerank  nucleobase-containing compound biosynthetic pr...  0.6930
 3     prerank            regulation of neuron death (GO:1901214)  0.5630
 4     prerank  regulation of release of cytochrome c from mit...  0.5897
 ...       ...                                                ...     ...
 2032  prerank  ribonucleoprotein complex biogenesis (GO:0022613) -0.1187
 2033  prerank                       mRNA processing (GO:0006397) -0.1154
 2034  prerank                      ncRNA processing (GO:0034470) -0.1150
 2035  prerank                   ribosome biogenesis (GO:0042254) -0.1073
 2036  prerank                rRNA metabolic process (GO:0016072) -0.0786

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8417    0.0000    0.9403     0.5190    5/21   8.50%
 1     1.8362    0.0000    0.5138     0.5530    7/24  10.09%
 2     1.8110    0.0058    0.4716     0.6660    2/18   1.42%
 3     1.7901    0.0000    0.4480     0.7350   16/59  14.36%
 4     1.7173    0.0039    0.8005     0.9340    7/34  10.09%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1931    1.0000    1.0000     1.0000   14/58  31.37%
 2033 -0.1869    1.0000    1.0000     1.0000  89/284  35.79%
 2034 -0.1862    1.0000    1.0000     1.0000  42/185  33.57%
 2035 -0.1733    1.0000    1.0000     1.0000  36/181  31.37%
 2036 -0.1275    1.0000    1.0000     1.0000  26/150  32.14%

                                              Lead_genes Target_Gene     Guide  \
 0                         CLIP3;SORBS1;C2CD5;IRS2;NR4A3       NCOR2  NCOR2_AP
 1               HRK;BMF;TNFSF10;GPER1;BBC3;MLLT11;PINK1       NCOR2  NCOR2_AP
 2                                              CDA;TERT       NCOR2  NCOR2_AP
 3     FCGR2B;FYN;CHGA;SNCB;HLA-F;ITGB2;SARM1;PPARGC1...       NCOR2  NCOR2_AP
 4               HRK;BMF;TNFSF10;GPER1;BBC3;MLLT11;PINK1       NCOR2  NCOR2_AP
 ...                                                 ...         ...       ...
 2032  EMG1;URB2;NAF1;PAK1IP1;ZNF622;SURF6;CUL4B;SHQ1...       NCOR2  NCOR2_AP
 2033  ELAVL2;DHX35;RBM19;GPKOW;PRPF40B;ZCCHC8;DHX8;M...       NCOR2  NCOR2_AP
 2034  DDX47;AGO4;ZCCHC8;DGCR8;WDR36;EMG1;INTS3;TEX10...       NCOR2  NCOR2_AP
 2035  DDX47;WDR36;EMG1;URB2;TEX10;RCL1;MDN1;RRP12;RR...       NCOR2  NCOR2_AP
 2036  DDX47;WDR36;EMG1;TEX10;RCL1;MDN1;RRP12;RRP7A;W...       NCOR2  NCOR2_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of cardiac muscle cell contraction ...  0.7164
 1     prerank               focal adhesion assembly (GO:0048041)  0.7242
 2     prerank               phagosome acidification (GO:0090383)  0.6455
 3     prerank  negative regulation of peptidyl-serine phospho...  0.6839
 4     prerank            aortic valve morphogenesis (GO:0003180)  0.6528
 ...       ...                                                ...     ...
 2032  prerank  transcription-coupled nucleotide-excision repa... -0.1327
 2033  prerank               protein targeting to ER (GO:0045047) -0.1294
 2034  prerank   transcription by RNA polymerase III (GO:0006383) -0.1315
 2035  prerank           nuclear membrane reassembly (GO:0031468) -0.1304
 2036  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1028

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8233    0.0033    0.8311     0.4540     9/19  12.82%
 1     1.7752    0.0000    0.8021     0.6920     6/16  14.40%
 2     1.7215    0.0264    1.0000     0.8850     8/21  17.57%
 3     1.7064    0.0062    0.8916     0.9240     6/17  15.89%
 4     1.6859    0.0066    0.8895     0.9580     5/21   4.05%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1966    1.0000    1.0000     1.0000     4/73  10.63%
 2033 -0.1938    1.0000    1.0000     1.0000  100/100  87.18%
 2034 -0.1935    1.0000    1.0000     1.0000    10/26  34.43%
 2035 -0.1908    1.0000    1.0000     1.0000     6/54  17.18%
 2036 -0.1521    1.0000    1.0000     1.0000    14/52  36.73%

                                              Lead_genes Target_Gene  \
 0     ATP2A1;PDE4D;SCN5A;FGF13;RANGRF;CACNA1C;TRPM4;...      JARID2
 1                  SORBS1;TESK2;FERMT2;DLC1;ARHGEF7;SRC      JARID2
 2     ATP6V0A4;ATP6V1C2;ATP6V0A2;ATP6V1B2;ATP6V1B1;A...      JARID2
 3                 PDE4D;MLXIPL;CNKSR3;INPP5J;DDIT4;DKK1      JARID2
 4                       SLIT2;HEY2;EMILIN1;TWIST1;SNAI2      JARID2
 ...                                                 ...         ...
 2032                            GTF2H4;UVSSA;POLD3;POLK      JARID2
 2033  CHMP4A;SEC62;SRPRB;ZFAND2A;ZFAND2B;SEC61A1;RPL...      JARID2
 2034  ELL;GTF3C3;POLR3H;GTF3C4;ICE2;GTF3C2;POLR3K;CR...      JARID2
 2035               NUP43;VRK1;CHMP4A;SEH1L;NUP160;NUP85      JARID2
 2036  PPAN;HEATR3;MRPL1;BOP1;LAS1L;MDN1;NOP16;RPL14;...      JARID2

           Guide Direction
 0     JARID2_MP        Up
 1     JARID2_MP        Up
 2     JARID2_MP        Up
 3     JARID2_MP        Up
 4     JARID2_MP        Up
 ...         ...       ...
 2032  JARID2_MP      Down
 2033  JARID2_MP      Down
 2034  JARID2_MP      Down
 2035  JARID2_MP      Down
 2036  JARID2_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                  cell-matrix adhesion (GO:0007160)  0.5952
 1     prerank                          neurogenesis (GO:0022008)  0.6342
 2     prerank  positive regulation of glucose transmembrane t...  0.6982
 3     prerank  negative regulation of microtubule polymerizat...  0.6538
 4     prerank  regulation of Rac protein signal transduction ...  0.7115
 ...       ...                                                ...     ...
 2032  prerank            nucleotide-excision repair (GO:0006289) -0.1398
 2033  prerank      multivesicular body organization (GO:0036257) -0.1328
 2034  prerank  stress-activated protein kinase signaling casc... -0.1324
 2035  prerank  anaphase-promoting complex-dependent catabolic... -0.1308
 2036  prerank             regulation of translation (GO:0006417) -0.1194

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8713    0.0000    0.5216     0.3020   19/60  13.52%
 1     1.7889    0.0034    0.8291     0.6400   13/31  16.20%
 2     1.7737    0.0000    0.6838     0.7110    9/21  21.19%
 3     1.7121    0.0122    1.0000     0.9250    4/24   4.57%
 4     1.7037    0.0146    0.9695     0.9410    5/15   2.96%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2292    1.0000    1.0000     1.0000  20/101  25.03%
 2033 -0.2248    1.0000    1.0000     1.0000   10/31  32.90%
 2034 -0.2132    1.0000    1.0000     1.0000    4/26  23.98%
 2035 -0.2116    1.0000    1.0000     1.0000    9/77  19.83%
 2036 -0.1965    1.0000    1.0000     1.0000  17/152  19.63%

                                              Lead_genes Target_Gene  \
 0     COL3A1;SORBS1;HPSE;ADAMTS13;ITGB2;ITGB7;ITGA7;...      JARID2
 1     ANXA1;MESP1;CHAC1;DAGLA;DAGLB;TGFB2;SIX4;CIT;B...      JARID2
 2     CLIP3;SORBS1;C2CD5;CLTCL1;CREBL2;OCLN;IRS1;OSB...      JARID2
 3                             TRIM54;CLIP3;MAP2;ARHGEF2      JARID2
 4                 RASGRF1;ARHGAP44;ARHGAP24;AUTS2;CADM4      JARID2
 ...                                                 ...         ...
 2032  UVSSA;GTF2H4;COPS3;HUS1;XPC;ERCC5;RFC2;POLR2B;...      JARID2
 2033  VPS37D;VPS37C;RAB27A;CHMP7;STAM;CHMP6;CHMP5;VP...      JARID2
 2034                            MAPK8;MAP2K7;MAPK11;UBC      JARID2
 2035  ANAPC10;ANAPC4;CDC16;SKP2;BUB1B;CDC27;FBXO5;AN...      JARID2
 2036  CPEB3;CTIF;RBM4B;EIF2A;POLDIP3;OGFOD1;IGF2BP2;...      JARID2

           Guide Direction
 0     JARID2_AP        Up
 1     JARID2_AP        Up
 2     JARID2_AP        Up
 3     JARID2_AP        Up
 4     JARID2_AP        Up
 ...         ...       ...
 2032  JARID2_AP      Down
 2033  JARID2_AP      Down
 2034  JARID2_AP      Down
 2035  JARID2_AP      Down
 2036  JARID2_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank         response to hydrogen peroxide (GO:0042542)  0.6468
 1     prerank  cellular response to hydrogen peroxide (GO:007...  0.6652
 2     prerank  nucleobase-containing compound biosynthetic pr...  0.6926
 3     prerank  negative regulation of phosphate metabolic pro...  0.6477
 4     prerank  nucleotide-binding domain, leucine rich repeat...  0.6110
 ...       ...                                                ...     ...
 2032  prerank           sterol biosynthetic process (GO:0016126) -0.1349
 2033  prerank  inner mitochondrial membrane organization (GO:... -0.1354
 2034  prerank  nuclear-transcribed mRNA catabolic process, ex... -0.1367
 2035  prerank                 RNA 3&#39;-end processing (GO:0031123) -0.1274
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1099

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9448    0.0000    0.1958     0.1440    7/39   5.25%
 1     1.8688    0.0000    0.3169     0.3770    9/28  12.65%
 2     1.7746    0.0090    0.7086     0.7530    2/18   0.09%
 3     1.6749    0.0164    1.0000     0.9730    3/19   7.95%
 4     1.6531    0.0141    1.0000     0.9890    5/22   5.47%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2165    1.0000    1.0000     1.0000    9/29  33.78%
 2033 -0.2096    1.0000    1.0000     1.0000    2/28  15.11%
 2034 -0.2093    0.9987    1.0000     1.0000   13/35  37.47%
 2035 -0.1965    1.0000    1.0000     1.0000   17/62  35.50%
 2036 -0.1719    1.0000    1.0000     1.0000  19/160  24.57%

                                              Lead_genes Target_Gene    Guide  \
 0           HBA1;ANXA1;PAX2;TNFAIP3;MAPK13;MAPK7;CYP1B1        ESR1  ESR1_MP
 1     ANXA1;PAX2;TNFAIP3;MAPK13;MAPK7;CYP1B1;SIGMAR1...        ESR1  ESR1_MP
 2                                              CDA;TERT        ESR1  ESR1_MP
 3                                      CDA;CDKN2A;TESK1        ESR1  ESR1_MP
 4                        NOD1;TNFAIP3;MAP2K6;TRAF6;TAB1        ESR1  ESR1_MP
 ...                                                 ...         ...      ...
 2032  PRKAG2;ARV1;INSIG2;ACLY;DHCR24;NSDHL;MVD;PMVK;...        ESR1  ESR1_MP
 2033                                      TMEM11;CHCHD6        ESR1  ESR1_MP
 2034  DCP1B;PATL1;DCP1A;EXOSC3;DIS3;DCPS;TTC37;CNOT8...        ESR1  ESR1_MP
 2035  POLDIP3;THOC1;ZC3H11A;DHX38;SUPV3L1;CSTF2;MTPA...        ESR1  ESR1_MP
 2036  CNOT6L;DCP1B;XRN1;SAMD4A;PATL1;CNOT3;DCP1A;SMG...        ESR1  ESR1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank        phospholipid dephosphorylation (GO:0046839)  0.6459
 1     prerank  phosphatidylinositol dephosphorylation (GO:004...  0.6645
 2     prerank  positive regulation of response to biotic stim...  0.6389
 3     prerank               focal adhesion assembly (GO:0048041)  0.6594
 4     prerank     actomyosin structure organization (GO:0031032)  0.5001
 ...       ...                                                ...     ...
 2032  prerank  interleukin-1-mediated signaling pathway (GO:0... -0.1263
 2033  prerank            DNA replication initiation (GO:0006270) -0.1287
 2034  prerank  regulation of extrinsic apoptotic signaling pa... -0.1084
 2035  prerank  regulation of hematopoietic progenitor cell di... -0.1001
 2036  prerank  positive regulation of DNA biosynthetic proces... -0.0906

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.9744    0.0000    0.3180     0.2050  14/24  17.20%
 1     1.9554    0.0000    0.2033     0.2570  13/21  17.20%
 2     1.9270    0.0000    0.2031     0.3570   8/24  10.46%
 3     1.8774    0.0000    0.2782     0.5510   6/16  10.30%
 4     1.8285    0.0000    0.3772     0.7290  19/48  21.64%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2229    1.0000    1.0000     1.0000  31/80  39.79%
 2033 -0.2172    1.0000    1.0000     1.0000   5/37  18.21%
 2034 -0.1839    1.0000    1.0000     1.0000  10/51  26.47%
 2035 -0.1720    1.0000    1.0000     1.0000  25/63  42.66%
 2036 -0.1578    1.0000    1.0000     1.0000  19/54  40.11%

                                              Lead_genes Target_Gene    Guide  \
 0     SGPP2;INPP5J;TPTE;MTMR10;SACM1L;MTMR3;MTMR2;MT...        ESR1  ESR1_AP
 1     INPP5J;TPTE;MTMR10;SACM1L;MTMR3;MTMR2;MTMR7;MT...        ESR1  ESR1_AP
 2     OASL;DDX60;CYBA;ADAM8;POLR3B;ANKRD17;POLR3C;ZC...        ESR1  ESR1_AP
 3                 SORBS1;PIP5K1A;TESK2;PEAK1;CTTN;TAOK2        ESR1  ESR1_AP
 4     SORBS1;SIX4;FHOD3;EPB41L2;CIT;EPB41L4B;FRMD3;M...        ESR1  ESR1_AP
 ...                                                 ...         ...      ...
 2032  PELI1;RPS6KA4;PSMD13;PSMD9;PSMB6;PSMB5;PSMB4;P...        ESR1  ESR1_AP
 2033                          PURA;CDT1;POLE4;RPA3;ORC6        ESR1  ESR1_AP
 2034  GPER1;ACVR1;HYAL2;PARK7;TRADD;BID;PYCARD;SIAH2...        ESR1  ESR1_AP
 2035  LMO1;PSMD13;PSMD9;PSMB6;PSMB5;PSMB4;FOXC1;PSMB...        ESR1  ESR1_AP
 2036  PKIB;KLF4;POT1;POLG2;RFC4;CHTF18;RFC2;DKC1;RFC...        ESR1  ESR1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of biomineral tissue devel...  0.6884
 1     prerank     cellular response to BMP stimulus (GO:0071773)  0.5916
 2     prerank  positive regulation of bone mineralization (GO...  0.6688
 3     prerank   positive regulation of ossification (GO:0045778)  0.6593
 4     prerank  negative regulation of protein polymerization ...  0.6752
 ...       ...                                                ...     ...
 2032  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1206
 2033  prerank                      ncRNA processing (GO:0034470) -0.1139
 2034  prerank             mitochondrial translation (GO:0032543) -0.1063
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1016
 2036  prerank  regulation of transcription from RNA polymeras... -0.1046

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8718    0.0000    0.5273     0.3310   10/24  13.52%
 1     1.8231    0.0000    0.5186     0.5330   20/44  14.57%
 2     1.7520    0.0029    0.8472     0.8150    9/21  13.52%
 3     1.7494    0.0031    0.6605     0.8260    9/24  13.52%
 4     1.7429    0.0055    0.5707     0.8480    3/21   0.92%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1957    1.0000    1.0000     1.0000  27/121  28.98%
 2033 -0.1839    1.0000    1.0000     1.0000  67/185  37.08%
 2034 -0.1727    1.0000    1.0000     1.0000  28/102  30.79%
 2035 -0.1651    1.0000    1.0000     1.0000  32/160  31.59%
 2036 -0.1647    1.0000    1.0000     1.0000   37/75  39.81%

                                              Lead_genes Target_Gene     Guide  \
 0     BMP2;WNT6;FZD9;GPM6B;PKDCC;BMPR2;BMPR1B;ACVR2A...       PA2G4  PA2G4_MP
 1     SMAD9;BMP8A;BMP2;MEGF8;SCX;TGFBR3;SMAD7;BMPR2;...       PA2G4  PA2G4_MP
 2     BMP2;FZD9;GPM6B;PKDCC;BMPR2;BMPR1B;ACVR2A;BMP4...       PA2G4  PA2G4_MP
 3     BMP2;FZD9;GPM6B;PKDCC;BMPR2;BMPR1B;ACVR2A;BMP4...       PA2G4  PA2G4_MP
 4                                     CLIP3;SLIT2;KANK3       PA2G4  PA2G4_MP
 ...                                                 ...         ...       ...
 2032  GEMIN8;NLE1;GCFC2;PRMT5;BRIX1;USP39;GEMIN6;CRN...       PA2G4  PA2G4_MP
 2033  AGO4;INTS5;NOL9;MRPL44;LAS1L;AGO1;WDR43;EXOSC3...       PA2G4  PA2G4_MP
 2034  MRPS17;MRPL48;MRPL44;MRPS31;MRPL1;EARS2;MRPS26...       PA2G4  PA2G4_MP
 2035  ZC3H12A;MTPAP;DCP1B;SAMD4A;TNKS1BP1;CNOT6L;AGO...       PA2G4  PA2G4_MP
 2036  KLF2;EGLN2;PSMB10;PSME4;EGLN1;PSMD14;HMOX1;PSM...       PA2G4  PA2G4_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of glucose transmembrane t...  0.7107
 1     prerank  pattern recognition receptor signaling pathway...  0.6145
 2     prerank             peptide catabolic process (GO:0043171)  0.7265
 3     prerank  cellular amino acid catabolic process (GO:0009...  0.5254
 4     prerank                   lipid translocation (GO:0034204)  0.6845
 ...       ...                                                ...     ...
 2032  prerank   mitotic metaphase plate congression (GO:0007080) -0.1420
 2033  prerank               mitochondrial transport (GO:0006839) -0.1348
 2034  prerank  transcription-coupled nucleotide-excision repa... -0.1229
 2035  prerank  nuclear-transcribed mRNA catabolic process, no... -0.1157
 2036  prerank                           translation (GO:0006412) -0.0886

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8363    0.0000    0.9410     0.4570    4/21   5.24%
 1     1.7587    0.0037    1.0000     0.7840   11/36  14.98%
 2     1.7286    0.0049    1.0000     0.8730    7/15  13.28%
 3     1.6671    0.0000    1.0000     0.9790   25/59  24.08%
 4     1.6667    0.0250    1.0000     0.9790    5/15  12.84%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2185    1.0000    1.0000     1.0000    6/50  20.45%
 2033 -0.2112    1.0000    1.0000     1.0000    6/51  19.74%
 2034 -0.1898    1.0000    1.0000     1.0000   12/73  20.95%
 2035 -0.1841    1.0000    1.0000     1.0000  59/110  43.88%
 2036 -0.1397    1.0000    1.0000     1.0000   6/187  10.27%

                                              Lead_genes Target_Gene     Guide  \
 0                             SORBS1;CLIP3;CLTCL1;C2CD5       PA2G4  PA2G4_AP
 1     TRAF6;S100A9;CTSK;TLR2;FFAR2;NOD1;TAB3;UNC93B1...       PA2G4  PA2G4_AP
 2            ENPEP;ERAP1;GGT1;ADAMTS13;TPP1;LTA4H;CHAC2       PA2G4  PA2G4_AP
 3     AMDHD1;IL4I1;GLUD2;GAD1;HNMT;HGD;HMGCLL1;PRODH...       PA2G4  PA2G4_AP
 4                      ATP8B3;ABCC1;ATP8B2;ATP9A;ATP11A       PA2G4  PA2G4_AP
 ...                                                 ...         ...       ...
 2032                 PIBF1;CHMP1B;PINX1;MIS12;EML3;CDT1       PA2G4  PA2G4_AP
 2033        TIMM10B;SLC25A16;ABCB10;GDAP1;TIMM22;TOMM22       PA2G4  PA2G4_AP
 2034  RFC2;AQR;POLK;COPS7B;LIG1;RFC5;POLR2B;ERCC4;PO...       PA2G4  PA2G4_AP
 2035  HELZ2;SKIV2L;CTIF;UPF1;SMG8;MAGOHB;UPF2;SMG1;R...       PA2G4  PA2G4_AP
 2036               LARS2;QRSL1;EEF1G;GATB;GTPBP1;EEF1E1       PA2G4  PA2G4_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of glucose transmembrane t...  0.7339
 1     prerank  organonitrogen compound catabolic process (GO:...  0.6261
 2     prerank  negative regulation of protein polymerization ...  0.7137
 3     prerank                        axon extension (GO:0048675)  0.7506
 4     prerank                    response to ketone (GO:1901654) -0.9285
 ...       ...                                                ...     ...
 2032  prerank             mitochondrial translation (GO:0032543) -0.1309
 2033  prerank          sister chromatid segregation (GO:0000819) -0.1273
 2034  prerank  mitotic G1 DNA damage checkpoint signaling (GO... -0.1288
 2035  prerank  nucleotide-excision repair, DNA incision, 5&#39;-t... -0.1152
 2036  prerank  nucleotide-excision repair, DNA incision (GO:0... -0.1094

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7959    0.0000    1.0000     0.6400    2/21   0.11%
 1     1.7739    0.0000    1.0000     0.7480    6/41   3.33%
 2     1.7728    0.0047    0.6886     0.7550    3/21   1.97%
 3     1.7694    0.0025    0.5437     0.7710    5/17   5.56%
 4    -1.7688    0.0284    1.0000     0.6500    1/15   0.14%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2379    1.0000    1.0000     1.0000  30/102  32.59%
 2033 -0.2365    1.0000    1.0000     1.0000    2/31  11.88%
 2034 -0.2307    1.0000    1.0000     1.0000   18/60  33.15%
 2035 -0.2118    1.0000    1.0000     1.0000   13/37  35.50%
 2036 -0.2010    1.0000    1.0000     1.0000   13/38  35.50%

                                              Lead_genes Target_Gene  \
 0                                          CLIP3;SORBS1      CTNNB1
 1                CTRL;CYP3A5;ADAMTS13;ENPEP;IL4I1;ERAP1      CTNNB1
 2                                      CLIP3;KANK3;MAP2      CTNNB1
 3                          SLC9A6;NRP2;AUTS2;ALCAM;ULK2      CTNNB1
 4                                                  CCR7      CTNNB1
 ...                                                 ...         ...
 2032  QRSL1;GATB;MTRF1L;MRPS14;GATC;MRPL18;MRPL23;MR...      CTNNB1
 2033                                      KIF18B;KNSTRN      CTNNB1
 2034  CNOT3;PIDD1;CNOT6L;CNOT10;E2F7;PLK3;RBL2;PCBP4...      CTNNB1
 2035  GTF2H2;ERCC4;PCNA;RFC3;RFC4;NTHL1;RFC2;RPA3;ER...      CTNNB1
 2036  GTF2H2;ERCC4;PCNA;RFC3;RFC4;NTHL1;RFC2;RPA3;ER...      CTNNB1

           Guide Direction
 0     CTNNB1_MP        Up
 1     CTNNB1_MP        Up
 2     CTNNB1_MP        Up
 3     CTNNB1_MP        Up
 4     CTNNB1_MP      Down
 ...         ...       ...
 2032  CTNNB1_MP      Down
 2033  CTNNB1_MP      Down
 2034  CTNNB1_MP      Down
 2035  CTNNB1_MP      Down
 2036  CTNNB1_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of lipid biosynthetic process (GO:0...  0.7729
 1     prerank  positive regulation of lipid biosynthetic proc...  0.7274
 2     prerank  regulation of interferon-gamma-mediated signal...  0.7344
 3     prerank  regulation of microtubule depolymerization (GO...  0.6702
 4     prerank  negative regulation of microtubule polymerizat...  0.5907
 ...       ...                                                ...     ...
 2032  prerank  mitochondrial cytochrome c oxidase assembly (G... -0.1315
 2033  prerank  regulation of cellular metabolic process (GO:0... -0.1201
 2034  prerank  regulation of G2/M transition of mitotic cell ... -0.1119
 2035  prerank                       rRNA processing (GO:0006364) -0.0983
 2036  prerank                rRNA metabolic process (GO:0016072) -0.0885

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.0591    0.0000    0.0207     0.0160    8/19   8.33%
 1     2.0062    0.0000    0.0236     0.0390   10/23   9.50%
 2     1.8416    0.0069    0.2716     0.4580    4/17  12.40%
 3     1.7351    0.0106    0.6858     0.8560    6/20   8.33%
 4     1.5906    0.0082    1.0000     0.9980    3/24   2.71%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2030    1.0000    1.0000     1.0000   19/19  86.88%
 2033 -0.1819    1.0000    1.0000     1.0000   13/37  35.47%
 2034 -0.1692    1.0000    1.0000     1.0000  22/136  27.07%
 2035 -0.1470    1.0000    1.0000     1.0000  28/165  29.73%
 2036 -0.1329    1.0000    1.0000     1.0000  22/150  29.63%

                                              Lead_genes Target_Gene  \
 0     SORBS1;APOE;PPARA;SIRT4;MLXIPL;FITM2;GPER1;MID...      CTNNB1
 1     SORBS1;SLC45A3;APOE;PPARA;SIRT4;MLXIPL;SLC27A1...      CTNNB1
 2                              NLRC5;PARP14;NR1H2;PARP9      CTNNB1
 3                TRIM54;TRPV4;MAP1A;TTBK2;MAP1S;MID1IP1      CTNNB1
 4                                    TRIM54;CLIP3;TTBK2      CTNNB1
 ...                                                 ...         ...
 2032  FASTKD3;COX19;OXA1L;COX16;COX18;COA5;SURF1;SMI...      CTNNB1
 2033  ACACB;SSH1;PDK3;MBOAT7;FASN;DKK1;GBA;VPS35;ARF...      CTNNB1
 2034  HAUS7;PINX1;NINL;CEP76;CEP72;PSME4;CEP152;CEP2...      CTNNB1
 2035  DDX47;NOL8;EMG1;TFB1M;RPF1;NAT10;HEATR1;MAK16;...      CTNNB1
 2036  XRN1;DDX47;NOL8;EMG1;RPF1;HEATR1;EXOSC9;DEDD2;...      CTNNB1

           Guide Direction
 0     CTNNB1_AP        Up
 1     CTNNB1_AP        Up
 2     CTNNB1_AP        Up
 3     CTNNB1_AP        Up
 4     CTNNB1_AP        Up
 ...         ...       ...
 2032  CTNNB1_AP      Down
 2033  CTNNB1_AP      Down
 2034  CTNNB1_AP      Down
 2035  CTNNB1_AP      Down
 2036  CTNNB1_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                cell junction assembly (GO:0034329)  0.5628
 1     prerank  antigen processing and presentation of peptide...  0.6495
 2     prerank  regulation of cardiac muscle cell contraction ... -0.9317
 3     prerank  regulation of heart rate by cardiac conduction... -0.9605
 4     prerank  regulation of cation transmembrane transport (... -0.9530
 ...       ...                                                ...     ...
 2032  prerank                   ribosome biogenesis (GO:0042254) -0.1389
 2033  prerank   mitochondrial membrane organization (GO:0007006) -0.1308
 2034  prerank  double-strand break repair via homologous reco... -0.1342
 2035  prerank    ribosomal small subunit biogenesis (GO:0042274) -0.1281
 2036  prerank         DNA-dependent DNA replication (GO:0006261) -0.1206

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8716    0.0000    0.5781     0.3660   18/61  13.14%
 1     1.8205    0.0000    0.5870     0.5940    8/28   9.80%
 2    -1.7068    0.0167    0.2249     0.1960    3/19   1.63%
 3    -1.7037    0.0016    0.1364     0.2350    3/17   0.66%
 4    -1.7021    0.0016    0.1015     0.2580    4/17   1.63%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2315    1.0000    1.0000     1.0000  12/181  13.34%
 2033 -0.2269    1.0000    1.0000     1.0000   27/27  86.96%
 2034 -0.2244    1.0000    1.0000     1.0000    5/84  10.95%
 2035 -0.2173    1.0000    1.0000     1.0000    8/36  28.91%
 2036 -0.2026    1.0000    1.0000     1.0000   2/122   5.18%

                                              Lead_genes Target_Gene  \
 0     CDH7;FBLIM1;CDHR3;TRPV4;PKP1;PCDHB3;FSCN1;PCDH...     SMARCA4
 1        HLA-G;HFE;HLA-F;ERAP1;SEC24C;IFI30;TAP1;SEC24A     SMARCA4
 2                                  SCN5A;CACNA1C;RANGRF     SMARCA4
 3                                   KCNH2;SCN5A;CACNA1C     SMARCA4
 4                              KCNH2;SCN5A;KCNN2;RANGRF     SMARCA4
 ...                                                 ...         ...
 2032  ZNF658;NOC4L;HEATR3;EMG1;WDR36;DHX37;WDR18;HEA...     SMARCA4
 2033  MFN2;CHCHD6;TIMM50;SAMM50;SPG7;SLC25A4;DNAJC11...     SMARCA4
 2034                      MCMDC2;SPIDR;HUS1;NABP1;MUS81     SMARCA4
 2035    EMG1;RRP36;NOP14;DDX52;RPS27L;WDR3;SRFBP1;RIOK3     SMARCA4
 2036                                       PSMB9;MCMDC2     SMARCA4

            Guide Direction
 0     SMARCA4_MP        Up
 1     SMARCA4_MP        Up
 2     SMARCA4_MP      Down
 3     SMARCA4_MP      Down
 4     SMARCA4_MP      Down
 ...          ...       ...
 2032  SMARCA4_MP      Down
 2033  SMARCA4_MP      Down
 2034  SMARCA4_MP      Down
 2035  SMARCA4_MP      Down
 2036  SMARCA4_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank        respiratory system development (GO:0060541) -0.9470
 1     prerank               gene silencing by miRNA (GO:0035195)  0.6392
 2     prerank   positive regulation of phagocytosis (GO:0050766) -0.9547
 3     prerank     blood vessel diameter maintenance (GO:0097746) -0.9596
 4     prerank  positive regulation of leukocyte mediated cyto... -0.9471
 ...       ...                                                ...     ...
 2032  prerank        cellular response to radiation (GO:0071478) -0.1346
 2033  prerank  cellular response to ionizing radiation (GO:00... -0.1389
 2034  prerank  regulation of translational initiation (GO:000... -0.1385
 2035  prerank  regulation of erythrocyte differentiation (GO:... -0.1313
 2036  prerank                      ncRNA processing (GO:0034470) -0.1315

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0    -1.8342    0.0070    0.0316     0.0310    1/15   0.03%
 1     1.7941    0.0056    1.0000     0.7190   13/31  22.39%
 2    -1.7818    0.0000    0.3342     0.4770    3/21   0.81%
 3    -1.7793    0.0000    0.2550     0.5240    2/16   0.57%
 4    -1.7597    0.0052    0.4383     0.8100    3/16   1.39%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2525    1.0000    1.0000     1.0000   29/29  86.58%
 2033 -0.2517    1.0000    1.0000     1.0000   11/43  27.42%
 2034 -0.2485    1.0000    1.0000     1.0000   59/59  86.23%
 2035 -0.2454    1.0000    1.0000     1.0000    2/30  11.69%
 2036 -0.2405    1.0000    0.9999     1.0000  73/185  39.06%

                                              Lead_genes Target_Gene  \
 0                                                CCDC40     SMARCA4
 1     TRIM71;WTIP;AGO4;AGO1;NOTCH4;CNOT8;TNRC6C;AGO2...     SMARCA4
 2                                      FCGR2B;CYBA;IL15     SMARCA4
 3                                          AGTR1;BDKRB2     SMARCA4
 4                                   HLA-DRA;CD160;IL23A     SMARCA4
 ...                                                 ...         ...
 2032  GADD45A;INTS7;RAD9A;RHOB;RAD9B;BLM;INO80;RAD51...     SMARCA4
 2033  TMEM109;GADD45A;INTS7;RAD9A;RHOB;RAD9B;KDM1A;B...     SMARCA4
 2034  KLHL25;ATF4;CTIF;NCK1;EIF5;ALKBH1;NCBP2;IMPACT...     SMARCA4
 2035                                         ZNF16;MED1     SMARCA4
 2036  TUT1;FARS2;UTP15;WDR36;PELP1;WDR18;NVL;WDR75;E...     SMARCA4

            Guide Direction
 0     SMARCA4_AP      Down
 1     SMARCA4_AP        Up
 2     SMARCA4_AP      Down
 3     SMARCA4_AP      Down
 4     SMARCA4_AP      Down
 ...          ...       ...
 2032  SMARCA4_AP      Down
 2033  SMARCA4_AP      Down
 2034  SMARCA4_AP      Down
 2035  SMARCA4_AP      Down
 2036  SMARCA4_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank       long-chain fatty acid transport (GO:0015909)  0.7335
 1     prerank  negative regulation of neuron differentiation ...  0.7754
 2     prerank  positive regulation of monooxygenase activity ...  0.7452
 3     prerank           striated muscle contraction (GO:0006941)  0.7659
 4     prerank  regulation of neuronal synaptic plasticity (GO...  0.7285
 ...       ...                                                ...     ...
 2032  prerank           nuclear membrane reassembly (GO:0031468) -0.1282
 2033  prerank      aerobic electron transport chain (GO:0019646) -0.1254
 2034  prerank  establishment of protein localization to mitoc... -0.1269
 2035  prerank  mitochondrial ATP synthesis coupled electron t... -0.1203
 2036  prerank  positive regulation of nucleocytoplasmic trans... -0.1216

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.8774    0.0030    0.4493     0.3070   7/22   5.41%
 1     1.8626    0.0026    0.2803     0.3600   6/15   8.02%
 2     1.8331    0.0027    0.2810     0.4870   2/18   0.69%
 3     1.8299    0.0000    0.2227     0.5020   7/15   9.74%
 4     1.8292    0.0054    0.1802     0.5080  10/18  12.79%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2020    1.0000    1.0000     1.0000  17/54  36.36%
 2033 -0.2014    1.0000    1.0000     1.0000   1/64   3.91%
 2034 -0.1996    1.0000    1.0000     1.0000  19/45  40.63%
 2035 -0.1933    1.0000    1.0000     1.0000   1/65   3.91%
 2036 -0.1930    1.0000    1.0000     1.0000   4/40  17.66%

                                              Lead_genes Target_Gene    Guide  \
 0         CPT1B;APOE;SLC27A1;PRKAA2;SLC27A6;FABP5;ABCD4        CHD4  CHD4_MP
 1                        DLX2;SOX2;BMP7;ASCL1;SOX3;DLX1        CHD4  CHD4_MP
 2                                             APOE;TERT        CHD4  CHD4_MP
 3         TNNT1;STAC3;KCNH2;SCN5A;SCN1B;CCDC78;ARHGEF11        CHD4  CHD4_MP
 4     APOE;DRD2;CAMK2B;RAB3A;SYP;DBN1;PPFIA3;ARC;ZDH...        CHD4  CHD4_MP
 ...                                                 ...         ...      ...
 2032  CHMP4A;NUP188;NUP107;NUP85;SPAST;NDC1;NUP35;RC...        CHD4  CHD4_MP
 2033                                             NDUFA9        CHD4  CHD4_MP
 2034  TIMM10B;TIMM23B;GRPEL2;PAM16;TIMM50;TIMM9;TIMM...        CHD4  CHD4_MP
 2035                                             NDUFA9        CHD4  CHD4_MP
 2036                              NEDD4;NRDE2;IPO5;GAS6        CHD4  CHD4_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of protein localization to membrane...  0.6879
 1     prerank    outflow tract septum morphogenesis (GO:0003148)  0.7410
 2     prerank  positive regulation of interleukin-8 productio...  0.6223
 3     prerank  positive regulation of ATP metabolic process (...  0.6943
 4     prerank                    lipid modification (GO:0030258)  0.7437
 ...       ...                                                ...     ...
 2032  prerank  negative regulation of cysteine-type endopepti... -0.1353
 2033  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1266
 2034  prerank  regulation of hematopoietic progenitor cell di... -0.1267
 2035  prerank            regulation of RNA splicing (GO:0043484) -0.1215
 2036  prerank                       gene expression (GO:0010467) -0.1039

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8554    0.0000    0.9595     0.5040    9/24  15.04%
 1     1.8352    0.0000    0.6200     0.6030    8/18  13.37%
 2     1.8077    0.0031    0.5869     0.7300    9/32   8.02%
 3     1.7987    0.0058    0.4893     0.7600    7/20   8.78%
 4     1.7929    0.0000    0.4217     0.7750    4/16   6.55%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2291    1.0000    1.0000     1.0000    3/41  15.10%
 2033 -0.2200    1.0000    1.0000     1.0000  12/121  21.61%
 2034 -0.2141    1.0000    1.0000     1.0000   10/63  27.84%
 2035 -0.2063    1.0000    1.0000     1.0000   26/67  40.48%
 2036 -0.1795    1.0000    1.0000     1.0000  32/324  20.67%

                                              Lead_genes Target_Gene    Guide  \
 0      GPC3;FYN;GPC2;SLC5A3;CRIPT;GBP1;STX8;ZDHHC2;CDK5        CHD4  CHD4_AP
 1         NRP2;TGFB2;LRP2;NRP1;SMAD6;FGFR2;TGFBR2;SMAD4        CHD4  CHD4_AP
 2        CD74;DDX58;F3;AFAP1L2;TLR5;CD14;TLR2;CD58;NOD1        CHD4  CHD4_AP
 3       PPARGC1A;MLXIPL;PFKFB2;PINK1;NUPR1;PRKAA2;BEND3        CHD4  CHD4_AP
 4                                CYP3A5;DGKG;PORCN;DGKD        CHD4  CHD4_AP
 ...                                                 ...         ...      ...
 2032                                   PAX2;CD44;CDKN2D        CHD4  CHD4_AP
 2033  CLP1;SNUPN;PRPF18;EIF2D;GEMIN5;WDR77;CPSF7;PRM...        CHD4  CHD4_AP
 2034  LDB1;METTL14;PSMD5;MYB;PSME4;PSMC2;PSMD9;PSME3...        CHD4  CHD4_AP
 2035  RBM12;KHDRBS3;MBNL3;CLK1;PTBP3;POLR2A;RBM23;FA...        CHD4  CHD4_AP
 2036  CLP1;POLR3A;THRB;SARNP;CREBL2;SORL1;SCX;MEF2A;...        CHD4  CHD4_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  cellular response to glucose stimulus (GO:0071...  0.7102
 1     prerank  defense response to Gram-positive bacterium (G...  0.6845
 2     prerank                    retina homeostasis (GO:0001895)  0.7063
 3     prerank  negative regulation of lymphocyte proliferatio...  0.6889
 4     prerank  regulation of interleukin-10 production (GO:00...  0.6390
 ...       ...                                                ...     ...
 2032  prerank  regulation of cell cycle phase transition (GO:... -0.1339
 2033  prerank          regulation of mRNA stability (GO:0043488) -0.1130
 2034  prerank                rRNA metabolic process (GO:0016072) -0.0889
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0866
 2036  prerank                       rRNA processing (GO:0006364) -0.0857

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8418    0.0000    0.6523     0.4240     5/21   2.72%
 1     1.6854    0.0172    1.0000     0.9680     3/16   2.18%
 2     1.6841    0.0129    1.0000     0.9710     4/15   3.57%
 3     1.6826    0.0127    1.0000     0.9750     3/16   1.76%
 4     1.6454    0.0028    1.0000     0.9960     4/22   1.71%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2143    1.0000    1.0000     1.0000    25/85  31.01%
 2033 -0.1819    1.0000    1.0000     1.0000   43/128  34.47%
 2034 -0.1449    1.0000    1.0000     1.0000  150/150  91.23%
 2035 -0.1412    1.0000    1.0000     1.0000    1/160   2.39%
 2036 -0.1397    1.0000    1.0000     1.0000   29/165  29.95%

                                              Lead_genes Target_Gene     Guide  \
 0                    MLXIPL;PRKAA2;PAX2;RAB11FIP5;GPER1       GPBP1  GPBP1_MP
 1                                         LYZ;CAMP;TLR2       GPBP1  GPBP1_MP
 2                                  LYZ;POTEF;POTEI;PRR4       GPBP1  GPBP1_MP
 3                                    FOXP3;FCGR2B;HLA-G       GPBP1  GPBP1_MP
 4                               FOXP3;FCGR2B;JAK3;PIBF1       GPBP1  GPBP1_MP
 ...                                                 ...         ...       ...
 2032  ATP2B4;ANAPC10;CDC23;GTSE1;PSMD13;FBXO5;PSMB10...       GPBP1  GPBP1_MP
 2033  PCBP4;FASTKD3;IGF2BP2;METTL16;DIS3;YTHDF3;PSMD...       GPBP1  GPBP1_MP
 2034  FCF1;DIS3L;UTP3;RRP12;DIS3;UTP14A;WDR75;LAS1L;...       GPBP1  GPBP1_MP
 2035                                              DCP1B       GPBP1  GPBP1_MP
 2036  MAK16;FCF1;UTP3;RRP12;DIS3;UTP14A;WDR75;LAS1L;...       GPBP1  GPBP1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of defense response to vir...  0.7806
 1     prerank             cellular response to heat (GO:0034605)  0.6056
 2     prerank  regulation of defense response to virus by hos...  0.6211
 3     prerank  positive regulation of cation transmembrane tr... -0.9509
 4     prerank  positive regulation of potassium ion transmemb... -0.9414
 ...       ...                                                ...     ...
 2032  prerank  anaphase-promoting complex-dependent catabolic... -0.1079
 2033  prerank  regulation of hematopoietic stem cell differen... -0.1043
 2034  prerank  RNA splicing, via transesterification reaction... -0.1038
 2035  prerank  regulation of hematopoietic progenitor cell di... -0.0991
 2036  prerank  regulation of stem cell differentiation (GO:20... -0.0949

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9496    0.0000    0.1561     0.1170    5/17   3.41%
 1     1.6985    0.0000    1.0000     0.9620    4/31   7.43%
 2     1.6425    0.0034    1.0000     0.9930    6/23   3.41%
 3    -1.6155    0.0048    0.7395     0.4940    3/15   1.23%
 4    -1.6096    0.0060    0.4981     0.5960    3/19   1.23%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1697    1.0000    1.0000     1.0000   17/77  33.44%
 2033 -0.1651    1.0000    1.0000     1.0000    1/60   4.60%
 2034 -0.1650    1.0000    1.0000     1.0000  55/239  31.64%
 2035 -0.1562    1.0000    1.0000     1.0000   15/63  33.12%
 2036 -0.1495    1.0000    1.0000     1.0000   71/71  90.57%

                                              Lead_genes Target_Gene     Guide  \
 0                      TRIM6;DDX58;ZDHHC11;ZDHHC1;PARP9       GPBP1  GPBP1_AP
 1                                ANO1;HSPA6;HMOX1;TRPV4       GPBP1  GPBP1_AP
 2              TRIM6;DDX58;ZDHHC11;ZDHHC1;TNFAIP3;PARP9       GPBP1  GPBP1_AP
 3                                    KCNH2;KCNN2;GABBR2       GPBP1  GPBP1_AP
 4                                    KCNH2;KCNN2;GABBR2       GPBP1  GPBP1_AP
 ...                                                 ...         ...       ...
 2032  PSMB9;CDC16;FBXO5;FZR1;ANAPC4;UBE2E1;ANAPC10;C...       GPBP1  GPBP1_AP
 2033                                              PSMB9       GPBP1  GPBP1_AP
 2034  USP49;CLP1;RBM4B;HNRNPH2;CPSF4;DHX8;PRPF3;SUGP...       GPBP1  GPBP1_AP
 2035  PSMB9;METTL14;MYB;PUS7;RUNX1;YAP1;PSME4;PSMB2;...       GPBP1  GPBP1_AP
 2036  PSMB9;SMYD5;MYB;BMPR1A;NELFB;PUS7;RUNX1;YAP1;P...       GPBP1  GPBP1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3         Down
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank         response to hydrogen peroxide (GO:0042542)  0.6586
 1     prerank  positive regulation of production of molecular...  0.7297
 2     prerank  calcium ion transmembrane import into cytosol ...  0.7734
 3     prerank  cell morphogenesis involved in neuron differen...  0.5932
 4     prerank   regulation of cartilage development (GO:0061035)  0.7454
 ...       ...                                                ...     ...
 2032  prerank          regulation of mRNA stability (GO:0043488) -0.1296
 2033  prerank  regulation of stem cell differentiation (GO:20... -0.1112
 2034  prerank                      ncRNA processing (GO:0034470) -0.1065
 2035  prerank                     ribosome assembly (GO:0042255) -0.1123
 2036  prerank  regulation of cellular response to heat (GO:19... -0.1012

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8876    0.0000    0.4258     0.2810    5/39   4.49%
 1     1.7998    0.0000    0.8618     0.6930    5/18   7.18%
 2     1.7939    0.0022    0.6230     0.7200    6/15   8.34%
 3     1.7863    0.0000    0.5173     0.7610   13/44  11.07%
 4     1.7851    0.0021    0.4205     0.7660   12/16  21.48%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2316    1.0000    1.0000     1.0000   4/128   6.75%
 2033 -0.1924    1.0000    1.0000     1.0000   71/71  88.95%
 2034 -0.1921    1.0000    1.0000     1.0000  15/185  16.87%
 2035 -0.1887    1.0000    1.0000     1.0000   43/43  88.82%
 2036 -0.1767    1.0000    1.0000     1.0000    2/73   6.75%

                                              Lead_genes Target_Gene    Guide  \
 0                             ANXA1;HBA1;PAX2;FYN;MAPK7        SLTM  SLTM_MP
 1                        TRIM6;CLCF1;DNAJB9;FFAR2;F2RL1        SLTM  SLTM_MP
 2                  GRIN2C;CCR7;DRD2;GRIN1;PLCG2;SLC24A1        SLTM  SLTM_MP
 3     PAX2;SPTBN4;DRD2;ISL2;LLGL1;NTNG1;ZDHHC17;RAB3...        SLTM  SLTM_MP
 4     PTHLH;WNT11;SCX;BMP1;BMPR1B;BMPR2;BMP2;SOX6;KA...        SLTM  SLTM_MP
 ...                                                 ...         ...      ...
 2032                         TNFSF13;PSMB9;PCBP4;NUP214        SLTM  SLTM_MP
 2033  PSMB9;LMO1;NOTCH1;SMYD5;PSMD9;PSMD13;PSMD14;PS...        SLTM  SLTM_MP
 2034  NOL6;AGO4;DGCR8;WDR75;WDR12;FCF1;DDX47;POP1;IN...        SLTM  SLTM_MP
 2035  PPAN;BRIX1;DDX3X;MRPS11;DHX37;RRS1;RPSA;MRPS2;...        SLTM  SLTM_MP
 2036                                      HSPA1L;NUP214        SLTM  SLTM_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of wound healing (GO:0090303)  0.6520
 1     prerank  positive regulation of organelle organization ...  0.6225
 2     prerank  positive regulation of peptidyl-lysine acetyla...  0.6509
 3     prerank    alpha-amino acid catabolic process (GO:1901606)  0.6645
 4     prerank     regulation of filopodium assembly (GO:0051489)  0.5728
 ...       ...                                                ...     ...
 2032  prerank                mRNA 3&#39;-end processing (GO:0031124) -0.1445
 2033  prerank  negative regulation of G2/M transition of mito... -0.1401
 2034  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1318
 2035  prerank  anaphase-promoting complex-dependent catabolic... -0.1290
 2036  prerank               RNA export from nucleus (GO:0006405) -0.1254

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.8403    0.0000    0.9873     0.4750   4/25   2.00%
 1     1.7628    0.0095    1.0000     0.7480   3/23   5.06%
 2     1.6874    0.0125    1.0000     0.9190   3/18   0.47%
 3     1.6715    0.0162    1.0000     0.9440   3/16   1.24%
 4     1.6365    0.0000    1.0000     0.9800   8/27  17.66%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2126    1.0000    1.0000     1.0000  11/75  25.07%
 2033 -0.2052    1.0000    1.0000     1.0000   1/56   4.92%
 2034 -0.1965    1.0000    1.0000     1.0000  15/52  37.96%
 2035 -0.1880    1.0000    1.0000     1.0000  21/77  42.09%
 2036 -0.1827    1.0000    1.0000     1.0000  18/97  27.91%

                                              Lead_genes Target_Gene    Guide  \
 0                              ANXA1;ADRA2A;HPSE;FERMT1        SLTM  SLTM_AP
 1                                  PPARGC1A;ANXA1;STX18        SLTM  SLTM_AP
 2                                 PPARGC1A;PRKAA2;FOXP3        SLTM  SLTM_AP
 3                                      IL4I1;HAAO;PRODH        SLTM  SLTM_AP
 4       CCR7;ARHGAP44;PALM;SRGAP2C;RHOQ;DMTN;PRKCD;RALA        SLTM  SLTM_AP
 ...                                                 ...         ...      ...
 2032  MTPAP;CSTF2;THOC5;THOC1;SRSF6;SARNP;CPSF2;ZNF4...        SLTM  SLTM_AP
 2033                                              PSMB9        SLTM  SLTM_AP
 2034  NVL;MALSU1;RPF1;HEATR3;MAK16;MDN1;BRIX1;PES1;S...        SLTM  SLTM_AP
 2035  PSMB9;ANAPC2;ANAPC1;PSMC2;CDC23;UBE2E1;CDC26;P...        SLTM  SLTM_AP
 2036  THOC5;NUP188;THOC1;NUP210;NUP214;MCM3AP;NUP133...        SLTM  SLTM_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                   response to peptide (GO:1901652)  0.7631
 1     prerank  negative regulation of amyloid precursor prote...  0.7768
 2     prerank           regulation of wound healing (GO:0061041)  0.6595
 3     prerank  positive regulation of wound healing (GO:0090303)  0.6498
 4     prerank                       ion homeostasis (GO:0050801)  0.6842
 ...       ...                                                ...     ...
 2032  prerank            autophagosome organization (GO:1905037) -0.1431
 2033  prerank  termination of RNA polymerase I transcription ... -0.1375
 2034  prerank                recombinational repair (GO:0000725) -0.1303
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1272
 2036  prerank                     ribosome assembly (GO:0042255) -0.1255

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9564    0.0000    0.2811     0.1490    8/19  10.38%
 1     1.9079    0.0000    0.2671     0.2600    9/15  18.15%
 2     1.7908    0.0041    0.7893     0.7250    7/27   7.31%
 3     1.7840    0.0080    0.6357     0.7520    5/25   2.39%
 4     1.7817    0.0086    0.5220     0.7590    7/16  12.26%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2208    1.0000    1.0000     1.0000    7/45  25.04%
 2033 -0.2146    1.0000    1.0000     1.0000   14/26  40.74%
 2034 -0.2026    1.0000    1.0000     1.0000   12/68  23.97%
 2035 -0.1980    1.0000    1.0000     1.0000  13/160  20.41%
 2036 -0.1929    1.0000    1.0000     1.0000    2/43  10.93%

                                              Lead_genes Target_Gene     Guide  \
 0            STAT5A;ANXA1;FYN;IRF5;STAT4;KAT7;MMP9;PRNP       DHX30  DHX30_MP
 1     APOE;SORL1;NTRK2;ABCA7;BIN1;PRNP;PICALM;FLOT2;...       DHX30  DHX30_MP
 2           ANXA1;HBEGF;VIL1;CLDN1;TNFAIP3;CADM4;ADRA2A       DHX30  DHX30_MP
 3                         ANXA1;HBEGF;HPSE;CLDN1;FERMT1       DHX30  DHX30_MP
 4     SLC4A5;RANGRF;SLC30A3;SLC30A4;SLC4A10;CAMK2D;S...       DHX30  DHX30_MP
 ...                                                 ...         ...       ...
 2032           ATG14;ULK2;ATG9A;ATG13;STX12;ATG2A;ATG12       DHX30  DHX30_MP
 2033  POLR1E;TTF1;POLR1B;GTF2H2;TAF1B;CDK7;TBP;POLR2...       DHX30  DHX30_MP
 2034  WRN;XRCC3;MCM8;RPA2;LIG3;SAMHD1;RAD51D;ERCC4;Z...       DHX30  DHX30_MP
 2035  TUT1;AGO1;MTPAP;SAMD4B;PELO;CNOT10;SAMD4A;PATL...       DHX30  DHX30_MP
 2036                                        NLE1;MTERF3       DHX30  DHX30_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of biosynthetic process (G...  0.7782
 1     prerank  regulation of lipid biosynthetic process (GO:0...  0.7642
 2     prerank           camera-type eye development (GO:0043010)  0.7736
 3     prerank  positive regulation of peptide hormone secreti...  0.7022
 4     prerank  positive regulation of cellular component move... -0.9452
 ...       ...                                                ...     ...
 2032  prerank         DNA-dependent DNA replication (GO:0006261) -0.1267
 2033  prerank  regulation of cell cycle phase transition (GO:... -0.1234
 2034  prerank                       rRNA processing (GO:0006364) -0.1190
 2035  prerank  regulation of stem cell differentiation (GO:20... -0.1178
 2036  prerank                mRNA 3&#39;-end processing (GO:0031124) -0.1043

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     2.1038    0.0000    0.0111     0.0070     8/25   6.03%
 1     1.9530    0.0000    0.0954     0.1200     6/19   4.75%
 2     1.8253    0.0000    0.4528     0.5760     4/16   3.13%
 3     1.7620    0.0056    0.7447     0.8410     8/17  11.98%
 4    -1.7149    0.0131    0.1859     0.1690     2/15   0.48%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2188    1.0000    1.0000     1.0000   43/122  38.57%
 2033 -0.2102    1.0000    1.0000     1.0000    20/85  31.22%
 2034 -0.2012    1.0000    1.0000     1.0000  164/165  86.60%
 2035 -0.2003    1.0000    1.0000     1.0000    17/71  31.22%
 2036 -0.1771    1.0000    1.0000     1.0000    13/75  27.29%

                                              Lead_genes Target_Gene     Guide  \
 0      SORBS1;GRIN1;MLXIPL;CYBA;SIRT4;APOE;PPARA;SLC5A3       DHX30  DHX30_AP
 1                  SORBS1;MLXIPL;SIRT4;APOE;GPER1;PPARA       DHX30  DHX30_AP
 2                            CACNA1C;PAX2;ALDH1A3;TENM3       DHX30  DHX30_AP
 3          ACSL4;HFE;GPER1;CAPN10;LRRC8A;IRS2;DRD2;SOX4       DHX30  DHX30_AP
 4                                              CCR7;LYN       DHX30  DHX30_AP
 ...                                                 ...         ...       ...
 2032  PSMB9;MCM8;PRIMPOL;MGME1;RPA1;CDC7;POLD3;PSMD5...       DHX30  DHX30_AP
 2033  PSMB9;NEK11;FBXO5;ATP2B4;CDC26;TFAP4;PSMD5;PSM...       DHX30  DHX30_AP
 2034  SENP3;HELQ;NAT10;UTP15;MDN1;RCL1;BMS1;TEX10;WD...       DHX30  DHX30_AP
 2035  PSMB9;JAG1;PSMD5;SETD1A;EIF2AK2;PSMB10;ABL1;NO...       DHX30  DHX30_AP
 2036  DDX39B;CPSF4;MTPAP;POLDIP3;U2AF1;ZC3H11A;CSTF1...       DHX30  DHX30_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                granulocyte chemotaxis (GO:0071621)  0.8649
 1     prerank                 neutrophil chemotaxis (GO:0030593)  0.8099
 2     prerank                  neutrophil migration (GO:1990266)  0.7934
 3     prerank  positive regulation of lymphocyte proliferatio...  0.6911
 4     prerank                      skin development (GO:0043588)  0.6247
 ...       ...                                                ...     ...
 2032  prerank  regulation of transcription from RNA polymeras... -0.1330
 2033  prerank                   mitotic cytokinesis (GO:0000281) -0.1324
 2034  prerank              mitotic nuclear division (GO:0140014) -0.1076
 2035  prerank                       gene expression (GO:0010467) -0.1010
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0777

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.1910    0.0000    0.0036     0.0010    7/18   1.89%
 1     2.0344    0.0000    0.0334     0.0490   10/17  13.97%
 2     2.0009    0.0000    0.0366     0.0810   10/18  13.97%
 3     1.9362    0.0000    0.0848     0.2100    7/28   8.44%
 4     1.9188    0.0049    0.0848     0.2550    9/47   4.60%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2235    1.0000    1.0000     1.0000    3/65  11.11%
 2033 -0.2194    1.0000    1.0000     1.0000   11/45  33.47%
 2034 -0.1823    1.0000    1.0000     1.0000    8/66  23.15%
 2035 -0.1697    1.0000    1.0000     1.0000  69/324  33.45%
 2036 -0.1313    1.0000    1.0000     1.0000  19/160  27.07%

                                              Lead_genes Target_Gene  \
 0            ANXA1;S100A8;TGFB2;S100A9;CXADR;ITGB2;EDN1      ZNF217
 1     S100A8;TGFB2;S100A9;CXADR;ITGB2;EDN1;PIKFYVE;P...      ZNF217
 2     S100A8;TGFB2;S100A9;CXADR;ITGB2;EDN1;PIKFYVE;P...      ZNF217
 3                 ANXA1;IL15;CD74;JAK3;IL23A;CD274;VAV3      ZNF217
 4     ANXA1;COL3A1;KRT16;COL5A2;CDSN;ABCA12;CLDN1;TP...      ZNF217
 ...                                                 ...         ...
 2032                                  EGLN2;SIRT2;STOX1      ZNF217
 2033  TRIM36;STAMBP;BBS4;MITD1;SON;ECT2;KIF20A;KIF23...      ZNF217
 2034   PIBF1;AAAS;SPICE1;NCAPG2;CHMP7;CTDP1;NDC80;MIS12      ZNF217
 2035  NKX2-8;THRB;NUP43;IGHMBP2;FASTKD2;CPSF1;SYMPK;...      ZNF217
 2036  CNOT6L;PARN;PDE12;ERI1;SMG6;DHX34;PAN2;SMG9;SA...      ZNF217

           Guide Direction
 0     ZNF217_MP        Up
 1     ZNF217_MP        Up
 2     ZNF217_MP        Up
 3     ZNF217_MP        Up
 4     ZNF217_MP        Up
 ...         ...       ...
 2032  ZNF217_MP      Down
 2033  ZNF217_MP      Down
 2034  ZNF217_MP      Down
 2035  ZNF217_MP      Down
 2036  ZNF217_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of amyloid precursor prote...  0.7370
 1     prerank                        axon extension (GO:0048675)  0.6985
 2     prerank           neuron projection extension (GO:1990138)  0.6469
 3     prerank  negative regulation of proteolysis involved in...  0.6363
 4     prerank            cell junction organization (GO:0034330)  0.5430
 ...       ...                                                ...     ...
 2032  prerank            nucleotide-excision repair (GO:0006289) -0.1269
 2033  prerank     positive regulation of exocytosis (GO:0045921) -0.1248
 2034  prerank                       rRNA processing (GO:0006364) -0.1155
 2035  prerank  regulation of stem cell differentiation (GO:20... -0.1188
 2036  prerank               mitochondrial transport (GO:0006839) -0.0872

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8263    0.0024    0.9331     0.5170     7/18  13.08%
 1     1.7362    0.0166    1.0000     0.8850     4/17   6.69%
 2     1.6785    0.0185    1.0000     0.9790     5/23   6.69%
 3     1.6768    0.0199    1.0000     0.9790     8/22  14.22%
 4     1.6764    0.0080    1.0000     0.9790    17/54  18.01%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2144    1.0000    1.0000     1.0000   28/101  32.27%
 2033 -0.2144    1.0000    1.0000     1.0000    10/29  32.90%
 2034 -0.1984    1.0000    1.0000     1.0000  157/165  74.31%
 2035 -0.1926    1.0000    1.0000     1.0000    19/71  33.56%
 2036 -0.1428    1.0000    1.0000     1.0000    16/51  37.02%

                                              Lead_genes Target_Gene  \
 0               LYN;EFNA3;EPHA4;AGER;SLC2A13;GSAP;EFNA1      ZNF217
 1                               NRP2;AUTS2;SLC9A6;MAP1B      ZNF217
 2                         NRP2;AUTS2;SLC9A6;FLRT3;MAP1B      ZNF217
 3        QRICH2;HFE;EPHA4;TRIM39;OPHN1;ALAD;EFNA1;HIPK2      ZNF217
 4     FBLIM1;SNCB;CXADR;SEMA3E;CLDN1;TGFB2;PPFIBP1;P...      ZNF217
 ...                                                 ...         ...
 2032  POLL;LIG4;CCNH;CUL4A;POLA1;MMS19;ERCC5;ISY1;XR...      ZNF217
 2033  CADPS;STXBP5;RAB3D;SDCBP;STAM;CLASP1;VPS4B;PDC...      ZNF217
 2034  NOL9;WDR43;EXOSC9;UTP14A;RRP12;WDR75;RPF1;DDX4...      ZNF217
 2035  NOTCH1;PUS7;RBM24;ITCH;NELFB;MYB;EIF2AK2;PRKDC...      ZNF217
 2036  FLVCR1;TIMM10B;PPIF;SLC25A13;SLC25A4;MFF;MFN2;...      ZNF217

           Guide Direction
 0     ZNF217_AP        Up
 1     ZNF217_AP        Up
 2     ZNF217_AP        Up
 3     ZNF217_AP        Up
 4     ZNF217_AP        Up
 ...         ...       ...
 2032  ZNF217_AP      Down
 2033  ZNF217_AP      Down
 2034  ZNF217_AP      Down
 2035  ZNF217_AP      Down
 2036  ZNF217_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of microtubule polymerizat...  0.6769
 1     prerank          keratinocyte differentiation (GO:0030216)  0.6813
 2     prerank                granulocyte chemotaxis (GO:0071621)  0.6849
 3     prerank        epidermal cell differentiation (GO:0009913)  0.5972
 4     prerank                    zinc ion transport (GO:0006829) -0.9212
 ...       ...                                                ...     ...
 2032  prerank  regulation of translational initiation (GO:000... -0.1348
 2033  prerank                recombinational repair (GO:0000725) -0.1331
 2034  prerank           spliceosomal snRNP assembly (GO:0000387) -0.1245
 2035  prerank           nucleocytoplasmic transport (GO:0006913) -0.1210
 2036  prerank                           translation (GO:0006412) -0.0914

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.8544    0.0000    0.8513     0.4960   7/24  11.06%
 1     1.7537    0.0085    1.0000     0.8840   3/20   4.73%
 2     1.7177    0.0126    1.0000     0.9570   2/18   2.31%
 3     1.6879    0.0193    1.0000     0.9830   3/29   4.73%
 4    -1.6783    0.0332    1.0000     0.6850   1/15   0.07%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2293    1.0000    1.0000     1.0000  11/59  30.85%
 2033 -0.2213    1.0000    1.0000     1.0000  29/68  38.82%
 2034 -0.2103    1.0000    1.0000     1.0000  15/37  39.15%
 2035 -0.2028    1.0000    1.0000     1.0000  16/38  39.15%
 2036 -0.1556    1.0000    1.0000     1.0000  9/187  15.29%

                                              Lead_genes Target_Gene    Guide  \
 0          CLIP3;TRIM54;FGF13;MAP2;ARHGEF2;TAOK1;KATNB1        SAFB  SAFB_MP
 1                                       ANXA1;CDSN;OPN3        SAFB  SAFB_MP
 2                                           ANXA1;CXADR        SAFB  SAFB_MP
 3                                       ANXA1;CDSN;OPN3        SAFB  SAFB_MP
 4                                               SLC30A4        SAFB  SAFB_MP
 ...                                                 ...         ...      ...
 2032  KLHL25;RBM4;NCK2;IMPACT;EIF4EBP2;DNAJC3;EIF1B;...        SAFB  SAFB_MP
 2033  RECQL5;XRCC1;RMI1;RAD51AP1;ZSWIM7;SLX4;MCM8;RA...        SAFB  SAFB_MP
 2034  SNUPN;TGS1;DDX20;SNRPC;PRPF31;AAR2;SNRPD1;SRSF...        SAFB  SAFB_MP
 2035  SNUPN;RITA1;DDX20;HTATIP2;AAAS;MALT1;RSRC1;RBM...        SAFB  SAFB_MP
 2036  GTPBP2;EEF2K;MRPS28;IGHMBP2;EEF1G;MRPL16;NOA1;...        SAFB  SAFB_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  nucleobase-containing compound biosynthetic pr...  0.7051
 1     prerank              receptor internalization (GO:0031623)  0.6488
 2     prerank  positive regulation of G1/S transition of mito...  0.6752
 3     prerank   cellular response to light stimulus (GO:0071482)  0.5703
 4     prerank  positive regulation of cholesterol efflux (GO:...  0.6868
 ...       ...                                                ...     ...
 2032  prerank             ncRNA export from nucleus (GO:0097064) -0.1291
 2033  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1223
 2034  prerank  regulation of G2/M transition of mitotic cell ... -0.1208
 2035  prerank              mRNA export from nucleus (GO:0006406) -0.1206
 2036  prerank  RNA splicing, via transesterification reaction... -0.0794

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8338    0.0000    0.7021     0.3660    3/18   2.58%
 1     1.7752    0.0000    0.8065     0.6480    7/30   9.63%
 2     1.7451    0.0033    0.7941     0.7720    3/21   5.54%
 3     1.7225    0.0000    0.7876     0.8500    8/48  10.72%
 4     1.6507    0.0165    1.0000     0.9710    8/15  12.53%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1856    1.0000    1.0000     1.0000   36/36  87.14%
 2033 -0.1788    1.0000    1.0000     1.0000  26/160  27.34%
 2034 -0.1780    1.0000    1.0000     1.0000  30/136  28.13%
 2035 -0.1779    1.0000    1.0000     1.0000   23/99  26.97%
 2036 -0.1161    1.0000    1.0000     1.0000  54/239  29.73%

                                              Lead_genes Target_Gene    Guide  \
 0                                         CDA;TERT;ADAL        SAFB  SAFB_AP
 1                     SAG;DNM1;MX1;CAV1;GRK4;ITGB2;LRP1        SAFB  SAFB_AP
 2                                      ANXA1;LSM11;MTBP        SAFB  SAFB_AP
 3      SAG;BMF;MAPK13;TMEM161A;PDE6A;BAK1;EIF2AK4;INO80        SAFB  SAFB_AP
 4         APOE;ZDHHC8;CAV1;ABCA7;SIRT1;LRP1;EEPD1;NR1H3        SAFB  SAFB_AP
 ...                                                 ...         ...      ...
 2032  NOL6;POM121;NUP107;PHAX;NUP205;NUP160;NUP133;N...        SAFB  SAFB_AP
 2033  CTIF;CNOT6L;DCP1A;SMG6;TUT1;MTPAP;XRN1;SAMD4B;...        SAFB  SAFB_AP
 2034  NEK2;HAUS6;CDC25C;CENPF;CENPJ;CEP192;CEP70;CEP...        SAFB  SAFB_AP
 2035  THOC1;SARNP;HHEX;U2AF1;SMG6;SLU7;DHX38;CPSF3;P...        SAFB  SAFB_AP
 2036  GPKOW;CWF19L2;SNRNP48;U2AF1;RBM5;FRG1;CWF19L1;...        SAFB  SAFB_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank     sphingolipid biosynthetic process (GO:0030148)  0.5877
 1     prerank  glucose catabolic process to pyruvate (GO:0061...  0.6480
 2     prerank                  canonical glycolysis (GO:0061621)  0.6480
 3     prerank  regulation of epithelial cell migration (GO:00...  0.5462
 4     prerank           mitotic cytokinetic process (GO:1902410)  0.6001
 ...       ...                                                ...     ...
 2032  prerank    positive regulation of translation (GO:0045727) -0.1378
 2033  prerank    protein insertion into ER membrane (GO:0045048) -0.1361
 2034  prerank     transcription by RNA polymerase I (GO:0006360) -0.1357
 2035  prerank  mitotic nuclear membrane organization (GO:0101... -0.1239
 2036  prerank   mitotic nuclear membrane reassembly (GO:0007084) -0.1239

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.9655    0.0000    0.1145     0.0610  17/51  12.01%
 1     1.6684    0.0120    1.0000     0.9400   4/18  11.39%
 2     1.6684    0.0120    1.0000     0.9400   4/18  11.39%
 3     1.6256    0.0256    1.0000     0.9840  15/41  22.15%
 4     1.6227    0.0211    1.0000     0.9860  13/19  28.09%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.1932    1.0000    1.0000     1.0000  13/82  25.80%
 2033 -0.1889    1.0000    1.0000     1.0000  33/33  86.43%
 2034 -0.1886    1.0000    1.0000     1.0000   7/30  28.60%
 2035 -0.1750    1.0000    1.0000     1.0000   8/51  22.39%
 2036 -0.1750    1.0000    1.0000     1.0000   8/51  22.39%

                                              Lead_genes Target_Gene    Guide  \
 0     B4GALT6;ACER2;CYP4F22;PRKD1;ALDH3B1;SGPP1;SPNS...        EEF2  EEF2_MP
 1                                     ENO3;HK2;HK1;PFKM        EEF2  EEF2_MP
 2                                     ENO3;HK2;HK1;PFKM        EEF2  EEF2_MP
 3     VIL1;GLIPR2;SASH1;MCC;DAB2IP;CTSH;MARVELD3;TGF...        EEF2  EEF2_MP
 4     CNTROB;CHMP6;CHMP7;CHMP4A;CHMP2A;KIF20A;CHMP1A...        EEF2  EEF2_MP
 ...                                                 ...         ...      ...
 2032  PASK;MPV17L2;SAMD4A;EEF2;CPEB3;NSUN5;NAT10;EIF...        EEF2  EEF2_MP
 2033  EMC9;VAMP2;ALDH3A2;WDR83OS;UBE2J2;TRAM1;UBL4A;...        EEF2  EEF2_MP
 2034        GTF2H1;TAF1A;TTF1;POLR1A;CCNH;GTF2H2;POLR2F        EEF2  EEF2_MP
 2035   NUP160;NUP43;NDC1;NUP133;CC2D1B;NUP85;REEP3;VRK1        EEF2  EEF2_MP
 2036   NUP160;NUP43;NDC1;NUP133;CC2D1B;NUP85;REEP3;VRK1        EEF2  EEF2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  activation of protein kinase B activity (GO:00...  0.7451
 1     prerank                 bicarbonate transport (GO:0015701) -0.9322
 2     prerank  positive regulation of lipid biosynthetic proc...  0.6828
 3     prerank                    lipid modification (GO:0030258) -0.9246
 4     prerank  defense response to Gram-positive bacterium (G... -0.9417
 ...       ...                                                ...     ...
 2032  prerank    ribosomal small subunit biogenesis (GO:0042274) -0.1284
 2033  prerank                       mRNA processing (GO:0006397) -0.1219
 2034  prerank  mitochondrial ATP synthesis coupled electron t... -0.1232
 2035  prerank      aerobic electron transport chain (GO:0019646) -0.1215
 2036  prerank           nuclear membrane reassembly (GO:0031468) -0.1217

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8286    0.0023    1.0000     0.5650    3/20   1.99%
 1    -1.7697    0.0281    1.0000     0.9290    3/15   2.60%
 2     1.7651    0.0024    1.0000     0.8360    4/23   2.28%
 3    -1.7575    0.0217    1.0000     0.9770    2/16   0.90%
 4    -1.7523    0.0125    1.0000     0.9840    2/16   0.50%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2323    1.0000    1.0000     1.0000    3/36  15.97%
 2033 -0.2278    1.0000    1.0000     1.0000  14/284  11.90%
 2034 -0.2229    1.0000    1.0000     1.0000   64/65  80.65%
 2035 -0.2200    1.0000    1.0000     1.0000   63/64  80.65%
 2036 -0.2188    1.0000    1.0000     1.0000    8/54  21.56%

                                              Lead_genes Target_Gene    Guide  \
 0                                  CCDC88A;ADRA2A;NTRK3        EEF2  EEF2_AP
 1                                    SLC4A5;HBA1;CYB5RL        EEF2  EEF2_AP
 2                            MLXIPL;SORBS1;SLC45A3;APOE        EEF2  EEF2_AP
 3                                           CYP3A5;DGKG        EEF2  EEF2_AP
 4                                              CHGA;LYZ        EEF2  EEF2_AP
 ...                                                 ...         ...      ...
 2032                                 LTV1;METTL17;DDX52        EEF2  EEF2_AP
 2033  NOVA1;U2AF1;DBR1;CACTIN;SNRNP48;RBM5;U2AF1L4;U...        EEF2  EEF2_AP
 2034  NDUFAF1;NDUFC2;COX10;UQCRHL;NDUFB5;SDHD;UQCRC1...        EEF2  EEF2_AP
 2035  NDUFAF1;NDUFC2;COX10;UQCRHL;NDUFB5;SDHD;UQCRC1...        EEF2  EEF2_AP
 2036  AHCTF1;VPS4A;NUP43;PPP2CA;NDC1;NUP107;NUP160;N...        EEF2  EEF2_AP

      Direction
 0           Up
 1         Down
 2           Up
 3         Down
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of response to wounding (G...  0.7354
 1     prerank               nucleosome organization (GO:0034728)  0.5337
 2     prerank                 mitochondrial fission (GO:0000266)  0.6648
 3     prerank                histone H3 acetylation (GO:0043966)  0.5640
 4     prerank                     organelle fission (GO:0048285)  0.6257
 ...       ...                                                ...     ...
 2032  prerank  nuclear-transcribed mRNA catabolic process, ex... -0.1323
 2033  prerank  regulation of cellular amine metabolic process... -0.1325
 2034  prerank  anaphase-promoting complex-dependent catabolic... -0.1297
 2035  prerank  positive regulation of DNA biosynthetic proces... -0.1286
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0834

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.7855    0.0045    1.0000     0.6960   4/17   5.83%
 1     1.6591    0.0081    1.0000     0.9890   3/52   2.14%
 2     1.6232    0.0223    1.0000     0.9950   4/16  14.71%
 3     1.6211    0.0137    1.0000     0.9960  17/38  17.77%
 4     1.6150    0.0214    1.0000     0.9960   6/22  14.71%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2114    1.0000    1.0000     1.0000   7/35  22.96%
 2033 -0.2098    1.0000    1.0000     1.0000  22/45  39.54%
 2034 -0.2094    1.0000    1.0000     1.0000  21/77  27.49%
 2035 -0.2034    1.0000    1.0000     1.0000  10/54  23.20%
 2036 -0.1373    1.0000    1.0000     1.0000  6/160  12.69%

                                              Lead_genes Target_Gene  \
 0                              ANXA1;ADRA2A;HBEGF;PRKCE      NFE2L2
 1                                    PADI4;BRDT;SMARCD3      NFE2L2
 2                                  MX2;MTFR2;MX1;MTFR1L      NFE2L2
 3     LEF1;TAF5;BRD1;ING4;JADE1;PER1;KAT7;KAT6A;TAF6...      NFE2L2
 4                     MX2;PEX19;MTFR2;MX1;PEX11A;MTFR1L      NFE2L2
 ...                                                 ...         ...
 2032           DCP1B;DCP1A;EXOSC4;LSM3;LSM5;EXOSC1;LSM4      NFE2L2
 2033  NQO1;PSMD9;PSMD13;PSMD14;PSMC4;PSMD3;PSMD11;PS...      NFE2L2
 2034  ANAPC4;ANAPC15;ANAPC10;PSMD9;CDC16;PLK1;UBE2E1...      NFE2L2
 2035  GREM1;FBXO4;TNKS;KLF4;PKIB;PDGFB;FGFR4;RFC3;PA...      NFE2L2
 2036                  TUT1;HELZ2;DCP1B;XRN1;DCP1A;MTPAP      NFE2L2

           Guide Direction
 0     NFE2L2_MP        Up
 1     NFE2L2_MP        Up
 2     NFE2L2_MP        Up
 3     NFE2L2_MP        Up
 4     NFE2L2_MP        Up
 ...         ...       ...
 2032  NFE2L2_MP      Down
 2033  NFE2L2_MP      Down
 2034  NFE2L2_MP      Down
 2035  NFE2L2_MP      Down
 2036  NFE2L2_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of synaptic transmission (...  0.7676
 1     prerank  positive regulation of Ras protein signal tran...  0.6522
 2     prerank               protein destabilization (GO:0031648)  0.6158
 3     prerank       long-chain fatty acid transport (GO:0015909)  0.6210
 4     prerank  interleukin-12-mediated signaling pathway (GO:...  0.5379
 ...       ...                                                ...     ...
 2032  prerank   NADH dehydrogenase complex assembly (GO:0010257) -0.1457
 2033  prerank  positive regulation of cellular amide metaboli... -0.1408
 2034  prerank  anaphase-promoting complex-dependent catabolic... -0.1386
 2035  prerank                     ribosome assembly (GO:0042255) -0.1343
 2036  prerank  negative regulation of mitotic cell cycle phas... -0.1276

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.9034    0.0037    0.5166     0.2600   5/16   5.38%
 1     1.8521    0.0059    0.4799     0.4340   6/30   5.00%
 2     1.7162    0.0169    1.0000     0.8900   7/27   8.53%
 3     1.6969    0.0128    1.0000     0.9410   4/22   2.98%
 4     1.6356    0.0213    1.0000     0.9920   1/35   0.01%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2162    1.0000    1.0000     1.0000  15/53  39.26%
 2033 -0.2095    1.0000    1.0000     1.0000  11/67  23.93%
 2034 -0.2064    1.0000    1.0000     1.0000  20/77  36.52%
 2035 -0.1985    1.0000    1.0000     1.0000  43/43  86.63%
 2036 -0.1876    1.0000    1.0000     1.0000  22/74  37.71%

                                              Lead_genes Target_Gene  \
 0                       DRD2;PRRT1;SLC30A1;GRIK3;TMEM25      NFE2L2
 1                LYN;COL3A1;RASGRF1;RTN4R;F2RL1;ARHGEF3      NFE2L2
 2              TRIM21;CCDC88C;NR1D1;MUL1;KDM8;GGA3;PEX2      NFE2L2
 3                               APOE;CPT1B;PRKAA2;FABP5      NFE2L2
 4                                                 STAT4      NFE2L2
 ...                                                 ...         ...
 2032  TIMM21;NUBPL;NDUFA13;NDUFS4;NDUFAF5;NDUFA9;NDU...      NFE2L2
 2033  EPHA4;PLD1;PLA2G6;SPHK2;ROCK2;PASK;CPEB3;TNFRS...      NFE2L2
 2034  ANAPC4;CDC16;CDC23;FBXO5;PSME4;PSMA6;CDK1;MAD2...      NFE2L2
 2035  MPV17L2;MTERF3;MDN1;RPF2;EIF6;DHX37;MRPS11;BOP...      NFE2L2
 2036  RBL1;PINX1;CDKN2A;FBXO5;USP47;PSME4;PSMA6;KANK...      NFE2L2

           Guide Direction
 0     NFE2L2_AP        Up
 1     NFE2L2_AP        Up
 2     NFE2L2_AP        Up
 3     NFE2L2_AP        Up
 4     NFE2L2_AP        Up
 ...         ...       ...
 2032  NFE2L2_AP      Down
 2033  NFE2L2_AP      Down
 2034  NFE2L2_AP      Down
 2035  NFE2L2_AP      Down
 2036  NFE2L2_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of protein localization to...  0.6536
 1     prerank  positive regulation of protein localization to...  0.5645
 2     prerank  nucleobase-containing compound biosynthetic pr...  0.7195
 3     prerank           neuron projection extension (GO:1990138)  0.6796
 4     prerank  positive regulation of protein localization to...  0.6148
 ...       ...                                                ...     ...
 2032  prerank  establishment of mitotic spindle localization ... -0.1430
 2033  prerank  mitotic sister chromatid segregation (GO:0000070) -0.1388
 2034  prerank  positive regulation of ubiquitin-protein trans... -0.1313
 2035  prerank                 DNA metabolic process (GO:0006259) -0.1241
 2036  prerank                     ribosome assembly (GO:0042255) -0.1116

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8871    0.0000    0.3125     0.1840   10/42   8.64%
 1     1.8534    0.0000    0.2699     0.2910   16/82  11.83%
 2     1.7820    0.0095    0.5279     0.6270    3/18   4.26%
 3     1.7696    0.0000    0.4754     0.6960    5/23   5.30%
 4     1.7534    0.0034    0.4665     0.7680    9/41   8.64%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2253    1.0000    1.0000     1.0000   26/26  85.74%
 2033 -0.2225    1.0000    1.0000     1.0000   32/91  31.52%
 2034 -0.2052    1.0000    1.0000     1.0000    2/29  10.26%
 2035 -0.2028    1.0000    1.0000     1.0000  15/251  13.03%
 2036 -0.1765    1.0000    1.0000     1.0000   43/43  88.89%

                                              Lead_genes Target_Gene    Guide  \
 0     SORBS1;RANGRF;CLIP3;EFCAB7;EPHA3;PRKCH;LRP1;PR...        CHD8  CHD8_MP
 1     SORBS1;RANGRF;CLIP3;FYN;EFCAB7;ITGB2;EPHA3;PRK...        CHD8  CHD8_MP
 2                                          CDA;TERT;ADA        CHD8  CHD8_MP
 3                         SLC9A6;NRP2;FLRT3;MAP1B;ALCAM        CHD8  CHD8_MP
 4     SORBS1;RANGRF;CLIP3;EPHA3;PRKCH;LRP1;PRKCE;PTP...        CHD8  CHD8_MP
 ...                                                 ...         ...      ...
 2032  CLASP2;NDE1;MISP;NDC80;CENPA;MAD2L1;FBXW11;ZW1...        CHD8  CHD8_MP
 2033  CHMP4A;KIF18B;CHMP1B;PHF8;TUBG1;WRAP73;PINX1;C...        CHD8  CHD8_MP
 2034                                        BTRC;CDC14B        CHD8  CHD8_MP
 2035  GTF2H4;RAD9B;DNASE1L2;POT1;TOP3B;PRIMPOL;RECQL...        CHD8  CHD8_MP
 2036  DHX37;RPF2;EIF2A;RPS27L;DHX29;PPAN;RRS1;MRPS7;...        CHD8  CHD8_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank             peptide catabolic process (GO:0043171)  0.7677
 1     prerank  production of small RNA involved in gene silen...  0.6901
 2     prerank  cellular response to amino acid stimulus (GO:0...  0.5989
 3     prerank         glutathione metabolic process (GO:0006749)  0.6011
 4     prerank  positive regulation of cellular component move...  0.6564
 ...       ...                                                ...     ...
 2032  prerank                      ncRNA processing (GO:0034470) -0.1424
 2033  prerank          protein-DNA complex assembly (GO:0065004) -0.1415
 2034  prerank  regulation of cellular response to stress (GO:... -0.1403
 2035  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1346
 2036  prerank                 RNA 3&#39;-end processing (GO:0031123) -0.1326

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8896    0.0000    0.5207     0.3330    5/15   5.59%
 1     1.7375    0.0000    1.0000     0.9180    2/19   0.60%
 2     1.6674    0.0156    1.0000     0.9930   10/26  13.94%
 3     1.6465    0.0208    1.0000     0.9950    8/24  18.02%
 4     1.6371    0.0288    1.0000     0.9970    6/15  16.87%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2259    1.0000    1.0000     1.0000  37/185  30.63%
 2033 -0.2222    1.0000    1.0000     1.0000   2/108   4.49%
 2034 -0.2214    1.0000    1.0000     1.0000  13/104  22.07%
 2035 -0.2136    1.0000    1.0000     1.0000  25/121  32.75%
 2036 -0.2106    1.0000    1.0000     1.0000   18/62  33.84%

                                              Lead_genes Target_Gene    Guide  \
 0                       ADAMTS13;CHAC1;ERAP1;ENPEP;GGT7        CHD8  CHD8_AP
 1                                           TRIM71;TERT        CHD8  CHD8_AP
 2     SESN3;CPEB3;RRAGB;SESN1;RPTOR;SLC38A9;CPEB4;NS...        CHD8  CHD8_AP
 3           CHAC1;OPLAH;GGT7;MGST2;MMACHC;GCLC;GCLM;GSR        CHD8  CHD8_AP
 4                  TWIST1;LYN;NTN1;ADAM17;TRIM32;TGFBR1        CHD8  CHD8_AP
 ...                                                 ...         ...      ...
 2032  INTS9;SMAD1;SMAD3;SENP3;EMG1;TARBP2;HEATR1;FAR...        CHD8  CHD8_AP
 2033                                        DMC1;NAP1L2        CHD8  CHD8_AP
 2034  ARNTL;NUAK1;CCAR2;MBTPS2;CHORDC1;AAAS;CASP9;AI...        CHD8  CHD8_AP
 2035  SRSF6;SNUPN;PPAN;TARBP2;EIF2D;SMN1;GEMIN8;PRMT...        CHD8  CHD8_AP
 2036  U2AF1;SLU7;SRSF6;CSTF2;RPRD1A;THOC5;CSTF3;SYMP...        CHD8  CHD8_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of response to biotic stim...  0.7336
 1     prerank  negative regulation of signal transduction by ... -0.9534
 2     prerank  positive regulation of cholesterol transport (... -0.9367
 3     prerank  positive regulation of cholesterol efflux (GO:... -0.9451
 4     prerank            regulation of phagocytosis (GO:0050764)  0.6906
 ...       ...                                                ...     ...
 2032  prerank                   ribosome biogenesis (GO:0042254) -0.1097
 2033  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1088
 2034  prerank               mitochondrial transport (GO:0006839) -0.1142
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1070
 2036  prerank                       rRNA processing (GO:0006364) -0.0901

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9442    0.0000    0.1692     0.1240    4/24   2.95%
 1    -1.8809    0.0017    0.0287     0.0300    3/15   1.06%
 2    -1.8660    0.0036    0.0420     0.0820    2/18   0.59%
 3    -1.8289    0.0019    0.2348     0.4920    2/15   0.59%
 4     1.8079    0.0024    0.7244     0.6540    3/23   1.88%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2096    1.0000    1.0000     1.0000  38/181  28.41%
 2033 -0.2089    1.0000    1.0000     1.0000  42/260  22.91%
 2034 -0.2041    1.0000    1.0000     1.0000    5/51  14.55%
 2035 -0.2004    1.0000    1.0000     1.0000  22/160  25.34%
 2036 -0.1712    1.0000    1.0000     1.0000  29/165  26.92%

                                              Lead_genes Target_Gene     Guide  \
 0                                   OASL;DDX60;CYBA;NMI       SIN3A  SIN3A_MP
 1                                     SNAI2;CD74;TWIST1       SIN3A  SIN3A_MP
 2                                            EEPD1;APOE       SIN3A  SIN3A_MP
 3                                            EEPD1;APOE       SIN3A  SIN3A_MP
 4                                        IL15;CYBA;TLR2       SIN3A  SIN3A_MP
 ...                                                 ...         ...       ...
 2032  DDX52;URB2;SENP3;UTP14A;HEATR1;PELP1;RIOK1;BMS...       SIN3A  SIN3A_MP
 2033  DHX35;NOVA1;CWC25;WDR83;TRA2A;SNIP1;CWC27;CHER...       SIN3A  SIN3A_MP
 2034                    SLC25A16;MTX2;BAK1;SLC25A4;MFN2       SIN3A  SIN3A_MP
 2035  CNOT1;DCP1B;XRN1;MTPAP;CNOT3;PARN;SMG1;CASC3;U...       SIN3A  SIN3A_MP
 2036  DDX52;SENP3;UTP14A;HEATR1;PELP1;RIOK1;BMS1;BOP...       SIN3A  SIN3A_MP

      Direction
 0           Up
 1         Down
 2         Down
 3         Down
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of organelle organization ...  0.6942
 1     prerank             cellular response to heat (GO:0034605)  0.6232
 2     prerank  negative regulation of endothelial cell prolif... -0.9648
 3     prerank                     blood circulation (GO:0008015) -0.9431
 4     prerank                 DNA strand elongation (GO:0022616)  0.6804
 ...       ...                                                ...     ...
 2032  prerank  nuclear-transcribed mRNA catabolic process, ex... -0.1211
 2033  prerank          regulation of mRNA stability (GO:0043488) -0.1173
 2034  prerank                   protein methylation (GO:0006479) -0.1130
 2035  prerank             mitochondrial translation (GO:0032543) -0.1090
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0984

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7952    0.0028    1.0000     0.6730    9/23  17.33%
 1     1.7626    0.0000    1.0000     0.8000    3/31   3.01%
 2    -1.7137    0.0000    0.2305     0.2150    6/17   2.42%
 3    -1.6901    0.0081    0.4107     0.5780    5/18   3.28%
 4     1.6862    0.0077    1.0000     0.9740    2/17   1.70%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2163    1.0000    1.0000     1.0000    9/35  31.31%
 2033 -0.2009    1.0000    1.0000     1.0000  41/128  34.90%
 2034 -0.1933    1.0000    1.0000     1.0000    8/29  31.67%
 2035 -0.1852    1.0000    1.0000     1.0000  36/102  37.24%
 2036 -0.1691    1.0000    1.0000     1.0000  21/160  27.56%

                                              Lead_genes Target_Gene     Guide  \
 0     PPARGC1A;ANXA1;C2CD5;STX18;FYCO1;KATNBL1;HTRA2...       SIN3A  SIN3A_AP
 1                                      ANO1;HSPA6;HMOX1       SIN3A  SIN3A_AP
 2                      COL4A3;FLT1;SULF1;APOE;DLL4;NGFR       SIN3A  SIN3A_AP
 3                       COL4A3;BDKRB2;DLL4;AGTR1;CXCL12       SIN3A  SIN3A_AP
 4                                           TERT;MCMDC2       SIN3A  SIN3A_AP
 ...                                                 ...         ...       ...
 2032  PATL1;EXOSC9;TTC37;DCP1A;CNOT6;DIS3;EXOSC5;SKI...       SIN3A  SIN3A_AP
 2033  FASTKD3;IGF2BP2;PDE12;FTO;XRN1;YTHDF2;METTL14;...       SIN3A  SIN3A_AP
 2034  METTL22;PRMT3;VCPKMT;N6AMT1;ICMT;LCMT1;SNRPB;E...       SIN3A  SIN3A_AP
 2035  GFM2;EARS2;MRPL47;MRPL30;MTRF1;MRPS31;GATC;MRP...       SIN3A  SIN3A_AP
 2036  PATL1;PAN2;MTPAP;PDE12;ZC3H12A;XRN1;CNOT10;UPF...       SIN3A  SIN3A_AP

      Direction
 0           Up
 1           Up
 2         Down
 3         Down
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  organonitrogen compound catabolic process (GO:...  0.5594
 1     prerank    positive regulation of DNA binding (GO:0043388)  0.6932
 2     prerank  nucleic acid-templated transcription (GO:0097659)  0.5557
 3     prerank  positive regulation of epidermal cell differen...  0.6965
 4     prerank  regulation of toll-like receptor 4 signaling p...  0.6931
 ...       ...                                                ...     ...
 2032  prerank              translational elongation (GO:0006414) -0.1346
 2033  prerank            DNA replication initiation (GO:0006270) -0.1300
 2034  prerank              mitotic nuclear division (GO:0140014) -0.1230
 2035  prerank            nucleotide-excision repair (GO:0006289) -0.1205
 2036  prerank         DNA-dependent DNA replication (GO:0006261) -0.1148

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8448    0.0000    0.8515     0.3860    14/41  14.92%
 1     1.8287    0.0054    0.5142     0.4350     5/21   9.53%
 2     1.7368    0.0220    0.9947     0.7950    15/40  27.52%
 3     1.7314    0.0083    0.7910     0.8140    10/15  27.10%
 4     1.7002    0.0143    0.8583     0.8920    10/15  19.39%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1926    1.0000    1.0000     1.0000   10/101  18.57%
 2033 -0.1840    1.0000    1.0000     1.0000     6/37  26.88%
 2034 -0.1767    1.0000    1.0000     1.0000     6/66  19.03%
 2035 -0.1717    1.0000    1.0000     1.0000   18/101  23.33%
 2036 -0.1622    1.0000    1.0000     1.0000  122/122  88.65%

                                              Lead_genes Target_Gene  \
 0     CTRL;CYP3A5;ADAMTS13;ENPEP;CTH;PNPLA8;IDE;IL4I...      HNRNPU
 1                         TRIM6;TRAF6;PLAUR;FOXC1;TGFB1      HNRNPU
 2     TERT;NKX2-8;NR4A2;SCX;BCL3;NFKBIB;POLR2C;XAB2;...      HNRNPU
 3     NME2;ETV4;FOXC1;IL20;BMP4;TRIM16;NUMA1;MED1;PR...      HNRNPU
 4     LYN;PTPN22;IFI35;F2RL1;APPL2;WDFY1;TIRAP;NR1H3...      HNRNPU
 ...                                                 ...         ...
 2032  GTPBP2;GFM1;MRPL44;MRPL32;MRPS30;MRPL12;MRPS9;...      HNRNPU
 2033                  PRIM2;POLA1;POLA2;LRWD1;DBF4;MCM6      HNRNPU
 2034              PIBF1;CTDP1;KLHL22;SPAST;CEP192;KIF3B      HNRNPU
 2035  ERCC6;POLA1;UVSSA;XRCC1;SLX4;COPS3;XPC;COPS4;Z...      HNRNPU
 2036  PRIM2;POLG;POLA1;PSMB9;POLG2;PSMD5;RAD51;POLA2...      HNRNPU

           Guide Direction
 0     HNRNPU_MP        Up
 1     HNRNPU_MP        Up
 2     HNRNPU_MP        Up
 3     HNRNPU_MP        Up
 4     HNRNPU_MP        Up
 ...         ...       ...
 2032  HNRNPU_MP      Down
 2033  HNRNPU_MP      Down
 2034  HNRNPU_MP      Down
 2035  HNRNPU_MP      Down
 2036  HNRNPU_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of ERBB signaling pathway ...  0.7094
 1     prerank   response to reactive oxygen species (GO:0000302)  0.5812
 2     prerank   regulation of macrophage activation (GO:0043030) -0.9269
 3     prerank               focal adhesion assembly (GO:0048041) -0.9220
 4     prerank  positive regulation of defense response to vir... -0.9413
 ...       ...                                                ...     ...
 2032  prerank               RNA export from nucleus (GO:0006405) -0.1371
 2033  prerank  positive regulation of filopodium assembly (GO... -0.1299
 2034  prerank                mRNA metabolic process (GO:0016071) -0.1328
 2035  prerank                        mRNA transport (GO:0051028) -0.1286
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1153

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8397    0.0029    1.0000     0.5700    6/20   8.78%
 1     1.7676    0.0000    1.0000     0.8540    7/44   6.14%
 2    -1.7032    0.0269    1.0000     0.6980    2/16   0.86%
 3    -1.6971    0.0152    0.9436     0.7890    1/16   0.71%
 4    -1.6971    0.0061    0.6304     0.7910    2/17   0.87%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2347    1.0000    1.0000     1.0000   18/97  25.45%
 2033 -0.2337    1.0000    1.0000     1.0000    6/16  38.82%
 2034 -0.2293    1.0000    1.0000     1.0000   14/85  29.25%
 2035 -0.2203    1.0000    1.0000     1.0000   17/98  25.45%
 2036 -0.2004    1.0000    1.0000     1.0000  36/121  35.73%

                                              Lead_genes Target_Gene  \
 0                 AFAP1L2;CCDC88A;GPER1;PLAUR;HIP1;DOK1      HNRNPU
 1                    HBA1;FYN;FER;HMOX1;EGFR;HYAL2;PKD2      HNRNPU
 2                                           FCGR2B;CD74      HNRNPU
 3                                                SORBS1      HNRNPU
 4                                         ZDHHC11;TRIM6      HNRNPU
 ...                                                 ...         ...
 2032  THOC1;POLDIP3;DDX39B;DDX19B;NUP188;THOC5;U2AF1...      HNRNPU
 2033                    TGFB3;CCR7;AGRN;FMR1;NRP1;CDC42      HNRNPU
 2034  AGO4;PRPF3;METTL16;PCBP3;METTL3;NUDT12;PRPF18;...      HNRNPU
 2035  THOC1;POLDIP3;DDX39B;DDX19B;NUP188;THOC5;U2AF1...      HNRNPU
 2036  DDX39B;MDN1;RSL24D1;SETX;NAF1;PPAN;NOP2;PRPF18...      HNRNPU

           Guide Direction
 0     HNRNPU_AP        Up
 1     HNRNPU_AP        Up
 2     HNRNPU_AP      Down
 3     HNRNPU_AP      Down
 4     HNRNPU_AP      Down
 ...         ...       ...
 2032  HNRNPU_AP      Down
 2033  HNRNPU_AP      Down
 2034  HNRNPU_AP      Down
 2035  HNRNPU_AP      Down
 2036  HNRNPU_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                       cell chemotaxis (GO:0060326)  0.5693
 1     prerank          keratinocyte differentiation (GO:0030216)  0.6262
 2     prerank  regulation of carbohydrate catabolic process (...  0.5302
 3     prerank                     response to lipid (GO:0033993)  0.4738
 4     prerank  negative regulation of epithelial cell migrati...  0.5863
 ...       ...                                                ...     ...
 2032  prerank  positive regulation of stress fiber assembly (... -0.1371
 2033  prerank  antigen processing and presentation of exogeno... -0.1367
 2034  prerank  regulation of transcription from RNA polymeras... -0.1296
 2035  prerank  regulation of cell cycle phase transition (GO:... -0.1243
 2036  prerank  interleukin-1-mediated signaling pathway (GO:0... -0.1166

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.7830    0.0000    1.0000     0.8690   9/31  14.52%
 1     1.7479    0.0108    1.0000     0.9480   7/20  11.42%
 2     1.7454    0.0000    1.0000     0.9520  20/39  24.13%
 3     1.7389    0.0000    1.0000     0.9590  21/69  15.73%
 4     1.7171    0.0137    1.0000     0.9820   8/24  16.10%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2422    1.0000    1.0000     1.0000   9/32  32.78%
 2033 -0.2376    1.0000    1.0000     1.0000  25/63  38.70%
 2034 -0.2259    1.0000    1.0000     1.0000  11/75  18.46%
 2035 -0.2186    1.0000    1.0000     1.0000  30/85  36.41%
 2036 -0.2080    1.0000    0.9999     1.0000  29/80  38.61%

                                              Lead_genes Target_Gene     Guide  \
 0     CCR10;CCR6;CCR7;BIN2;ELMO2;PIP5K1A;EPHA2;VEGFA...       PSMC5  PSMC5_MP
 1              ANXA1;CDSN;DSP;PIP5K1A;KRT16;EPHA2;CLIC4       PSMC5  PSMC5_MP
 2     OGT;POM121C;NUP153;RANBP2;NUP160;NUP54;NUP88;N...       PSMC5  PSMC5_MP
 3     ANXA1;PALM3;PTPN22;ACER2;AQP3;PPARA;ADAM17;TIR...       PSMC5  PSMC5_MP
 4     ADAMTS9;DUSP10;PTPRG;CORO1C;SP100;APOE;DAB2IP;...       PSMC5  PSMC5_MP
 ...                                                 ...         ...       ...
 2032  LIMK1;PPM1F;SORBS3;RHOC;WNT11;CD47;EPHA1;TGFB3...       PSMC5  PSMC5_MP
 2033  IFI30;PSMC5;PSMB9;PSMB10;PSMD9;HLA-B;PSMC1;PSM...       PSMC5  PSMC5_MP
 2034  EGLN2;PSMC5;PSMB9;PSMB10;ATF4;KLF2;MUC1;EGLN3;...       PSMC5  PSMC5_MP
 2035  ZNF16;PSMC5;PSMB9;PSMB10;TRIM39;ANAPC11;DBF4B;...       PSMC5  PSMC5_MP
 2036  NOD1;PSMC5;PSMB9;PSMB10;PSMD9;MAP3K8;PSMC1;PSM...       PSMC5  PSMC5_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of vascular endothelial gr...  0.7882
 1     prerank  regulation of vascular endothelial growth fact...  0.7882
 2     prerank  positive regulation of glucose transmembrane t...  0.7084
 3     prerank               focal adhesion assembly (GO:0048041)  0.7286
 4     prerank  negative regulation of protein secretion (GO:0...  0.6435
 ...       ...                                                ...     ...
 2032  prerank          regulation of mRNA stability (GO:0043488) -0.1416
 2033  prerank  nuclear-transcribed mRNA catabolic process, de... -0.1350
 2034  prerank  positive regulation of viral process (GO:0048524) -0.1292
 2035  prerank  negative regulation of cell cycle G2/M phase t... -0.1189
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0875

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8945    0.0000    0.1779     0.2330    4/15   6.23%
 1     1.8945    0.0000    0.1779     0.2330    4/15   6.23%
 2     1.8225    0.0000    0.3308     0.5030    4/21   5.19%
 3     1.7614    0.0024    0.5460     0.7580    5/16   6.28%
 4     1.7400    0.0000    0.5664     0.8440    6/23   6.00%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2277    1.0000    1.0000     1.0000   5/128   9.85%
 2033 -0.2180    1.0000    1.0000     1.0000   18/51  30.97%
 2034 -0.2008    1.0000    1.0000     1.0000   13/53  28.77%
 2035 -0.1910    1.0000    1.0000     1.0000   47/47  88.16%
 2036 -0.1405    1.0000    1.0000     1.0000  49/160  35.01%

                                              Lead_genes Target_Gene     Guide  \
 0                                  RORA;HPSE;EIF2AK3;C5       PSMC5  PSMC5_AP
 1                                  RORA;HPSE;EIF2AK3;C5       PSMC5  PSMC5_AP
 2                             SORBS1;CLIP3;C2CD5;CREBL2       PSMC5  PSMC5_AP
 3                       SORBS1;TESK2;FERMT2;WHAMM;TAOK2       PSMC5  PSMC5_AP
 4          RAB11FIP5;APOE;ADRA2A;BMP8A;RAB11FIP1;RHBDF1       PSMC5  PSMC5_AP
 ...                                                 ...         ...       ...
 2032                IGF2BP2;TNFSF13;SAMD4A;FASTKD3;PUM1       PSMC5  PSMC5_AP
 2033  SAMD4A;TNKS1BP1;PAN3;CNOT3;LSM6;CNOT1;CNOT11;E...       PSMC5  PSMC5_AP
 2034  IFIT1;CCNT1;TYRO3;RSF1;KPNA6;SRPK1;CDK9;PPIE;P...       PSMC5  PSMC5_AP
 2035  PINX1;PSMB4;USP47;PSMB5;PSMB10;PSMD9;PSMA4;PSM...       PSMC5  PSMC5_AP
 2036  SAMD4A;DHX34;TUT1;NBAS;TNKS1BP1;PAN3;HELZ2;CNO...       PSMC5  PSMC5_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank       long-chain fatty acid transport (GO:0015909)  0.7630
 1     prerank                    glycolytic process (GO:0006096)  0.7202
 2     prerank    fatty acid transmembrane transport (GO:1902001)  0.6964
 3     prerank  NLS-bearing protein import into nucleus (GO:00... -0.9715
 4     prerank            pyruvate metabolic process (GO:0006090)  0.5535
 ...       ...                                                ...     ...
 2032  prerank  mitochondrial respiratory chain complex I asse... -0.1197
 2033  prerank   NADH dehydrogenase complex assembly (GO:0010257) -0.1197
 2034  prerank  regulation of cell cycle phase transition (GO:... -0.1121
 2035  prerank         DNA-dependent DNA replication (GO:0006261) -0.1082
 2036  prerank           nucleocytoplasmic transport (GO:0006913) -0.1036

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.0168    0.0000    0.0421     0.0350    7/22   3.99%
 1     1.8178    0.0028    0.5632     0.5780    3/20   2.18%
 2     1.7078    0.0105    1.0000     0.9540    4/16   3.99%
 3    -1.7000    0.0000    0.0982     0.0940    3/15   0.73%
 4     1.6589    0.0206    1.0000     0.9960    5/38   5.12%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1990    1.0000    1.0000     1.0000    9/53  25.66%
 2033 -0.1990    1.0000    1.0000     1.0000    9/53  25.66%
 2034 -0.1884    1.0000    1.0000     1.0000   30/85  39.28%
 2035 -0.1847    1.0000    1.0000     1.0000  35/122  32.75%
 2036 -0.1754    1.0000    1.0000     1.0000    3/38  17.15%

                                              Lead_genes Target_Gene  \
 0         CPT1B;APOE;FABP5;SLC27A2;PRKAA2;SLC27A1;ABCD4      PRRC2C
 1                                       PGAM4;ENO3;ENO4      PRRC2C
 2                            CPT1B;PRKAA2;SLC27A1;ABCD4      PRRC2C
 3                                     RGPD8;RGPD2;RGPD5      PRRC2C
 4                          LDHC;PGAM4;ENO3;ENO4;SLC16A3      PRRC2C
 ...                                                 ...         ...
 2032  NDUFA9;OXA1L;NDUFAF5;TIMM21;NDUFAF4;NDUFAF1;ND...      PRRC2C
 2033  NDUFA9;OXA1L;NDUFAF5;TIMM21;NDUFAF4;NDUFAF1;ND...      PRRC2C
 2034  ATP2B4;UBE2E1;BUB1B;ANAPC4;BTRC;TRIM39;CDC23;P...      PRRC2C
 2035  ORC5;TEFM;HELB;POLG2;MGME1;REV3L;ORC3;RFC2;PSM...      PRRC2C
 2036                                   SNUPN;NXT2;RGS14      PRRC2C

           Guide Direction
 0     PRRC2C_MP        Up
 1     PRRC2C_MP        Up
 2     PRRC2C_MP        Up
 3     PRRC2C_MP      Down
 4     PRRC2C_MP        Up
 ...         ...       ...
 2032  PRRC2C_MP      Down
 2033  PRRC2C_MP      Down
 2034  PRRC2C_MP      Down
 2035  PRRC2C_MP      Down
 2036  PRRC2C_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank          cellular response to alcohol (GO:0097306)  0.6692
 1     prerank  interleukin-12-mediated signaling pathway (GO:...  0.6092
 2     prerank   cellular response to interleukin-12 (GO:0071349)  0.6028
 3     prerank                        axon extension (GO:0048675)  0.6932
 4     prerank  proteasomal ubiquitin-independent protein cata...  0.6816
 ...       ...                                                ...     ...
 2032  prerank  DNA-templated transcription, elongation (GO:00... -0.1219
 2033  prerank  nuclear-transcribed mRNA catabolic process, no... -0.1143
 2034  prerank                   ribosome biogenesis (GO:0042254) -0.1144
 2035  prerank  regulation of mitotic cell cycle phase transit... -0.1078
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.0997

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8407    0.0000    0.8206     0.4870     5/27   5.51%
 1     1.8110    0.0044    0.5964     0.6360     2/35   1.93%
 2     1.8024    0.0045    0.4368     0.6730     2/36   1.93%
 3     1.7315    0.0056    0.7319     0.9010     4/17  11.63%
 4     1.7124    0.0063    0.7062     0.9330     1/17   0.41%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1952    1.0000    1.0000     1.0000    19/65  34.33%
 2033 -0.1820    1.0000    1.0000     1.0000  110/110  88.68%
 2034 -0.1815    1.0000    1.0000     1.0000   13/181  15.85%
 2035 -0.1716    1.0000    1.0000     1.0000   35/174  29.39%
 2036 -0.1611    1.0000    1.0000     1.0000  119/121  84.17%

                                              Lead_genes Target_Gene  \
 0                      AKR1C2;PTGER2;PTCH1;ADCY7;MAP4K1      PRRC2C
 1                                            STAT4;MTAP      PRRC2C
 2                                            STAT4;MTAP      PRRC2C
 3                                 NRP2;SLIT2;ULK2;ALCAM      PRRC2C
 4                                                 PSMB9      PRRC2C
 ...                                                 ...         ...
 2032  GTF2H4;CDK7;POLR2C;ELP4;GTF2H1;LEO1;CDC73;POLR...      PRRC2C
 2033  SMG1;DCP1A;HELZ2;CTIF;SMG9;NCBP1;RPL27A;UPF3B;...      PRRC2C
 2034  ZNF658;EMG1;URB2;UTP15;DHX37;HEATR1;FCF1;DDX49...      PRRC2C
 2035  CDC14B;CNTRL;HAUS8;OFD1;ZW10;CEP70;NEK11;NEK6;...      PRRC2C
 2036  PPAN;GEMIN8;GEMIN5;SF3A2;CLP1;SART1;MCTS1;GEMI...      PRRC2C

           Guide Direction
 0     PRRC2C_AP        Up
 1     PRRC2C_AP        Up
 2     PRRC2C_AP        Up
 3     PRRC2C_AP        Up
 4     PRRC2C_AP        Up
 ...         ...       ...
 2032  PRRC2C_AP      Down
 2033  PRRC2C_AP      Down
 2034  PRRC2C_AP      Down
 2035  PRRC2C_AP      Down
 2036  PRRC2C_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of release of cytochrome c from mit...  0.6544
 1     prerank  positive regulation of release of cytochrome c...  0.7070
 2     prerank  negative regulation of endothelial cell prolif... -0.9459
 3     prerank  regulation of immune effector process (GO:0002...  0.6938
 4     prerank       cytosolic calcium ion transport (GO:0060401) -0.9323
 ...       ...                                                ...     ...
 2032  prerank  RNA splicing, via transesterification reaction... -0.1030
 2033  prerank                 RNA 3&#39;-end processing (GO:0031123) -0.1025
 2034  prerank                       gene expression (GO:0010467) -0.0964
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0870
 2036  prerank                mRNA 3&#39;-end processing (GO:0031124) -0.0863

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8237    0.0027    0.7460     0.4660     7/34  13.23%
 1     1.8213    0.0025    0.3870     0.4820     7/24  13.23%
 2    -1.7200    0.0055    0.2741     0.2200     5/17   2.44%
 3     1.7036    0.0201    1.0000     0.9610     6/16   9.75%
 4    -1.7016    0.0189    0.4137     0.5050     1/15   0.64%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1862    1.0000    1.0000     1.0000   40/239  25.62%
 2033 -0.1738    1.0000    1.0000     1.0000    15/62  30.28%
 2034 -0.1727    1.0000    1.0000     1.0000   33/324  21.95%
 2035 -0.1543    1.0000    1.0000     1.0000  157/160  82.95%
 2036 -0.1499    1.0000    1.0000     1.0000    19/75  30.28%

                                              Lead_genes Target_Gene    Guide  \
 0                BMF;HRK;TNFSF10;GPER1;MMP9;MOAP1;PINK1        NME2  NME2_MP
 1                BMF;HRK;TNFSF10;GPER1;MMP9;MOAP1;PINK1        NME2  NME2_MP
 2                             NGFR;ATOH8;APOE;FLT1;DLL4        NME2  NME2_MP
 3                  FCGR2B;HLA-DRA;C5AR1;HLA-DRB1;C1R;C5        NME2  NME2_MP
 4                                               CACNA1C        NME2  NME2_MP
 ...                                                 ...         ...      ...
 2032  NOVA1;ELAVL2;CSTF2T;ZCCHC8;RSRC1;USP49;GPKOW;S...        NME2  NME2_MP
 2033  CSTF2T;MTPAP;SARNP;SUPV3L1;CPSF2;CSTF1;CSTF2;S...        NME2  NME2_MP
 2034  NOVA1;ATXN1;SMG6;BICD1;TSPAN17;HARS2;NUP43;DED...        NME2  NME2_MP
 2035  DCP1A;SMG6;MTPAP;CTIF;CNOT6;XRN1;CNOT3;NBAS;UP...        NME2  NME2_MP
 2036  CSTF2T;MTPAP;SARNP;ZNF473;CPSF2;LSM11;CSTF1;CS...        NME2  NME2_MP

      Direction
 0           Up
 1           Up
 2         Down
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                actin filament capping (GO:0051693)  0.7421
 1     prerank     barbed-end actin filament capping (GO:0051016)  0.7421
 2     prerank   semaphorin-plexin signaling pathway (GO:0071526)  0.6160
 3     prerank  regulation of vascular endothelial growth fact...  0.6614
 4     prerank  endoplasmic reticulum calcium ion homeostasis ...  0.6154
 ...       ...                                                ...     ...
 2032  prerank          mitotic spindle organization (GO:0007052) -0.1356
 2033  prerank  positive regulation of cellular protein metabo... -0.1303
 2034  prerank  microtubule cytoskeleton organization involved... -0.1304
 2035  prerank  regulation of cellular response to heat (GO:19... -0.1106
 2036  prerank            nucleotide-excision repair (GO:0006289) -0.1058

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7598    0.0000    1.0000     0.7700    4/15   7.80%
 1     1.7598    0.0000    1.0000     0.7700    4/15   7.80%
 2     1.6798    0.0148    1.0000     0.9610    9/26   7.22%
 3     1.5901    0.0422    1.0000     0.9990    8/15  17.14%
 4     1.5587    0.0245    1.0000     1.0000    3/18   6.22%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1997    1.0000    1.0000     1.0000  20/141  22.54%
 2033 -0.1958    1.0000    1.0000     1.0000    6/87  14.40%
 2034 -0.1930    1.0000    1.0000     1.0000  27/116  29.28%
 2035 -0.1620    1.0000    1.0000     1.0000   19/73  34.43%
 2036 -0.1575    1.0000    1.0000     1.0000  31/101  36.21%

                                              Lead_genes Target_Gene    Guide  \
 0                                 ADD3;VIL1;CAPG;TRIOBP        NME2  NME2_AP
 1                                 ADD3;VIL1;CAPG;TRIOBP        NME2  NME2_AP
 2     NRP2;SEMA6A;SEMA4G;PLXNB1;SEMA6B;SEMA4F;SEMA3E...        NME2  NME2_AP
 3     ITGA5;CADM4;PRKD2;EMILIN1;DAB2IP;HHEX;MMRN2;GRB10        NME2  NME2_AP
 4                                   ATP2A1;KCTD17;PSEN1        NME2  NME2_AP
 ...                                                 ...         ...      ...
 2032  SKA1;CLASP2;ARHGEF10;ERCC6L;SUN2;KIF18A;CENPI;...        NME2  NME2_AP
 2033            AGTR1;VPS11;PLA2G10;AMER1;ASPSCR1;NR1H3        NME2  NME2_AP
 2034  SKA1;CLASP2;ERCC6L;SUN2;KIF18A;CENPI;MIS12;TAO...        NME2  NME2_AP
 2035  HSPA1L;CAMK2G;NUP205;NUP210;MLST8;NUP85;CCAR2;...        NME2  NME2_AP
 2036  GTF2H4;GTF2H2C;POLD3;XPC;ERCC8;ZNF830;COPS7A;L...        NME2  NME2_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of potassium ion transport...  0.7502
 1     prerank  positive regulation of cation transmembrane tr...  0.7642
 2     prerank  positive regulation of potassium ion transmemb...  0.6984
 3     prerank     carboxylic acid metabolic process (GO:0019752)  0.6833
 4     prerank   peptidyl-tyrosine dephosphorylation (GO:0035335)  0.6139
 ...       ...                                                ...     ...
 2032  prerank  mitochondrial translational termination (GO:00... -0.1426
 2033  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1346
 2034  prerank         regulation of mRNA processing (GO:0050684) -0.1342
 2035  prerank            nucleotide-excision repair (GO:0006289) -0.1272
 2036  prerank  regulation of phosphoprotein phosphatase activ... -0.1211

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8561    0.0032    0.7146     0.4520    3/16   0.92%
 1     1.8212    0.0000    0.5521     0.5940    3/15   0.92%
 2     1.8018    0.0000    0.4630     0.6720    3/19   0.92%
 3     1.7697    0.0071    0.4973     0.7910    8/21  11.58%
 4     1.7245    0.0103    0.6482     0.9170    8/28   9.18%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2202    1.0000    1.0000     1.0000   88/88  85.85%
 2033 -0.2085    1.0000    1.0000     1.0000  18/121  26.60%
 2034 -0.2065    1.0000    1.0000     1.0000   11/33  33.12%
 2035 -0.1959    1.0000    1.0000     1.0000  24/101  28.73%
 2036 -0.1868    1.0000    1.0000     1.0000    1/27   6.74%

                                              Lead_genes Target_Gene     Guide  \
 0                                    KCNH2;KCNN2;GABBR2       KDM2A  KDM2A_MP
 1                                    KCNH2;KCNN2;GABBR2       KDM2A  KDM2A_MP
 2                                    KCNH2;KCNN2;GABBR2       KDM2A  KDM2A_MP
 3     SLC2A3;CYP4F22;TBXAS1;SIRT4;CSGALNACT1;CYP2J2;...       KDM2A  KDM2A_MP
 4     UBASH3B;DUSP9;PTPRQ;DUSP7;PTPN22;DUSP3;PTPRJ;D...       KDM2A  KDM2A_MP
 ...                                                 ...         ...       ...
 2032  MTRF1;MRPL2;MRPL38;MRPS22;MRPL50;MRPL27;MRPL1;...       KDM2A  KDM2A_MP
 2033  DDX39B;GEMIN4;NLE1;GEMIN8;SMN1;NAF1;SETX;SNUPN...       KDM2A  KDM2A_MP
 2034  CPSF4;PTCD2;IWS1;SON;CDK11B;LARP7;SUPT6H;SF1;K...       KDM2A  KDM2A_MP
 2035  CCNH;ERCC6;POLD3;COPS7B;RFC2;COPS8;GPS1;SLX4;L...       KDM2A  KDM2A_MP
 2036                                              MAGI2       KDM2A  KDM2A_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of response to biotic stim...  0.6610
 1     prerank  positive regulation of B cell activation (GO:0...  0.6153
 2     prerank  negative regulation of mRNA catabolic process ...  0.5961
 3     prerank  tRNA-containing ribonucleoprotein complex expo...  0.5566
 4     prerank              tRNA export from nucleus (GO:0006409)  0.5566
 ...       ...                                                ...     ...
 2032  prerank                 translesion synthesis (GO:0019985) -0.1367
 2033  prerank  regulation of protein dephosphorylation (GO:00... -0.1243
 2034  prerank    ATP-dependent chromatin remodeling (GO:0043044) -0.1132
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1079
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.0976

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8127    0.0077    1.0000     0.6250     7/24  11.78%
 1     1.6481    0.0077    1.0000     0.9950     4/22   8.64%
 2     1.6138    0.0277    1.0000     0.9990     8/21  20.67%
 3     1.5972    0.0148    1.0000     0.9990    18/32  29.28%
 4     1.5972    0.0148    1.0000     0.9990    18/32  29.28%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2064    1.0000    1.0000     1.0000    11/37  30.54%
 2033 -0.1893    1.0000    1.0000     1.0000     3/35  15.64%
 2034 -0.1713    1.0000    1.0000     1.0000     4/40  18.87%
 2035 -0.1654    1.0000    1.0000     1.0000  160/160  89.36%
 2036 -0.1493    1.0000    1.0000     1.0000   37/121  38.92%

                                              Lead_genes Target_Gene     Guide  \
 0            OASL;DDX60;CYBA;PRKCA;ANKRD17;SASH1;PLSCR1       KDM2A  KDM2A_AP
 1                              CD74;TIRAP;TP53BP1;CLCF1       KDM2A  KDM2A_AP
 2           DND1;RBM24;AXIN2;TAF15;PKP3;PKP1;DHX34;NBAS       KDM2A  KDM2A_AP
 3     NOL6;NUP50;NUP35;NUP188;AAAS;NUP88;SEH1L;NUP13...       KDM2A  KDM2A_AP
 4     NOL6;NUP50;NUP35;NUP188;AAAS;NUP88;SEH1L;NUP13...       KDM2A  KDM2A_AP
 ...                                                 ...         ...       ...
 2032  POLE2;PRIMPOL;RFC3;POLDIP2;POLD1;POLD3;MAD2L2;...       KDM2A  KDM2A_AP
 2033                                  SMPD1;TGFB1;SYMPK       KDM2A  KDM2A_AP
 2034                      INO80B;SMARCE1;INO80;SMARCAD1       KDM2A  KDM2A_AP
 2035  DCP1B;CNOT6L;SMG9;SMG6;SMG5;RPS20;EXOSC9;MRTO4...       KDM2A  KDM2A_AP
 2036  TARBP2;GEMIN4;ISY1;PPAN;YTHDC1;GEMIN5;CRNKL1;C...       KDM2A  KDM2A_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of Ras protein signal tran...  0.6023
 1     prerank  positive regulation of response to biotic stim...  0.6076
 2     prerank     protein alpha-1,2-demannosylation (GO:0036508)  0.6282
 3     prerank  positive regulation of response to external st...  0.4966
 4     prerank  positive regulation of glucose transmembrane t...  0.6165
 ...       ...                                                ...     ...
 2032  prerank      aerobic electron transport chain (GO:0019646) -0.1379
 2033  prerank  regulation of transcription from RNA polymeras... -0.1275
 2034  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1241
 2035  prerank  RNA splicing, via transesterification reaction... -0.0998
 2036  prerank         DNA-dependent DNA replication (GO:0006261) -0.0914

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.6938    0.0161    1.0000     0.9650     8/30  10.09%
 1     1.6666    0.0075    1.0000     0.9830     6/24   7.07%
 2     1.6447    0.0102    1.0000     0.9940    11/23  24.88%
 3     1.6144    0.0085    1.0000     0.9980    14/63   9.09%
 4     1.6119    0.0305    1.0000     0.9980     2/21   3.43%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2160    1.0000    1.0000     1.0000    64/64  86.29%
 2033 -0.1997    1.0000    1.0000     1.0000    14/75  30.17%
 2034 -0.1943    1.0000    1.0000     1.0000    19/52  37.63%
 2035 -0.1557    1.0000    1.0000     1.0000   18/239  18.86%
 2036 -0.1444    1.0000    1.0000     1.0000  122/122  90.96%

                                              Lead_genes Target_Gene     Guide  \
 0      LYN;MAPRE2;COL3A1;AUTS2;RASGRF1;NOTCH1;F11R;EPOR       RC3H2  RC3H2_MP
 1                     OASL;DDX60;ADAM8;IFI35;CYBA;SASH1       RC3H2  RC3H2_MP
 2     MAN1C1;EDEM2;EDEM3;RNF103;SEL1L;RNF5;UGGT2;DER...       RC3H2  RC3H2_MP
 3     OASL;IL23A;TLR2;IL15;DDX60;ADAM8;MAPK13;IFI35;...       RC3H2  RC3H2_MP
 4                                           CLIP3;C2CD5       RC3H2  RC3H2_MP
 ...                                                 ...         ...       ...
 2032  NDUFC2;NDUFA11;UQCRC2;NDUFS7;NDUFS1;NDUFB7;SDH...       RC3H2  RC3H2_MP
 2033  KLF2;STOX1;ATF3;EGLN2;HMOX1;MUC1;HIF1A;HIF1AN;...       RC3H2  RC3H2_MP
 2034  HEATR3;PPAN;NLE1;LAS1L;EIF6;BRIX1;MRPL1;RPL10A...       RC3H2  RC3H2_MP
 2035  USP49;DHX35;NOVA1;CWF19L1;CPSF4;U2AF1L4;CWC27;...       RC3H2  RC3H2_MP
 2036  HELB;MCM6;GINS4;POLE2;DBF4;CDC6;PRIMPOL;CDC7;O...       RC3H2  RC3H2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of cytokine-mediated signa...  0.5996
 1     prerank  negative regulation of type I interferon-media...  0.6817
 2     prerank            pyruvate metabolic process (GO:0006090)  0.5619
 3     prerank         regulation of gluconeogenesis (GO:0006111)  0.6676
 4     prerank  positive regulation of cell development (GO:00...  0.6524
 ...       ...                                                ...     ...
 2032  prerank               regulation of cell size (GO:0008361) -0.1312
 2033  prerank               protein targeting to ER (GO:0045047) -0.1269
 2034  prerank  regulation of stem cell differentiation (GO:20... -0.1215
 2035  prerank  regulation of hematopoietic progenitor cell di... -0.1199
 2036  prerank  mRNA-containing ribonucleoprotein complex expo... -0.1153

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7769    0.0000    1.0000     0.7350   14/34  14.78%
 1     1.7145    0.0146    1.0000     0.9240    7/15  14.78%
 2     1.6860    0.0145    1.0000     0.9640   11/38  14.68%
 3     1.6706    0.0160    1.0000     0.9730    4/18  10.29%
 4     1.6639    0.0163    1.0000     0.9770    9/20  19.84%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2089    1.0000    1.0000     1.0000    1/18  10.14%
 2033 -0.1963    1.0000    1.0000     1.0000  97/100  69.11%
 2034 -0.1874    1.0000    1.0000     1.0000   70/71  82.59%
 2035 -0.1850    1.0000    1.0000     1.0000   63/63  88.08%
 2036 -0.1765    1.0000    1.0000     1.0000   19/93  27.11%

                                              Lead_genes Target_Gene     Guide  \
 0     NLRC5;SLIT2;SAMHD1;CACTIN;ROBO1;SH2B3;OAS1;PAL...       RC3H2  RC3H2_AP
 1            NLRC5;SAMHD1;CACTIN;OAS1;TTLL12;USP18;OAS3       RC3H2  RC3H2_AP
 2     LDHC;ME2;PFKFB2;ENO4;PDHX;ALDOC;HK2;NR4A3;ENO3...       RC3H2  RC3H2_AP
 3                               PPARGC1A;CRY1;DGKQ;MST1       RC3H2  RC3H2_AP
 4     HOXA11;LRP2;RFX3;ZNF335;LIG4;SOX11;BMP4;BHLHB9...       RC3H2  RC3H2_AP
 ...                                                 ...         ...       ...
 2032                                               EDN1       RC3H2  RC3H2_AP
 2033  CHMP4A;SGTB;SGTA;ZFAND2B;SRP72;ZFAND2A;SEC63;S...       RC3H2  RC3H2_AP
 2034  SMYD5;SETD1A;ITCH;BMPR1A;NELFB;LDB1;PSMB2;PSME...       RC3H2  RC3H2_AP
 2035  SETD1A;METTL14;ITCH;DHX36;LDB1;PSMB2;PSME3;PSM...       RC3H2  RC3H2_AP
 2036  U2AF1L4;NUP107;POLDIP3;RANBP2;NXT1;NUP85;POM12...       RC3H2  RC3H2_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  receptor signaling pathway via JAK-STAT (GO:00...  0.6759
 1     prerank  positive regulation of glucose transmembrane t...  0.6565
 2     prerank  phosphatidylinositol 3-kinase signaling (GO:00...  0.5981
 3     prerank            cellular response to virus (GO:0098586)  0.6271
 4     prerank  regulation of sodium ion transmembrane transpo...  0.6629
 ...       ...                                                ...     ...
 2032  prerank      regulation of exosomal secretion (GO:1903541) -0.1353
 2033  prerank                 organelle disassembly (GO:1903008) -0.1297
 2034  prerank          protein-DNA complex assembly (GO:0065004) -0.1313
 2035  prerank  positive regulation of fat cell differentiatio... -0.1199
 2036  prerank                         RNA transport (GO:0050658) -0.1058

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8581    0.0000    0.7572     0.4020    7/23   6.84%
 1     1.6838    0.0071    1.0000     0.9700    4/21   4.56%
 2     1.6525    0.0142    1.0000     0.9900    7/25  15.39%
 3     1.6496    0.0168    1.0000     0.9920    4/20   7.06%
 4     1.6399    0.0168    1.0000     0.9940    3/17   5.17%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2136    1.0000    1.0000     1.0000    1/16  10.92%
 2033 -0.1972    1.0000    1.0000     1.0000   12/31  36.17%
 2034 -0.1965    1.0000    1.0000     1.0000  39/108  39.10%
 2035 -0.1815    1.0000    1.0000     1.0000   10/33  33.74%
 2036 -0.1596    1.0000    1.0000     1.0000   27/68  39.67%

                                              Lead_genes Target_Gene    Guide  \
 0             IL15;STAT5A;STAT4;JAK3;CLCF1;SOCS6;IFNAR2        ZNF3  ZNF3_MP
 1                              CLIP3;SORBS1;CLTCL1;RHOQ        ZNF3  ZNF3_MP
 2              MYO16;CD160;EDN1;TYRO3;SIRT2;TPTE;PIK3CD        ZNF3  ZNF3_MP
 3                              OAS1;MAPK11;DDX58;LGALS8        ZNF3  ZNF3_MP
 4                                    SCN5A;RANGRF;SNTA1        ZNF3  ZNF3_MP
 ...                                                 ...         ...      ...
 2032                                              SDCBP        ZNF3  ZNF3_MP
 2033  DYRK3;GOLGA2;PLK3;UFC1;MRRF;PELO;EIF2D;ZFAND1;...        ZNF3  ZNF3_MP
 2034  GTF2H4;CCNH;PSMB9;PSME4;NAP1L2;CDK7;ORC6;PSMA3...        ZNF3  ZNF3_MP
 2035  CCDC71L;ZC3H12A;LRP5;WDFY2;CREBL2;METRNL;HNRNP...        ZNF3  ZNF3_MP
 2036  NXF1;POM121C;DDX39A;NUP153;MAGOH;DHX38;THOC5;P...        ZNF3  ZNF3_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of vascular endothelial growth fact...  0.7814
 1     prerank  positive regulation of vascular endothelial gr...  0.7814
 2     prerank  positive regulation of intrinsic apoptotic sig...  0.6368
 3     prerank  negative regulation of type I interferon-media...  0.7430
 4     prerank  regulation of type I interferon-mediated signa...  0.6328
 ...       ...                                                ...     ...
 2032  prerank    positive regulation of translation (GO:0045727) -0.1402
 2033  prerank              mRNA export from nucleus (GO:0006406) -0.1366
 2034  prerank  mitochondrial respiratory chain complex assemb... -0.1332
 2035  prerank                   ribosome biogenesis (GO:0042254) -0.1161
 2036  prerank                rRNA metabolic process (GO:0016072) -0.0975

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8500    0.0000    0.3226     0.3650     2/15   1.39%
 1     1.8500    0.0000    0.3226     0.3650     2/15   1.39%
 2     1.7737    0.0000    0.6413     0.7310     7/34   9.87%
 3     1.7493    0.0027    0.6465     0.8190     8/15  19.57%
 4     1.7486    0.0064    0.5213     0.8200     8/27  16.00%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2245    1.0000    1.0000     1.0000     2/82   4.92%
 2033 -0.2199    1.0000    1.0000     1.0000    13/99  18.16%
 2034 -0.2152    1.0000    1.0000     1.0000    20/82  33.93%
 2035 -0.1878    1.0000    1.0000     1.0000   30/181  29.87%
 2036 -0.1580    1.0000    1.0000     1.0000  150/150  90.38%

                                              Lead_genes Target_Gene    Guide  \
 0                                            SULF1;HPSE        ZNF3  ZNF3_AP
 1                                            SULF1;HPSE        ZNF3  ZNF3_AP
 2             BMF;S100A9;S100A8;MSX1;NUPR1;DDIT3;PMAIP1        ZNF3  ZNF3_AP
 3     NLRC5;OAS1;TTLL12;OAS3;SAMHD1;YTHDF3;CACTIN;STAT2        ZNF3  ZNF3_AP
 4     TRIM6;NLRC5;OAS1;TTLL12;OAS3;SAMHD1;YTHDF3;CACTIN        ZNF3  ZNF3_AP
 ...                                                 ...         ...      ...
 2032                                      CPEB3;MPV17L2        ZNF3  ZNF3_AP
 2033  THOC6;NUP153;PCID2;MAGOH;SMG7;GLE1;NXF1;SMG5;S...        ZNF3  ZNF3_AP
 2034  SLC25A33;TIMM21;SDHAF1;NDUFA9;NDUFB5;UQCC3;FOX...        ZNF3  ZNF3_AP
 2035  ZNF658;HELQ;RRP12;PAK1IP1;NOL8;HEATR1;UTP3;EXO...        ZNF3  ZNF3_AP
 2036  HELQ;RRP12;NOL8;HEATR1;UTP3;EXOSC7;DDX49;UTP20...        ZNF3  ZNF3_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank          keratinocyte differentiation (GO:0030216)  0.7282
 1     prerank                      skin development (GO:0043588)  0.5646
 2     prerank  negative regulation of peptidyl-serine phospho...  0.7264
 3     prerank          myeloid cell differentiation (GO:0030099)  0.5939
 4     prerank                         odontogenesis (GO:0042476)  0.6438
 ...       ...                                                ...     ...
 2032  prerank                       rRNA processing (GO:0006364) -0.1402
 2033  prerank  regulation of cellular amide metabolic process... -0.1364
 2034  prerank             regulation of translation (GO:0006417) -0.1352
 2035  prerank  nuclear-transcribed mRNA catabolic process, no... -0.1060
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0979

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     2.0489    0.0000    0.0865     0.0550     4/20   2.91%
 1     2.0104    0.0000    0.0740     0.0930    16/47  12.80%
 2     1.9984    0.0079    0.0601     0.1110     8/17   9.92%
 3     1.9687    0.0077    0.0718     0.1680     7/32   6.69%
 4     1.9378    0.0000    0.0897     0.2420     6/23   2.27%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2119    1.0000    1.0000     1.0000   32/165  29.37%
 2033 -0.2100    0.9988    1.0000     1.0000    26/26  86.40%
 2034 -0.2027    1.0000    1.0000     1.0000   38/152  30.77%
 2035 -0.1611    1.0000    1.0000     1.0000  107/110  78.84%
 2036 -0.1478    1.0000    1.0000     1.0000   17/160  24.59%

                                              Lead_genes Target_Gene  \
 0                                ANXA1;KRT16;CDSN;EPHA2      GTF2F1
 1     ANXA1;KRT16;COL3A1;CLDN1;CDSN;COL5A2;DLL1;EPHA...      GTF2F1
 2     PDE4D;MLXIPL;DKK1;CAV1;DDIT4;INPP5J;CNKSR3;GAD...      GTF2F1
 3                 LYN;JAK3;DYRK3;IL11;CDKN2B;INHA;TIRAP      GTF2F1
 4                    AQP3;CEMP1;SCN5A;AXIN2;TGFB2;TUFT1      GTF2F1
 ...                                                 ...         ...
 2032  HEATR1;EXOSC9;ERI1;DDX52;BMS1;NOLC1;WDR18;RIOK...      GTF2F1
 2033  NOLC1;TCOF1;METAP1;PKP3;FOXO3;EIF2B4;RPL10;RBM...      GTF2F1
 2034  CPEB3;KLHL25;EIF2AK3;ALKBH1;METTL14;PUS7;SHMT1...      GTF2F1
 2035  SMG9;SMG6;ETF1;UPF3B;UPF3A;RPLP0;PNRC2;EIF4G1;...      GTF2F1
 2036  SMG9;EXOSC9;ERI1;SMG6;DCP1B;PAN2;ETF1;XRN1;PDE...      GTF2F1

           Guide Direction
 0     GTF2F1_MP        Up
 1     GTF2F1_MP        Up
 2     GTF2F1_MP        Up
 3     GTF2F1_MP        Up
 4     GTF2F1_MP        Up
 ...         ...       ...
 2032  GTF2F1_MP      Down
 2033  GTF2F1_MP      Down
 2034  GTF2F1_MP      Down
 2035  GTF2F1_MP      Down
 2036  GTF2F1_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                    iron ion transport (GO:0006826)  0.6343
 1     prerank  Wnt signaling pathway, calcium modulating path...  0.6466
 2     prerank         regulation of ruffle assembly (GO:1900027)  0.7271
 3     prerank  negative regulation of cell-substrate adhesion...  0.6354
 4     prerank                 transferrin transport (GO:0033572)  0.6123
 ...       ...                                                ...     ...
 2032  prerank  protein modification by small protein removal ... -0.1389
 2033  prerank  nuclear-transcribed mRNA catabolic process, de... -0.1257
 2034  prerank  regulation of transcription from RNA polymeras... -0.1043
 2035  prerank          peptide biosynthetic process (GO:0043043) -0.0917
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0836

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8472    0.0000    0.8827     0.4100     8/37  13.56%
 1     1.7646    0.0032    1.0000     0.8010    10/30  13.81%
 2     1.7314    0.0028    1.0000     0.9010     6/17   8.86%
 3     1.7249    0.0000    1.0000     0.9140     5/27  10.07%
 4     1.7185    0.0062    0.9285     0.9290     3/29   2.33%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2227    1.0000    1.0000     1.0000   11/227   9.92%
 2033 -0.1993    1.0000    1.0000     1.0000     9/51  23.86%
 2034 -0.1628    1.0000    1.0000     1.0000     2/65   7.09%
 2035 -0.1492    1.0000    1.0000     1.0000  131/138  70.77%
 2036 -0.1360    1.0000    1.0000     1.0000  159/160  88.71%

                                              Lead_genes Target_Gene  \
 0     HFE;ATP6V0A4;TTYH1;ATP6V1B1;ABCB7;ATP6V1C1;IRE...      GTF2F1
 1     GNAO1;WNT11;FZD2;PLCB2;PDE6A;NLK;LEF1;FZD5;AGO...      GTF2F1
 2                  PLEKHM1;RDX;ARHGAP24;CAV1;NDEL1;EPS8      GTF2F1
 3                         GBP1;ACER2;SPRY4;GCNT2;CDKN2A      GTF2F1
 4                                 HFE;ATP6V0A4;ATP6V1B1      GTF2F1
 ...                                                 ...         ...
 2032  USP49;TRAF6;TNFAIP3;DDX58;TAB1;OTUD1;USP28;FOX...      GTF2F1
 2033  DCP1B;PARN;SAMD4A;CNOT6;TTC37;PATL1;PAN3;EXOSC...      GTF2F1
 2034                                        LIMD1;STOX1      GTF2F1
 2035  GGT1;SRBD1;MRPL23;HARS2;MRPL32;FARSB;MRPL10;MR...      GTF2F1
 2036  DCP1B;CTIF;PARN;SAMD4A;DHX34;HELZ2;DXO;CNOT6;M...      GTF2F1

           Guide Direction
 0     GTF2F1_AP        Up
 1     GTF2F1_AP        Up
 2     GTF2F1_AP        Up
 3     GTF2F1_AP        Up
 4     GTF2F1_AP        Up
 ...         ...       ...
 2032  GTF2F1_AP      Down
 2033  GTF2F1_AP      Down
 2034  GTF2F1_AP      Down
 2035  GTF2F1_AP      Down
 2036  GTF2F1_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of cardiac muscle contraction (GO:0...  0.7751
 1     prerank  regulation of interleukin-12 production (GO:00...  0.6825
 2     prerank  negative regulation of synaptic transmission (...  0.7257
 3     prerank  positive regulation of T cell proliferation (G...  0.6190
 4     prerank          cellular response to alcohol (GO:0097306)  0.6227
 ...       ...                                                ...     ...
 2032  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1301
 2033  prerank   mitochondrial membrane organization (GO:0007006) -0.1286
 2034  prerank      aerobic electron transport chain (GO:0019646) -0.1219
 2035  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1152
 2036  prerank             regulation of translation (GO:0006417) -0.1022

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9067    0.0000    0.3744     0.2370    4/16   2.25%
 1     1.8565    0.0066    0.3902     0.4150    8/24   8.70%
 2     1.8212    0.0060    0.4118     0.5500    6/16   9.83%
 3     1.7678    0.0036    0.6054     0.7790    6/27   8.70%
 4     1.7222    0.0036    0.7899     0.9130    7/27   5.19%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2194    1.0000    1.0000     1.0000  54/260  32.39%
 2033 -0.2177    1.0000    1.0000     1.0000   16/27  44.83%
 2034 -0.2088    1.0000    1.0000     1.0000   64/64  87.89%
 2035 -0.1920    1.0000    1.0000     1.0000  40/121  42.38%
 2036 -0.1728    1.0000    1.0000     1.0000  42/152  37.41%

                                              Lead_genes Target_Gene     Guide  \
 0                                CHGA;PDE4D;SCN5A;SMAD7       SRSF5  SRSF5_MP
 1          CCR7;HLA-G;JAK3;MAPK11;TLR2;IL23A;PIBF1;AGER       SRSF5  SRSF5_MP
 2                 PRRT1;TMEM25;MTMR2;SLC24A1;GRIK3;DRD2       SRSF5  SRSF5_MP
 3                       IL15;ANXA1;JAK3;IGF2;IL23A;AGER       SRSF5  SRSF5_MP
 4       PTGER2;AKR1C2;SPHK2;OSBPL7;MAP4K1;GRAMD1C;ADCY7       SRSF5  SRSF5_MP
 ...                                                 ...         ...       ...
 2032  SRSF5;NOVA1;TFIP11;U2AF1;SNUPN;CWC27;GPKOW;BUD...       SRSF5  SRSF5_MP
 2033  SPG7;MFN1;IMMT;CHCHD6;GHITM;BAK1;TIMM50;MTX1;B...       SRSF5  SRSF5_MP
 2034  COX10;NDUFA9;NDUFA13;NDUFB3;NDUFV1;UQCC3;UQCRQ...       SRSF5  SRSF5_MP
 2035  SRSF5;SNUPN;RBM5;LUC7L;DDX20;PRPF18;DDX23;SNRN...       SRSF5  SRSF5_MP
 2036  CPEB3;IGFBP5;ENC1;PASK;CTIF;RPS6KA3;POLDIP3;AL...       SRSF5  SRSF5_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of protein polymerization ...  0.7042
 1     prerank  regulation of cardiac muscle cell action poten...  0.6971
 2     prerank           digestive tract development (GO:0048565)  0.7164
 3     prerank  positive regulation of fibroblast proliferatio...  0.7155
 4     prerank  negative regulation of microtubule polymerizat...  0.6618
 ...       ...                                                ...     ...
 2032  prerank                         RNA transport (GO:0050658) -0.1310
 2033  prerank             translational termination (GO:0006415) -0.1212
 2034  prerank  mitochondrial translational termination (GO:00... -0.1193
 2035  prerank  mitochondrial translational elongation (GO:007... -0.1153
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1122

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8061    0.0000    1.0000     0.6080    5/21  10.30%
 1     1.7860    0.0147    0.8032     0.7010    5/18  11.27%
 2     1.7742    0.0000    0.6133     0.7450    5/15  10.34%
 3     1.7552    0.0089    0.5761     0.8080    3/18   4.63%
 4     1.7379    0.0142    0.5603     0.8640    3/24   3.32%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1997    1.0000    1.0000     1.0000   14/68  26.50%
 2033 -0.1858    1.0000    1.0000     1.0000   27/94  37.48%
 2034 -0.1820    1.0000    1.0000     1.0000   26/88  37.48%
 2035 -0.1761    1.0000    1.0000     1.0000   25/88  37.48%
 2036 -0.1729    1.0000    1.0000     1.0000  43/121  39.99%

                                              Lead_genes Target_Gene     Guide  \
 0                          CLIP3;KANK3;SLIT2;PRKCD;SSH1       SRSF5  SRSF5_AP
 1                       CACNA1C;CXADR;FGF13;CAMK2D;PKP2       SRSF5  SRSF5_AP
 2                         CCDC40;MEGF8;PKDCC;PKD1;GATA4       SRSF5  SRSF5_AP
 3                                       PDGFC;CD74;DDR2       SRSF5  SRSF5_AP
 4                                    TRIM54;CLIP3;FGF13       SRSF5  SRSF5_AP
 ...                                                 ...         ...       ...
 2032  XPO5;NUP62;SARNP;PNPT1;CKAP5;CASC3;FMR1;POM121...       SRSF5  SRSF5_AP
 2033  MRPL53;PTCD3;MRPS10;MRPS9;MRPS22;GFM2;MRPL40;M...       SRSF5  SRSF5_AP
 2034  MRPL53;PTCD3;MRPS10;MRPS9;MRPS22;GFM2;MRPL40;M...       SRSF5  SRSF5_AP
 2035  MRPL53;PTCD3;MRPS10;MRPS9;MRPS22;TSFM;GFM2;MRP...       SRSF5  SRSF5_AP
 2036  NLE1;TARBP2;GEMIN6;LUC7L;EIF6;CPSF6;BRIX1;NAF1...       SRSF5  SRSF5_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of T cell proliferation (G...  0.7398
 1     prerank    regulation of T cell proliferation (GO:0042129)  0.6931
 2     prerank   regulation of macrophage activation (GO:0043030) -0.9583
 3     prerank          plasma membrane invagination (GO:0099024) -0.9477
 4     prerank  positive regulation of myeloid leukocyte diffe... -0.9361
 ...       ...                                                ...     ...
 2032  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1495
 2033  prerank         Fc receptor signaling pathway (GO:0038093) -0.1491
 2034  prerank           spliceosomal snRNP assembly (GO:0000387) -0.1377
 2035  prerank         DNA-dependent DNA replication (GO:0006261) -0.1237
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1016

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9623    0.0000    0.1234     0.0930    5/27   2.54%
 1     1.8643    0.0000    0.3576     0.3860    7/27   5.43%
 2    -1.8532    0.0037    0.0851     0.0860    2/16   0.49%
 3    -1.8511    0.0017    0.0474     0.0930    2/19   0.28%
 4    -1.8193    0.0050    0.1974     0.4430    2/19   0.49%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2796    1.0000    1.0000     1.0000   16/52  32.20%
 2033 -0.2787    1.0000    1.0000     1.0000    4/93   7.08%
 2034 -0.2625    1.0000    1.0000     1.0000   11/37  31.44%
 2035 -0.2339    1.0000    1.0000     1.0000  49/122  34.27%
 2036 -0.1892    1.0000    1.0000     1.0000  31/121  29.91%

                                              Lead_genes Target_Gene    Guide  \
 0                          ANXA1;JAK3;IL23A;TNFSF9;IL15        ADAR  ADAR_MP
 1            ANXA1;JAK3;IL23A;TNFSF9;IL15;TNFRSF21;GLMN        ADAR  ADAR_MP
 2                                           FCGR2B;CD74        ADAR  ADAR_MP
 3                                           FCGR2B;BIN2        ADAR  ADAR_MP
 4                                              LIF;CD74        ADAR  ADAR_MP
 ...                                                 ...         ...      ...
 2032  NVL;WDR12;MDN1;NOP16;BOP1;EBNA1BP2;LAS1L;BRIX1...        ADAR  ADAR_MP
 2033                                GAB2;LYN;PIK3R2;FER        ADAR  ADAR_MP
 2034  SART3;GEMIN5;SNUPN;SRSF10;DDX20;SMN1;GEMIN4;PR...        ADAR  ADAR_MP
 2035  PRIMPOL;RFC5;HELB;POLA2;RFC2;WRN;SIRT7;PRIM2;O...        ADAR  ADAR_MP
 2036  SART3;GEMIN5;MDN1;SF3A2;SNUPN;BOP1;SRSF10;EIF2...        ADAR  ADAR_MP

      Direction
 0           Up
 1           Up
 2         Down
 3         Down
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  glutamate receptor signaling pathway (GO:0007215)  0.7417
 1     prerank  defense response to Gram-positive bacterium (G...  0.7071
 2     prerank                granulocyte chemotaxis (GO:0071621)  0.6969
 3     prerank  cellular response to amino acid stimulus (GO:0...  0.6177
 4     prerank  negative regulation of signal transduction by ...  0.7055
 ...       ...                                                ...     ...
 2032  prerank  nuclear-transcribed mRNA catabolic process, no... -0.1151
 2033  prerank  regulation of mitotic cell cycle phase transit... -0.1134
 2034  prerank  DNA damage response, signal transduction by p5... -0.1192
 2035  prerank  regulation of cell cycle phase transition (GO:... -0.1049
 2036  prerank                       gene expression (GO:0010467) -0.0975

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.7555    0.0000    1.0000     0.7760     6/16   8.91%
 1     1.7235    0.0024    1.0000     0.8940     4/16   0.89%
 2     1.6836    0.0110    1.0000     0.9690     6/18   9.12%
 3     1.6736    0.0153    1.0000     0.9800     6/26   9.61%
 4     1.6632    0.0124    1.0000     0.9900     5/15   7.63%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1889    1.0000    1.0000     1.0000  109/110  79.08%
 2033 -0.1883    1.0000    1.0000     1.0000    9/174  12.37%
 2034 -0.1859    1.0000    1.0000     1.0000    14/51  30.43%
 2035 -0.1695    1.0000    1.0000     1.0000    21/85  30.55%
 2036 -0.1596    1.0000    1.0000     1.0000   57/324  27.39%

                                              Lead_genes Target_Gene    Guide  \
 0                 GRIN2C;GRIK3;DAGLA;CPEB4;PTK2B;CDK5R1        ADAR  ADAR_AP
 1                                    CHGA;CAMP;TLR2;LYZ        ADAR  ADAR_AP
 2               ANXA1;CXADR;S100A8;PIK3CD;PIKFYVE;ITGB2        ADAR  ADAR_AP
 3                     SESN3;FYN;SESN1;CPEB4;RRAGD;SESN2        ADAR  ADAR_AP
 4                          CD74;SNAI2;TWIST1;RFFL;SNAI1        ADAR  ADAR_AP
 ...                                                 ...         ...      ...
 2032  SKIV2L;CASC3;NCBP1;ETF1;PNRC2;RPS10;GSPT1;MAGO...        ADAR  ADAR_AP
 2033  TUBA4A;HAUS7;KLHL18;PPP1R9B;HECW2;DCTN1;ZW10;A...        ADAR  ADAR_AP
 2034  ARID3A;TFDP2;CRADD;TFDP1;CNOT10;CNOT3;PCNA;CNO...        ADAR  ADAR_AP
 2035  DBF4B;ATP2B4;ANAPC10;TRIM39;FBXO5;ERCC3;ANAPC5...        ADAR  ADAR_AP
 2036  ADAR;NUP43;THRB;BICD1;ATXN1;NUP153;NDC1;POLDIP...        ADAR  ADAR_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  hematopoietic progenitor cell differentiation ...  0.7932
 1     prerank  positive regulation of fibroblast proliferatio...  0.7141
 2     prerank  nucleobase-containing compound biosynthetic pr...  0.6943
 3     prerank  MyD88-dependent toll-like receptor signaling p...  0.6646
 4     prerank  defense response to Gram-positive bacterium (G...  0.6960
 ...       ...                                                ...     ...
 2032  prerank  mRNA-containing ribonucleoprotein complex expo... -0.1228
 2033  prerank  regulation of cellular response to heat (GO:19... -0.1201
 2034  prerank              mRNA export from nucleus (GO:0006406) -0.1140
 2035  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1113
 2036  prerank  regulation of protein dephosphorylation (GO:00... -0.0993

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.9140    0.0000    0.2853     0.1980   2/16   0.50%
 1     1.8161    0.0034    0.5805     0.5710   5/18  11.47%
 2     1.7447    0.0120    0.8992     0.8440   2/18   2.44%
 3     1.7191    0.0158    0.8777     0.9070   7/19  12.43%
 4     1.6642    0.0086    1.0000     0.9830   4/16   5.05%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.1905    1.0000    1.0000     1.0000  38/93  40.05%
 2033 -0.1862    1.0000    1.0000     1.0000   4/73  10.01%
 2034 -0.1773    1.0000    1.0000     1.0000  36/99  38.85%
 2035 -0.1720    1.0000    1.0000     1.0000  2/112   5.28%
 2036 -0.1555    1.0000    1.0000     1.0000   5/35  23.85%

                                              Lead_genes Target_Gene     Guide  \
 0                                              FLT1;FST       NR2F2  NR2F2_MP
 1                           CD74;PDGFC;CDK6;DDR2;NDUFS4       NR2F2  NR2F2_MP
 2                                              CDA;TERT       NR2F2  NR2F2_MP
 3                  TLR2;CD14;TAB1;TNIP1;TAB3;TIRAP;TLR5       NR2F2  NR2F2_MP
 4                                    CHGA;TLR2;LYZ;GBP2       NR2F2  NR2F2_MP
 ...                                                 ...         ...       ...
 2032  NUP43;HHEX;SYMPK;NUP85;NUP188;THOC6;SLBP;SMG1;...       NR2F2  NR2F2_MP
 2033                          HSPA1L;NUP43;NUP85;NUP188       NR2F2  NR2F2_MP
 2034  NUP43;HHEX;SYMPK;NUP85;NUP188;THOC6;SLBP;SMG1;...       NR2F2  NR2F2_MP
 2035                                       PKP1;TNFSF13       NR2F2  NR2F2_MP
 2036                      SYMPK;PPP1R16A;PPP1R8;HTT;GBA       NR2F2  NR2F2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank              receptor internalization (GO:0031623)  0.6224
 1     prerank  regulation of axon extension involved in axon ...  0.6896
 2     prerank  negative regulation of amyloid precursor prote...  0.7071
 3     prerank           striated muscle contraction (GO:0006941)  0.6957
 4     prerank  negative regulation of signal transduction by ...  0.6727
 ...       ...                                                ...     ...
 2032  prerank                        mRNA transport (GO:0051028) -0.1341
 2033  prerank  mRNA-containing ribonucleoprotein complex expo... -0.1319
 2034  prerank  regulation of phosphoprotein phosphatase activ... -0.1271
 2035  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1100
 2036  prerank  regulation of stem cell differentiation (GO:20... -0.0992

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7362    0.0033    1.0000     0.8610    7/30  12.06%
 1     1.7175    0.0078    1.0000     0.9210    8/17  16.31%
 2     1.6679    0.0128    1.0000     0.9820    6/15  15.39%
 3     1.6673    0.0050    1.0000     0.9820    4/15   6.39%
 4     1.6386    0.0167    1.0000     0.9930    6/15  11.81%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2124    1.0000    1.0000     1.0000   18/98  22.51%
 2033 -0.2092    1.0000    1.0000     1.0000   17/93  22.51%
 2034 -0.2075    1.0000    1.0000     1.0000    1/27   7.27%
 2035 -0.1769    1.0000    1.0000     1.0000  25/112  30.54%
 2036 -0.1588    1.0000    1.0000     1.0000   12/71  26.86%

                                              Lead_genes Target_Gene     Guide  \
 0                 SAG;ITGB2;MX2;DNM1;SNX1;ACKR3;LDLRAP1       NR2F2  NR2F2_AP
 1     SEMA4G;SEMA4F;SEMA3E;MEGF8;SEMA6A;SEMA3F;SEMA4...       NR2F2  NR2F2_AP
 2                      APOE;ABCA7;BIN1;NTRK2;GGA3;SORL1       NR2F2  NR2F2_AP
 3                            KCNH2;STAC3;SCN5A;ARHGEF11       NR2F2  NR2F2_AP
 4                  TWIST1;SNAI1;CD74;SNAI2;DYRK1A;SIRT1       NR2F2  NR2F2_AP
 ...                                                 ...         ...       ...
 2032  DDX39B;GLE1;NUP35;POLDIP3;ARC;NUP133;RANBP2;NU...       NR2F2  NR2F2_AP
 2033  DDX39B;GLE1;NUP35;POLDIP3;NUP133;RANBP2;NUP107...       NR2F2  NR2F2_AP
 2034                                               CRY2       NR2F2  NR2F2_AP
 2035  GTPBP1;PCBP4;RBM24;YTHDF3;PSME4;UPF1;PSMD14;XR...       NR2F2  NR2F2_AP
 2036  ITCH;RBM24;EIF2AK2;MYB;PSME4;PSMD14;RUNX1;PSMA...       NR2F2  NR2F2_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  cellular response to type I interferon (GO:007...  0.6931
 1     prerank   type I interferon signaling pathway (GO:0060337)  0.6931
 2     prerank  positive regulation of response to biotic stim...  0.7373
 3     prerank  cellular response to hydrogen peroxide (GO:007...  0.6885
 4     prerank  regulation of cardiac muscle contraction (GO:0... -0.9667
 ...       ...                                                ...     ...
 2032  prerank          COPII-coated vesicle budding (GO:0090114) -0.1260
 2033  prerank             mitochondrial translation (GO:0032543) -0.1248
 2034  prerank  mitochondrial respiratory chain complex assemb... -0.1130
 2035  prerank                       rRNA processing (GO:0006364) -0.1048
 2036  prerank                           translation (GO:0006412) -0.0921

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9872    0.0000    0.0252     0.0420   17/43  16.63%
 1     1.9872    0.0000    0.0252     0.0420   17/43  16.63%
 2     1.9250    0.0000    0.0587     0.1360    5/24   5.30%
 3     1.8025    0.0026    0.3450     0.6290    3/28   0.82%
 4    -1.7876    0.0000    0.4647     0.3690    2/16   0.52%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2265    1.0000    1.0000     1.0000   19/64  31.95%
 2033 -0.2219    1.0000    1.0000     1.0000  28/102  32.88%
 2034 -0.2008    1.0000    1.0000     1.0000   21/82  30.22%
 2035 -0.1885    1.0000    1.0000     1.0000  21/165  22.92%
 2036 -0.1687    1.0000    1.0000     1.0000   7/187  12.53%

                                              Lead_genes Target_Gene    Guide  \
 0     IRF9;OASL;IFIT1;HLA-G;HLA-F;IRF5;MX1;IRF1;GBP2...        BZW1  BZW1_MP
 1     IRF9;OASL;IFIT1;HLA-G;HLA-F;IRF5;MX1;IRF1;GBP2...        BZW1  BZW1_MP
 2                             OASL;CYBA;DDX60;ADAM8;NMI        BZW1  BZW1_MP
 3                                    ANXA1;PAX2;TNFAIP3        BZW1  BZW1_MP
 4                                            SCN5A;CHGA        BZW1  BZW1_MP
 ...                                                 ...         ...      ...
 2032  FOLR1;GOSR2;F8;PPP6R1;PEF1;SAR1A;ANKRD28;TRAPP...        BZW1  BZW1_MP
 2033  MRPS17;MRPS27;MRPL50;MRPL32;MRPS14;MRPL42;MRPL...        BZW1  BZW1_MP
 2034  NDUFA9;FASTKD3;NDUFA5;UQCC1;FOXRED1;ECSIT;UQCC...        BZW1  BZW1_MP
 2035  SENP3;NAT10;DHX37;DDX52;RRP12;MPHOSPH10;BMS1;E...        BZW1  BZW1_MP
 2036       MRPS17;EEF1G;HARS2;MRPL32;FARS2;DARS2;EEF1E1        BZW1  BZW1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank           regulation of cell motility (GO:2000145)  0.5330
 1     prerank  defense response to Gram-positive bacterium (G...  0.7602
 2     prerank  phosphatidylinositol 3-kinase signaling (GO:00...  0.6513
 3     prerank  regulation of Rac protein signal transduction ...  0.7036
 4     prerank                     protein secretion (GO:0009306)  0.5691
 ...       ...                                                ...     ...
 2032  prerank         DNA-dependent DNA replication (GO:0006261) -0.1304
 2033  prerank                        nuclear export (GO:0051168) -0.1303
 2034  prerank  regulation of stem cell differentiation (GO:20... -0.1224
 2035  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1088
 2036  prerank          peptide biosynthetic process (GO:0043043) -0.0985

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8876    0.0000    0.2748     0.2050    17/81   8.47%
 1     1.8145    0.0029    0.4315     0.4960     7/16  13.31%
 2     1.7325    0.0098    0.8407     0.8580     4/25   1.33%
 3     1.6725    0.0112    1.0000     0.9660     7/15  15.74%
 4     1.6282    0.0152    1.0000     0.9940    10/38  12.46%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2014    1.0000    1.0000     1.0000   22/122  27.39%
 2033 -0.2000    1.0000    1.0000     1.0000    14/76  25.29%
 2034 -0.1898    1.0000    1.0000     1.0000     5/71  14.04%
 2035 -0.1677    1.0000    1.0000     1.0000   32/260  21.81%
 2036 -0.1524    1.0000    1.0000     1.0000  137/138  81.69%

                                              Lead_genes Target_Gene    Guide  \
 0     PLXNC1;CADM4;TWIST1;CCR7;HBEGF;NRG4;DOCK10;SRC...        BZW1  BZW1_AP
 1                  LYZ;TLR2;CAMP;CHGA;TIRAP;GBP2;DROSHA        BZW1  BZW1_AP
 2                              CD160;MYO16;TPTE;PIK3C2G        BZW1  BZW1_AP
 3     RASGRF1;ARHGAP24;CADM4;ALS2;ARHGAP44;SH3BP1;AUTS2        BZW1  BZW1_AP
 4     ANXA1;TVP23C;COPG2;TANGO6;RAB3A;NAGPA;SEL1L;MO...        BZW1  BZW1_AP
 ...                                                 ...         ...      ...
 2032  MCMDC2;TEFM;NOC3L;PSME4;HELB;PSMD5;LRWD1;DDX23...        BZW1  BZW1_AP
 2033  RANBP17;STRADB;THOC6;RANBP3;U2AF1L4;ATXN1;DHX3...        BZW1  BZW1_AP
 2034                      LDB1;PSME4;SETD1A;SMYD5;PSMD5        BZW1  BZW1_AP
 2035  NOVA1;DHX35;TFIP11;SUGP1;PPIL3;SNIP1;RBM14;USP...        BZW1  BZW1_AP
 2036  GGT7;GGT6;IGHMBP2;MRPL42;EIF4EBP2;MRPL13;GGT1;...        BZW1  BZW1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of leukocyte mediated cyto...  0.7295
 1     prerank  positive regulation of toll-like receptor sign...  0.7071
 2     prerank  negative regulation of TOR signaling (GO:0032007)  0.6060
 3     prerank                        axon extension (GO:0048675)  0.6836
 4     prerank  positive regulation of NIK/NF-kappaB signaling...  0.5857
 ...       ...                                                ...     ...
 2032  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1214
 2033  prerank         spliceosomal complex assembly (GO:0000245) -0.1175
 2034  prerank  transcription-coupled nucleotide-excision repa... -0.1138
 2035  prerank                rRNA metabolic process (GO:0016072) -0.0921
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.0819

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7919    0.0026    1.0000     0.6310    8/16  15.94%
 1     1.7609    0.0027    1.0000     0.7550    6/18   5.91%
 2     1.7488    0.0035    0.9387     0.8070   11/33  12.57%
 3     1.7168    0.0152    1.0000     0.9000    7/17  14.25%
 4     1.6774    0.0000    1.0000     0.9640    8/31   9.65%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1927    1.0000    1.0000     1.0000  13/112  21.19%
 2033 -0.1845    1.0000    1.0000     1.0000   38/38  88.30%
 2034 -0.1798    1.0000    1.0000     1.0000   20/73  31.42%
 2035 -0.1478    1.0000    1.0000     1.0000  70/150  39.01%
 2036 -0.1321    1.0000    1.0000     1.0000  46/121  36.82%

                                              Lead_genes Target_Gene    Guide  \
 0     CD160;HLA-DRB1;HLA-DRA;HLA-G;IL23A;CADM1;PVR;R...        FHL2  FHL2_MP
 1                     TLR2;PTPN22;CYBA;CAV1;F2RL1;IFI35        FHL2  FHL2_MP
 2     SESN3;EPM2A;DEPTOR;SESN1;PRKAA1;ITFG2;TSC1;SZT...        FHL2  FHL2_MP
 3            SLIT2;AUTS2;SLC9A6;NRP2;SPG11;CYFIP1;ALCAM        FHL2  FHL2_MP
 4       TLR2;PTP4A3;SASH1;IL23A;IFI35;TRAF6;ACTN4;PDCD4        FHL2  FHL2_MP
 ...                                                 ...         ...      ...
 2032  PCBP4;TNFSF13;YTHDF2;PKP3;PSMD9;SAMD4B;PSMD10;...        FHL2  FHL2_MP
 2033  DDX39B;YTHDC1;USP39;SF3A2;SNRPD2;NOL3;PUF60;TX...        FHL2  FHL2_MP
 2034  GTF2H4;ISY1;POLD1;COPS8;ERCC2;COPS7A;POLD3;TCE...        FHL2  FHL2_MP
 2035  DIS3L;UTP14A;SENP3;HELQ;DDX49;PELP1;NOC4L;RRP9...        FHL2  FHL2_MP
 2036  DDX39B;GEMIN2;PRPF18;YTHDC1;ISY1;PPAN;RSL24D1;...        FHL2  FHL2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank      transition metal ion homeostasis (GO:0055076)  0.6907
 1     prerank  positive regulation of ATP metabolic process (...  0.6797
 2     prerank  positive regulation of phospholipase activity ... -0.9482
 3     prerank  positive regulation of peptidyl-threonine phos... -0.9456
 4     prerank  negative regulation of protein transport (GO:0... -0.9448
 ...       ...                                                ...     ...
 2032  prerank  positive regulation of nucleocytoplasmic trans... -0.1256
 2033  prerank          regulation of mRNA stability (GO:0043488) -0.1245
 2034  prerank              mRNA export from nucleus (GO:0006406) -0.1256
 2035  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1181
 2036  prerank                      ncRNA processing (GO:0034470) -0.1082

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7748    0.0062    1.0000     0.8020    3/17   3.02%
 1     1.7552    0.0028    1.0000     0.8520    8/20  11.11%
 2    -1.6915    0.0118    0.5145     0.3780    2/15   0.52%
 3    -1.6749    0.0058    0.6323     0.6680    2/20   0.97%
 4    -1.6682    0.0015    0.5779     0.7720    2/17   1.02%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2096    1.0000    1.0000     1.0000    1/40   5.73%
 2033 -0.2086    1.0000    1.0000     1.0000  28/128  30.12%
 2034 -0.2086    1.0000    1.0000     1.0000   11/99  20.75%
 2035 -0.1987    1.0000    1.0000     1.0000  25/112  30.12%
 2036 -0.1813    1.0000    1.0000     1.0000  38/185  31.87%

                                              Lead_genes Target_Gene    Guide  \
 0                                        BDH2;HFE;HMOX1        FHL2  FHL2_AP
 1     PPARGC1A;MLXIPL;PFKFB2;PFKFB4;ENTPD5;PSEN1;BEN...        FHL2  FHL2_AP
 2                                           AGTR1;NTRK3        FHL2  FHL2_AP
 3                                           S1PR2;TRIM6        FHL2  FHL2_AP
 4                                            PKDCC;APOE        FHL2  FHL2_AP
 ...                                                 ...         ...      ...
 2032                                               XPO4        FHL2  FHL2_AP
 2033  SAMD4A;DIS3;RC3H1;FASTKD1;GIGYF2;KHSRP;EIF4ENI...        FHL2  FHL2_AP
 2034  U2AF1;POLDIP3;DHX38;NUP43;NUP155;IWS1;HHEX;THO...        FHL2  FHL2_AP
 2035  SAMD4A;DIS3;RC3H1;KHSRP;PNPT1;CNOT8;PSME4;TNFS...        FHL2  FHL2_AP
 2036  AGO4;INTS5;INTS4;DIS3;UTP14A;UTP6;DROSHA;INTS1...        FHL2  FHL2_AP

      Direction
 0           Up
 1           Up
 2         Down
 3         Down
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                   response to peptide (GO:1901652)  0.7864
 1     prerank  positive regulation of chemokine production (G...  0.6640
 2     prerank    regulation of chemokine production (GO:0032642)  0.6999
 3     prerank  regulation of cardiac muscle contraction (GO:0...  0.6847
 4     prerank  positive regulation of interleukin-8 productio...  0.5860
 ...       ...                                                ...     ...
 2032  prerank  DNA-templated transcription, elongation (GO:00... -0.1224
 2033  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1216
 2034  prerank  regulation of G2/M transition of mitotic cell ... -0.1116
 2035  prerank  regulation of transcription from RNA polymeras... -0.0984
 2036  prerank  negative regulation of mitotic cell cycle phas... -0.0992

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9846    0.0000    0.1415     0.1010    5/19   2.08%
 1     1.8137    0.0000    0.6838     0.6250    5/24   3.27%
 2     1.7598    0.0031    0.8538     0.8300    6/17   9.51%
 3     1.7170    0.0032    0.9945     0.9320    4/16   4.65%
 4     1.7010    0.0039    0.9271     0.9520    4/32   3.27%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2045    1.0000    1.0000     1.0000   23/65  40.05%
 2033 -0.2023    1.0000    1.0000     1.0000  69/260  34.48%
 2034 -0.1863    1.0000    1.0000     1.0000  33/136  35.50%
 2035 -0.1648    1.0000    1.0000     1.0000   18/75  38.31%
 2036 -0.1645    1.0000    1.0000     1.0000   22/74  40.38%

                                              Lead_genes Target_Gene   Guide  \
 0                           ANXA1;STAT4;STAT5A;FYN;AGER         SET  SET_MP
 1                             CD74;TLR2;OAS1;AGER;F2RL1         SET  SET_MP
 2                      CD74;TLR2;AGER;F2RL1;SNAI2;HMOX1         SET  SET_MP
 3                              PDE4D;SCN5A;SMAD7;RNF207         SET  SET_MP
 4                               CD74;AFAP1L2;TLR2;F2RL1         SET  SET_MP
 ...                                                 ...         ...     ...
 2032  EAF2;ELL;GTF2F2;POLR2B;CDK7;ELP2;CCNH;GTF2H1;S...         SET  SET_MP
 2033  PRPF40B;CACTIN;DHX35;TFIP11;METTL14;DDX20;USP4...         SET  SET_MP
 2034  PINX1;DTL;PSME4;PSMB9;ALMS1;CEP72;STOX1;MECP2;...         SET  SET_MP
 2035  PSME4;PSMB9;ATF3;STOX1;INO80;EP300;LIMD1;PSMC2...         SET  SET_MP
 2036  PINX1;PSME4;PSMB9;KLF4;DCUN1D3;RBL2;CDKN2A;PSM...         SET  SET_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  cellular response to amino acid stimulus (GO:0...  0.7105
 1     prerank  regulation of endopeptidase activity (GO:0052548)  0.6700
 2     prerank                response to amino acid (GO:0043200)  0.6842
 3     prerank  regulation of fatty acid biosynthetic process ...  0.6842
 4     prerank  regulation of stem cell population maintenance... -0.9193
 ...       ...                                                ...     ...
 2032  prerank         regulation of mRNA processing (GO:0050684) -0.1308
 2033  prerank                rRNA metabolic process (GO:0016072) -0.1234
 2034  prerank  regulation of cellular response to stress (GO:... -0.1089
 2035  prerank                   ribosome biogenesis (GO:0042254) -0.1058
 2036  prerank                       rRNA processing (GO:0006364) -0.0886

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8892    0.0028    0.3912     0.2630    7/26   4.50%
 1     1.8226    0.0000    0.5614     0.5580    7/31   2.43%
 2     1.7392    0.0075    1.0000     0.8950    6/22   4.94%
 3     1.7060    0.0026    1.0000     0.9530    7/20  11.40%
 4    -1.6921    0.0421    1.0000     0.7210    1/15   0.16%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2299    1.0000    1.0000     1.0000   33/33  86.96%
 2033 -0.2141    1.0000    1.0000     1.0000  41/150  34.69%
 2034 -0.1900    1.0000    1.0000     1.0000  19/104  25.26%
 2035 -0.1844    1.0000    1.0000     1.0000  44/181  34.69%
 2036 -0.1543    1.0000    1.0000     1.0000  44/165  34.69%

                                              Lead_genes Target_Gene   Guide  \
 0             SESN3;RRAGD;FYN;CPEB3;CAPN2;SLC38A9;RRAGB         SET  SET_AP
 1     BIRC3;SERPINA1;SERPINB9;SERPINE2;SERPINI1;PSMB...         SET  SET_AP
 2                 RRAGD;CPEB3;CAPN2;SLC38A9;RRAGB;GRIN1         SET  SET_AP
 3        MLXIPL;SLC45A3;PRKAA2;WDTC1;ERLIN1;APOC1;NR1H3         SET  SET_AP
 4                                                 HMGA2         SET  SET_AP
 ...                                                 ...         ...     ...
 2032  KHDRBS3;CDK11A;RBM23;SRSF10;PABPN1;YTHDC1;SAFB...         SET  SET_AP
 2033  HEATR1;HELQ;DIS3;NOC4L;UTP3;DDX47;DDX49;SBDS;E...         SET  SET_AP
 2034  PINK1;DYRK3;MBTPS2;ING2;CAMK2B;CAMK2G;ARNTL;CA...         SET  SET_AP
 2035  URB2;METTL17;HEATR1;HELQ;DIS3;NOC4L;PAK1IP1;ZN...         SET  SET_AP
 2036  HEATR1;HELQ;DIS3;NOC4L;UTP3;DDX47;DDX49;SBDS;E...         SET  SET_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of pri-miRNA transcription...  0.6926
 1     prerank  SRP-dependent cotranslational protein targetin...  0.5178
 2     prerank               cytoplasmic translation (GO:0002181)  0.5062
 3     prerank  cotranslational protein targeting to membrane ...  0.5036
 4     prerank  cellular response to amino acid stimulus (GO:0...  0.6443
 ...       ...                                                ...     ...
 2032  prerank  regulation of endoplasmic reticulum stress-ind... -0.1341
 2033  prerank          COPII-coated vesicle budding (GO:0090114) -0.1313
 2034  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1300
 2035  prerank  transcription elongation from RNA polymerase I... -0.1262
 2036  prerank                       rRNA processing (GO:0006364) -0.1136

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     2.0634    0.0000    0.0627     0.0560    11/25  15.12%
 1     1.9976    0.0000    0.0935     0.1540    65/89  33.41%
 2     1.9281    0.0000    0.1567     0.3300    66/92  33.41%
 3     1.9227    0.0000    0.1264     0.3460    66/92  33.41%
 4     1.8891    0.0034    0.1496     0.4520    10/26  11.87%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2416    1.0000    1.0000     1.0000     4/17  28.95%
 2033 -0.2320    1.0000    1.0000     1.0000     6/64  15.67%
 2034 -0.2292    1.0000    1.0000     1.0000    52/52  87.06%
 2035 -0.2278    1.0000    1.0000     1.0000    26/63  41.47%
 2036 -0.2043    1.0000    1.0000     1.0000  165/165  88.80%

                                              Lead_genes Target_Gene  \
 0     FOSL1;TERT;TGFB2;ATOH8;NGFR;FOS;KLF4;PDGFB;GAT...     MYBBP1A
 1     RPS19;RPS6;RPL24;RPL28;RPL34;RPL13A;RPS15A;RPS...     MYBBP1A
 2     RPS19;RPS6;RPL24;RPL28;RPL34;RPL13A;RPS15A;RPS...     MYBBP1A
 3     RPS19;RPS6;RPL24;RPL28;RPL34;RPL13A;RPS15A;RPS...     MYBBP1A
 4     SESN3;SESN1;SESN2;CPEB4;CAPN2;RRAGB;RPTOR;CPEB...     MYBBP1A
 ...                                                 ...         ...
 2032                        TXNDC12;EIF2AK3;BOK;HERPUD1     MYBBP1A
 2033             FOLR1;CTSC;ANKRD28;SEC24B;SEC23IP;AREG     MYBBP1A
 2034  MRTO4;RRS1;PES1;NIP7;NOC2L;WDR12;NOP16;EBNA1BP...     MYBBP1A
 2035  GTF2H4;GTF2H2;NELFE;CCNT1;POLR2F;SSRP1;SUPT16H...     MYBBP1A
 2036  ERI1;UTP14A;MRTO4;EXOSC10;PELP1;TBL3;DDX10;NOL...     MYBBP1A

            Guide Direction
 0     MYBBP1A_MP        Up
 1     MYBBP1A_MP        Up
 2     MYBBP1A_MP        Up
 3     MYBBP1A_MP        Up
 4     MYBBP1A_MP        Up
 ...          ...       ...
 2032  MYBBP1A_MP      Down
 2033  MYBBP1A_MP      Down
 2034  MYBBP1A_MP      Down
 2035  MYBBP1A_MP      Down
 2036  MYBBP1A_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of ATP metabolic process (...  0.6421
 1     prerank  cellular polysaccharide biosynthetic process (...  0.6738
 2     prerank    Golgi to plasma membrane transport (GO:0006893)  0.4994
 3     prerank  positive regulation of carbohydrate metabolic ...  0.6532
 4     prerank  negative regulation of cell-substrate adhesion...  0.5586
 ...       ...                                                ...     ...
 2032  prerank  regulation of transcription from RNA polymeras... -0.1429
 2033  prerank          substantia nigra development (GO:0021762) -0.1419
 2034  prerank  signal transduction in response to DNA damage ... -0.1415
 2035  prerank          regulation of mRNA stability (GO:0043488) -0.1274
 2036  prerank                 protein deacetylation (GO:0006476) -0.1290

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8333    0.0027    1.0000     0.6630   12/20  24.53%
 1     1.7941    0.0052    1.0000     0.8110    9/16  19.86%
 2     1.7352    0.0044    1.0000     0.9490   22/42  26.86%
 3     1.7331    0.0099    1.0000     0.9500    9/15  22.24%
 4     1.7223    0.0033    1.0000     0.9610   16/27  27.49%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2406    1.0000    1.0000     1.0000   33/65  38.87%
 2033 -0.2366    1.0000    1.0000     1.0000    9/32  28.51%
 2034 -0.2334    1.0000    1.0000     1.0000   13/46  26.26%
 2035 -0.2203    1.0000    1.0000     1.0000  31/128  29.29%
 2036 -0.2133    0.9974    0.9999     1.0000    3/41   9.88%

                                              Lead_genes Target_Gene  \
 0     MLXIPL;PPARGC1A;PFKFB2;PFKFB4;PSEN1;VCP;APP;PF...     MYBBP1A
 1     B3GALT2;B3GNT8;FUT9;EXT1;B3GNT3;CSGALNACT1;EXT...     MYBBP1A
 2     OPTN;BBS2;EXOC8;OSBPL5;ARFGEF2;KIF13A;BLZF1;CC...     MYBBP1A
 3     MLXIPL;PFKFB2;PFKFB4;PSEN1;APP;PFKFB3;PRKAA2;P...     MYBBP1A
 4     GBP1;ACTN4;CORO1C;ACER2;THBS1;GCNT2;RCC2;DMTN;...     MYBBP1A
 ...                                                 ...         ...
 2032  PSMB10;EGLN1;PSMD9;PSMB4;LIMD1;PSMC6;RBX1;STOX...     MYBBP1A
 2033  NDRG2;CKB;SYNGR3;SUDS3;NDUFS3;RAD1;MAPKAP1;SIR...     MYBBP1A
 2034  RAD9A;CASP9;E2F1;DONSON;TRIAP1;MAD2L2;BATF;CHE...     MYBBP1A
 2035  TNFSF13;PCBP4;PSMB10;SLC11A1;PSMD9;E2F1;FASTKD...     MYBBP1A
 2036                                  SIRT4;SIRT6;MIER2     MYBBP1A

            Guide Direction
 0     MYBBP1A_AP        Up
 1     MYBBP1A_AP        Up
 2     MYBBP1A_AP        Up
 3     MYBBP1A_AP        Up
 4     MYBBP1A_AP        Up
 ...          ...       ...
 2032  MYBBP1A_AP      Down
 2033  MYBBP1A_AP      Down
 2034  MYBBP1A_AP      Down
 2035  MYBBP1A_AP      Down
 2036  MYBBP1A_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                    lipid modification (GO:0030258)  0.7953
 1     prerank  positive regulation of fibroblast proliferatio...  0.6995
 2     prerank                   RNA destabilization (GO:0050779)  0.6958
 3     prerank  positive regulation of glucose import (GO:0046...  0.6670
 4     prerank          regulation of glucose import (GO:0046324)  0.6157
 ...       ...                                                ...     ...
 2032  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1125
 2033  prerank                       rRNA processing (GO:0006364) -0.1113
 2034  prerank                       gene expression (GO:0010467) -0.1111
 2035  prerank  regulation of stem cell differentiation (GO:20... -0.1048
 2036  prerank  DNA-templated transcription, elongation (GO:00... -0.0942

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.9624    0.0000    0.1553     0.1340     3/16   3.01%
 1     1.7752    0.0000    0.9639     0.7710     6/18  11.11%
 2     1.7036    0.0082    1.0000     0.9650     5/16  16.20%
 3     1.6938    0.0134    1.0000     0.9720     3/17   4.39%
 4     1.6838    0.0062    1.0000     0.9790     8/24  14.78%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1875    1.0000    1.0000     1.0000   31/112  35.08%
 2033 -0.1831    1.0000    1.0000     1.0000  161/165  80.57%
 2034 -0.1803    1.0000    1.0000     1.0000   33/324  22.91%
 2035 -0.1703    1.0000    1.0000     1.0000    28/71  42.27%
 2036 -0.1530    1.0000    1.0000     1.0000    63/65  81.44%

                                              Lead_genes Target_Gene    Guide  \
 0                                     DGKG;CYP3A5;SGPP1        CUX1  CUX1_MP
 1                         PDGFC;DDR2;CD74;LIG4;FN1;CDK6        CUX1  CUX1_MP
 2                        MEX3D;METTL16;RBM24;DXO;YTHDF3        CUX1  CUX1_MP
 3                                  SORBS1;CLTCL1;CAPN10        CUX1  CUX1_MP
 4       SORBS1;CLTCL1;CAPN10;APPL2;GSK3A;IRS1;IRS2;RTN2        CUX1  CUX1_MP
 ...                                                 ...         ...      ...
 2032  SAMD4A;PCBP4;GTPBP1;UPF1;PSMD5;ZC3H14;HNRNPD;P...        CUX1  CUX1_MP
 2033  DDX47;MDN1;DDX10;FCF1;SENP3;NOL8;LSM6;LAS1L;RR...        CUX1  CUX1_MP
 2034  NOVA1;U2AF1;GALNT2;HHEX;SYMPK;DEDD2;MRPS17;U2A...        CUX1  CUX1_MP
 2035  SMYD5;LMO1;PSMD5;NOTCH1;PSME4;EIF2AK2;PSMB9;PS...        CUX1  CUX1_MP
 2036  GTF2H4;LEO1;CDK7;PCID2;GTF2F1;POLR2B;SUPT6H;CT...        CUX1  CUX1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  adenylate cyclase-modulating G protein-coupled...  0.6799
 1     prerank                    glycolytic process (GO:0006096)  0.7341
 2     prerank  regulation of sprouting angiogenesis (GO:1903670)  0.6999
 3     prerank  positive regulation of fibroblast proliferatio...  0.7432
 4     prerank  negative regulation of endothelial cell migrat...  0.7094
 ...       ...                                                ...     ...
 2032  prerank   mitotic nuclear membrane reassembly (GO:0007084) -0.1310
 2033  prerank  regulation of G2/M transition of mitotic cell ... -0.1197
 2034  prerank  establishment of protein localization to mitoc... -0.1146
 2035  prerank  transcription-coupled nucleotide-excision repa... -0.1104
 2036  prerank    positive regulation of translation (GO:0045727) -0.0917

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.0318    0.0000    0.0263     0.0210   13/40   7.52%
 1     1.8346    0.0000    0.4679     0.4680    6/20   7.48%
 2     1.8342    0.0000    0.3140     0.4700    7/24   7.24%
 3     1.8199    0.0000    0.2778     0.5340    3/18   1.07%
 4     1.7913    0.0000    0.3267     0.6700    6/20   7.33%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2110    1.0000    1.0000     1.0000   18/51  34.67%
 2033 -0.1985    1.0000    1.0000     1.0000  27/136  27.05%
 2034 -0.1855    1.0000    1.0000     1.0000   12/45  33.31%
 2035 -0.1814    1.0000    1.0000     1.0000    5/73  11.67%
 2036 -0.1504    1.0000    1.0000     1.0000   24/82  34.38%

                                              Lead_genes Target_Gene    Guide  \
 0     S1PR2;GNAO1;PTGER2;ADRA2A;GRK5;PTHLH;HTR1D;GNA...        CUX1  CUX1_AP
 1                      ENO4;PFKFB2;PGAM4;ENO2;ENO3;PFKM        CUX1  CUX1_AP
 2        SEMA6A;CREB3L1;ITGA5;BMPER;FGF18;SMAD1;ADAMTS9        CUX1  CUX1_AP
 3                                       CD74;PDGFC;DDR2        CUX1  CUX1_AP
 4                 SLIT2;DAB2IP;APOE;DLL4;ADAMTS9;ATP2B4        CUX1  CUX1_AP
 ...                                                 ...         ...      ...
 2032  CHMP7;NUP43;LBR;NUP155;NUP107;CDK1;CHMP4A;VPS4...        CUX1  CUX1_AP
 2033  CNTRL;NDE1;CEP152;HAUS3;CEP164;CEP135;CDK5RAP2...        CUX1  CUX1_AP
 2034  TSPO;MFN2;TIMM23B;HK1;TIMM50;DNAJC15;AIP;TIMM2...        CUX1  CUX1_AP
 2035                      POLD3;ERCC8;CCNH;POLR2B;ERCC4        CUX1  CUX1_AP
 2036  CPEB3;POLDIP3;HABP4;FASTKD3;SAMD4A;ELAVL1;EIF5...        CUX1  CUX1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of protein transport (GO:0...  0.7114
 1     prerank  positive regulation of release of cytochrome c...  0.6500
 2     prerank  positive regulation of phosphatidylinositol 3-...  0.5674
 3     prerank  negative regulation of protein secretion (GO:0...  0.6344
 4     prerank  activation of protein kinase B activity (GO:00...  0.6685
 ...       ...                                                ...     ...
 2032  prerank  interleukin-1-mediated signaling pathway (GO:0... -0.1300
 2033  prerank  regulation of stem cell differentiation (GO:20... -0.1226
 2034  prerank  RNA splicing, via transesterification reaction... -0.1052
 2035  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.0978
 2036  prerank                rRNA metabolic process (GO:0016072) -0.0877

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.7777    0.0059    1.0000     0.7860     3/17   5.25%
 1     1.7397    0.0061    1.0000     0.9110     7/24   9.58%
 2     1.7120    0.0000    1.0000     0.9520    16/40  12.10%
 3     1.6989    0.0166    1.0000     0.9680     5/23   5.25%
 4     1.6977    0.0029    0.9515     0.9690     2/20   0.98%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2085    1.0000    1.0000     1.0000     2/80   5.70%
 2033 -0.1994    1.0000    1.0000     1.0000    71/71  87.82%
 2034 -0.1721    1.0000    1.0000     1.0000   92/239  40.06%
 2035 -0.1596    1.0000    1.0000     1.0000   98/260  39.89%
 2036 -0.1424    1.0000    1.0000     1.0000  150/150  91.35%

                                              Lead_genes Target_Gene   Guide  \
 0                                       PKDCC;APOE;DRD2         NBN  NBN_MP
 1                 HRK;GPER1;BMF;MOAP1;PLAUR;BBC3;MLLT11         NBN  NBN_MP
 2     NTRK3;LYN;PIK3CD;FLT1;PDGFC;GPER1;NTRK2;NKX3-1...         NBN  NBN_MP
 3                     APOE;KCNJ11;ADRA2A;RAB11FIP5;DRD2         NBN  NBN_MP
 4                                          NTRK3;ADRA2A         NBN  NBN_MP
 ...                                                 ...         ...     ...
 2032                                         NOD1;TRAF6         NBN  NBN_MP
 2033  SMYD5;SETD1A;EIF2AK2;PSMD5;PSMB10;NELFB;MYB;PS...         NBN  NBN_MP
 2034  USP49;DDX39B;PPWD1;PPIL3;CWC25;ELAVL2;PRPF4;CS...         NBN  NBN_MP
 2035  USP49;DDX39B;PPWD1;PPIL3;CWC25;ELAVL2;PRPF4;CS...         NBN  NBN_MP
 2036  EMG1;HEATR1;XRN1;TEX10;DEDD2;DDX47;WDR75;UTP14...         NBN  NBN_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank              carbohydrate homeostasis (GO:0033500)  0.6332
 1     prerank   regulation of macrophage activation (GO:0043030)  0.7985
 2     prerank  negative regulation of protein tyrosine kinase...  0.7284
 3     prerank  positive regulation of signaling receptor acti...  0.6979
 4     prerank  negative regulation of signaling receptor acti...  0.7439
 ...       ...                                                ...     ...
 2032  prerank  protein localization to Golgi apparatus (GO:00... -0.1295
 2033  prerank          response to unfolded protein (GO:0006986) -0.1311
 2034  prerank  regulation of cellular response to stress (GO:... -0.1295
 2035  prerank                        nuclear export (GO:0051168) -0.1284
 2036  prerank          peptide biosynthetic process (GO:0043043) -0.1013

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9304    0.0000    0.2877     0.1800   13/38  12.57%
 1     1.9202    0.0029    0.1732     0.2120    5/16   6.60%
 2     1.8868    0.0000    0.1906     0.3310    4/20   1.40%
 3     1.8686    0.0000    0.1858     0.4000    4/24   2.36%
 4     1.8378    0.0000    0.2248     0.5430    2/17   0.41%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2133    1.0000    1.0000     1.0000    4/23  25.56%
 2033 -0.2113    1.0000    1.0000     1.0000    3/43  12.82%
 2034 -0.2086    1.0000    1.0000     1.0000  27/104  32.95%
 2035 -0.2043    1.0000    1.0000     1.0000   16/76  29.31%
 2036 -0.1615    1.0000    1.0000     1.0000  18/138  31.45%

                                              Lead_genes Target_Gene   Guide  \
 0     OAS1;ADRA2A;MLXIPL;NGFR;LEPR;FFAR2;CRY2;PTPN2;...         NBN  NBN_AP
 1                     CD74;FCGR2B;PLA2G10;NR1H3;GPR137B         NBN  NBN_AP
 2                                 CAV1;CBLC;SRCIN1;PTK6         NBN  NBN_AP
 3                                  HFE;HBEGF;ARC;ADRA2A         NBN  NBN_AP
 4                                              HFE;CBLC         NBN  NBN_AP
 ...                                                 ...         ...     ...
 2032                              OPTN;RAB33B;SORL1;GAK         NBN  NBN_AP
 2033                                 OPTN;RHBDD1;DNAJB4         NBN  NBN_AP
 2034  NEK6;NPAS2;NUAK1;NUPR1;NUP210;NUP37;NUP107;NUP...         NBN  NBN_AP
 2035  SARNP;RANBP17;XPO7;NUP214;POLDIP3;DHX38;NCBP1;...         NBN  NBN_AP
 2036  GGT6;GGT1;SRBD1;HBS1L;YARS2;FARSB;RRBP1;IGHMBP...         NBN  NBN_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of T cell activation (GO:0...  0.7508
 1     prerank  positive regulation of T cell proliferation (G...  0.6885
 2     prerank  negative regulation of proteolysis involved in...  0.7438
 3     prerank                 transferrin transport (GO:0033572)  0.6536
 4     prerank                    iron ion transport (GO:0006826)  0.6078
 ...       ...                                                ...     ...
 2032  prerank                       mRNA processing (GO:0006397) -0.1189
 2033  prerank               mitochondrial transport (GO:0006839) -0.1102
 2034  prerank  regulation of apoptotic signaling pathway (GO:... -0.0972
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0983
 2036  prerank  ribonucleoprotein complex biogenesis (GO:0022613) -0.0996

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     2.1311    0.0000    0.0056     0.0050     5/29   0.84%
 1     1.9523    0.0000    0.0795     0.1150     5/27   0.84%
 2     1.9521    0.0000    0.0537     0.1170     3/22   1.80%
 3     1.9420    0.0000    0.0492     0.1440     6/29  12.12%
 4     1.8916    0.0000    0.0851     0.2790     9/37  13.11%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1960    1.0000    1.0000     1.0000   23/284  16.93%
 2033 -0.1847    1.0000    1.0000     1.0000     7/51  23.37%
 2034 -0.1643    1.0000    1.0000     1.0000     2/29  16.21%
 2035 -0.1623    1.0000    1.0000     1.0000  159/160  87.94%
 2036 -0.1622    1.0000    1.0000     1.0000     9/58  28.53%

                                              Lead_genes Target_Gene    Guide  \
 0                            ANXA1;IL15;CCR7;IL23A;JAK3        CALR  CALR_MP
 1                            ANXA1;IL15;IL23A;AGER;JAK3        CALR  CALR_MP
 2                                      HFE;QRICH2;EPHA4        CALR  CALR_MP
 3        HFE;ATP6V1B1;ATP6V0A4;STEAP3;ATP6V1B2;ATP6V0A1        CALR  CALR_MP
 4     HFE;ATP6V1B1;ATP6V0A4;STEAP3;ATP6V1B2;TTYH1;AB...        CALR  CALR_MP
 ...                                                 ...         ...      ...
 2032  ELAVL2;CACTIN;CMTR1;RNPC3;SNIP1;CWF19L1;ZCCHC8...        CALR  CALR_MP
 2033          GDAP1;PITRM1;TSPO;ABCB10;BCS1L;TIMM44;MFF        CALR  CALR_MP
 2034                                         SGMS1;ING5        CALR  CALR_MP
 2035  HELZ2;SAMD4A;CTIF;PARN;TNKS1BP1;CNOT6;SMG8;CNO...        CALR  CALR_MP
 2036  URB2;WDR12;CUL4B;NAF1;LTV1;CUL4A;METTL17;BOP1;...        CALR  CALR_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                B cell differentiation (GO:0030183)  0.5703
 1     prerank                  DNA geometric change (GO:0032392)  0.5843
 2     prerank                   response to peptide (GO:1901652)  0.6255
 3     prerank  regulation of regulatory T cell differentiatio... -0.9276
 4     prerank  regulation of chondrocyte differentiation (GO:... -0.9594
 ...       ...                                                ...     ...
 2032  prerank                       rRNA processing (GO:0006364) -0.1159
 2033  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1168
 2034  prerank  interleukin-1-mediated signaling pathway (GO:0... -0.1101
 2035  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1077
 2036  prerank         Fc receptor signaling pathway (GO:0038093) -0.0955

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7024    0.0102    1.0000     0.9650    6/28   3.04%
 1     1.6990    0.0132    1.0000     0.9700    7/25   8.87%
 2     1.6685    0.0205    1.0000     0.9860    8/19  10.85%
 3    -1.6678    0.0198    0.5277     0.3980    3/17   0.82%
 4    -1.6669    0.0000    0.2752     0.4080    5/18   0.75%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1977    1.0000    1.0000     1.0000  78/165  40.09%
 2033 -0.1975    1.0000    1.0000     1.0000  52/260  26.46%
 2034 -0.1843    1.0000    1.0000     1.0000   23/80  34.48%
 2035 -0.1836    1.0000    1.0000     1.0000  57/121  42.36%
 2036 -0.1608    1.0000    1.0000     1.0000   23/93  33.76%

                                              Lead_genes Target_Gene    Guide  \
 0                   JAK3;NHEJ1;CD79A;ADAM17;DNAJB9;IL11        CALR  CALR_AP
 1             ANXA1;ZRANB3;POT1;RECQL5;RTEL1;DNA2;DDX11        CALR  CALR_AP
 2      ANXA1;STAT5A;IRF5;STAT4;STAT2;PRNP;EIF2B2;EIF2B1        CALR  CALR_AP
 3                                     IL4I1;FOXP3;HLA-G        CALR  CALR_AP
 4                         SOX6;PKDCC;GREM1;SNAI2;NKX3-2        CALR  CALR_AP
 ...                                                 ...         ...      ...
 2032  DDX47;SENP3;LSM6;PES1;RPF1;WDR75;EXOSC6;RPS28;...        CALR  CALR_AP
 2033  U2AF1;NOVA1;GEMIN2;PRPF40B;ELAVL2;SNRNP48;DHX3...        CALR  CALR_AP
 2034  NOD1;TAB3;PSMF1;PSMD9;PSMA3;PSMD10;PSMB4;BTRC;...        CALR  CALR_AP
 2035  GEMIN2;PPAN;ISY1;YTHDC1;DHX29;XAB2;CPSF6;NOL3;...        CALR  CALR_AP
 2036  TAB3;LAT;VAV3;PSMF1;PSMD9;PSMA3;PSMD10;PSMB4;B...        CALR  CALR_AP

      Direction
 0           Up
 1           Up
 2           Up
 3         Down
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of lipid biosynthetic process (GO:0...  0.7045
 1     prerank                        axon extension (GO:0048675)  0.7138
 2     prerank        regulation of neuron migration (GO:2001222)  0.6723
 3     prerank  positive regulation of fat cell differentiatio...  0.5814
 4     prerank  regulation of cardiac muscle contraction (GO:0... -0.9453
 ...       ...                                                ...     ...
 2032  prerank      aerobic electron transport chain (GO:0019646) -0.1155
 2033  prerank  mitochondrial ATP synthesis coupled electron t... -0.1149
 2034  prerank  negative regulation of G2/M transition of mito... -0.1140
 2035  prerank  RNA splicing, via transesterification reaction... -0.1114
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1103

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8057    0.0000    1.0000     0.6340    4/19   1.31%
 1     1.7519    0.0054    1.0000     0.8300    7/17  17.08%
 2     1.7173    0.0028    1.0000     0.9380    7/18  15.08%
 3     1.6653    0.0077    1.0000     0.9880    5/33   7.61%
 4    -1.6381    0.0048    0.5834     0.3950    2/16   0.99%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1845    1.0000    1.0000     1.0000    1/64   3.65%
 2033 -0.1845    1.0000    1.0000     1.0000    1/65   3.65%
 2034 -0.1843    1.0000    1.0000     1.0000   18/56  38.35%
 2035 -0.1828    1.0000    1.0000     1.0000  23/239  18.99%
 2036 -0.1795    1.0000    1.0000     1.0000  34/121  37.27%

                                              Lead_genes Target_Gene   Guide  \
 0                             MLXIPL;PRKAA2;APOE;SORBS1         APP  APP_MP
 1                NRP2;SLIT2;ULK2;SLC9A6;ULK1;MAP1B;CDK5         APP  APP_MP
 2         COL3A1;NTNG1;SEMA6A;MDK;DAB2IP;ZNF609;PHACTR1         APP  APP_MP
 3                     BMP2;CCDC71L;ZNF385A;TRPM4;CREBL2         APP  APP_MP
 4                                            SCN5A;CHGA         APP  APP_MP
 ...                                                 ...         ...     ...
 2032                                             NDUFA9         APP  APP_MP
 2033                                             NDUFA9         APP  APP_MP
 2034  CHFR;INTS3;CDK5RAP3;PSME4;PSMD13;PSMC1;PSMB2;P...         APP  APP_MP
 2035  U2AF1;SART3;CLP1;SYMPK;PRPF4;RBM15;PRPF40B;U2A...         APP  APP_MP
 2036  SART3;CLP1;GEMIN2;NLE1;PPAN;DDX20;GEMIN4;GEMIN...         APP  APP_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank     peptidyl-tyrosine phosphorylation (GO:0018108)  0.5056
 1     prerank  adenylate cyclase-modulating G protein-coupled...  0.5308
 2     prerank        peptidyl-tyrosine modification (GO:0018212)  0.5107
 3     prerank            protein autoubiquitination (GO:0051865)  0.4776
 4     prerank  positive regulation of T cell proliferation (G...  0.5381
 ...       ...                                                ...     ...
 2032  prerank      cell cycle G2/M phase transition (GO:0044839) -0.1294
 2033  prerank  regulation of mitotic cell cycle phase transit... -0.1293
 2034  prerank                mRNA metabolic process (GO:0016071) -0.1208
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0997
 2036  prerank                      ncRNA processing (GO:0034470) -0.0852

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.6527    0.0087    1.0000     0.9780    8/44   5.14%
 1     1.6453    0.0083    1.0000     0.9820   12/40  10.68%
 2     1.6210    0.0219    1.0000     0.9930    7/39   5.14%
 3     1.5829    0.0118    1.0000     0.9970   12/51  14.00%
 4     1.5691    0.0402    1.0000     0.9990    7/27   5.19%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1940    1.0000    1.0000     1.0000  22/124  27.45%
 2033 -0.1918    1.0000    1.0000     1.0000  30/174  27.09%
 2034 -0.1820    1.0000    1.0000     1.0000   12/85  24.29%
 2035 -0.1474    1.0000    1.0000     1.0000  16/160  24.57%
 2036 -0.1261    1.0000    1.0000     1.0000  24/185  26.24%

                                              Lead_genes Target_Gene   Guide  \
 0                PKDCC;FES;JAK3;DDR2;IL15;EPHA4;LYN;FER         APP  APP_AP
 1     GNAO1;HTR1D;VIPR2;MC1R;PTGER2;ADRA2A;GRK5;HTR1...         APP  APP_AP
 2                     PKDCC;FES;JAK3;DDR2;EPHA4;LYN;FER         APP  APP_AP
 3     TRIM71;KLHL24;RNF157;TRIM52;RNF185;RNF141;RNF2...         APP  APP_AP
 4              ANXA1;JAK3;IGF2;IL23A;IL15;ICOSLG;IL27RA         APP  APP_AP
 ...                                                 ...         ...     ...
 2032  CEP41;FBXL22;FBXL17;PLK4;FBXL8;CLASP1;SDCCAG8;...         APP  APP_AP
 2033  CEP41;PLK4;CDC23;KNTC1;NEK11;CLASP1;SDCCAG8;CD...         APP  APP_AP
 2034  METTL16;ZNF473;U2AF1;NUDT12;CSTF3;PCBP3;USP39;...         APP  APP_AP
 2035  NBAS;XRN1;SAMD4A;CNOT1;TNKS1BP1;ZC3H12A;ZFP36;...         APP  APP_AP
 2036  DGCR8;UTP15;INTS7;UTP20;TEX10;RRP12;EMG1;WDR36...         APP  APP_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of cytokine-mediated signa... -0.9605
 1     prerank  positive regulation of potassium ion transport...  0.7661
 2     prerank  regulation of release of sequestered calcium i...  0.7137
 3     prerank  negative regulation of protein localization to... -0.9537
 4     prerank  positive regulation of small GTPase mediated s...  0.7486
 ...       ...                                                ...     ...
 2032  prerank  establishment of mitotic spindle localization ... -0.1304
 2033  prerank                rRNA metabolic process (GO:0016072) -0.1281
 2034  prerank    positive regulation of translation (GO:0045727) -0.1241
 2035  prerank  regulation of hematopoietic progenitor cell di... -0.1214
 2036  prerank  cellular macromolecule biosynthetic process (G... -0.0885

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0    -1.8450    0.0000    0.0068     0.0070    3/21   0.64%
 1     1.8208    0.0024    0.9471     0.5320    6/16   6.17%
 2     1.8025    0.0072    0.6254     0.6120    4/19   5.28%
 3    -1.7905    0.0034    0.2127     0.3260    1/15   0.71%
 4     1.7780    0.0045    0.5684     0.7190    6/17   7.43%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2407    1.0000    1.0000     1.0000    5/26  24.78%
 2033 -0.2324    1.0000    1.0000     1.0000  31/150  31.01%
 2034 -0.2228    1.0000    1.0000     1.0000   13/82  23.57%
 2035 -0.2175    1.0000    1.0000     1.0000   19/63  33.32%
 2036 -0.1633    1.0000    1.0000     1.0000  50/289  26.50%

                                              Lead_genes Target_Gene     Guide  \
 0                                       CD74;TRIM6;GFI1       STAT3  STAT3_MP
 1              KCNN2;GABBR2;ADRA2A;KCNMB3;KCNMB4;AMIGO1       STAT3  STAT3_MP
 2                            LIME1;PDE4D;UBASH3B;CAMK2D       STAT3  STAT3_MP
 3                                                 CABP1       STAT3  STAT3_MP
 4                   RASGRF1;LYN;RASGRP1;IRS2;SHOC2;EPOR       STAT3  STAT3_MP
 ...                                                 ...         ...       ...
 2032                   ESPL1;UBXN2B;CLASP1;SPDL1;NSFL1C       STAT3  STAT3_MP
 2033  NVL;UTP15;DDX47;EXOSC9;EXOSC2;TBL3;SENP3;WDR75...       STAT3  STAT3_MP
 2034  EIF5AL1;POLDIP3;SAMD4A;PLD1;JMJD4;YTHDF3;PCIF1...       STAT3  STAT3_MP
 2035  LMO1;PSMC2;PSME4;EIF2AK2;SETD1A;MYB;PSMB3;PSMC...       STAT3  STAT3_MP
 2036  MCM8;HELB;TREX1;APOE;FAM111B;RAD9A;HARS2;DONSO...       STAT3  STAT3_MP

      Direction
 0         Down
 1           Up
 2           Up
 3         Down
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of peptidyl-serine phospho...  0.7454
 1     prerank  regulation of cardiac muscle contraction (GO:0...  0.7612
 2     prerank    regulation of sodium ion transport (GO:0002028)  0.6765
 3     prerank  positive regulation of wound healing (GO:0090303)  0.6457
 4     prerank                granulocyte chemotaxis (GO:0071621)  0.6879
 ...       ...                                                ...     ...
 2032  prerank      pre-replicative complex assembly (GO:0036388) -0.1372
 2033  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1305
 2034  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1261
 2035  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1134
 2036  prerank  regulation of cell cycle phase transition (GO:... -0.1108

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8557    0.0060    0.8618     0.4430     5/17   3.29%
 1     1.8223    0.0056    0.6834     0.5800     4/16   3.29%
 2     1.8018    0.0000    0.5938     0.6800     7/24   9.69%
 3     1.7793    0.0066    0.5791     0.7620     4/25   1.13%
 4     1.7423    0.0091    0.6934     0.8900     7/18   6.39%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2268    1.0000    1.0000     1.0000    57/59  74.71%
 2033 -0.2212    1.0000    1.0000     1.0000   23/160  27.86%
 2034 -0.2118    1.0000    1.0000     1.0000  112/112  87.52%
 2035 -0.1910    1.0000    1.0000     1.0000   28/121  33.80%
 2036 -0.1859    1.0000    1.0000     1.0000    17/85  33.16%

                                              Lead_genes Target_Gene     Guide  \
 0                        MLXIPL;INPP5J;CAV1;PDE4D;SMAD7       STAT3  STAT3_AP
 1                                CHGA;PDE4D;SCN5A;SMAD7       STAT3  STAT3_AP
 2             RANGRF;DRD2;SNTA1;SCN5A;PER1;NEDD4;SPTBN4       STAT3  STAT3_AP
 3                              ANXA1;HPSE;FERMT1;ADRA2A       STAT3  STAT3_AP
 4            ANXA1;CXADR;S100A8;S100A9;TGFB2;ITGB2;EDN1       STAT3  STAT3_AP
 ...                                                 ...         ...       ...
 2032  PSMB9;ORC3;ORC5;ORC1;PSMD7;PSMD1;MCM3;PSMD5;CD...       STAT3  STAT3_AP
 2033  CNOT6L;MTPAP;CASC3;SMG5;TUT1;CTIF;DCP1A;PELO;S...       STAT3  STAT3_AP
 2034  PCBP4;PSMB9;PCID2;DCP1A;YTHDF1;MOV10;IGF2BP2;M...       STAT3  STAT3_AP
 2035  SMN1;SETX;SART1;PRMT7;PPAN;SART3;NAF1;SRSF10;G...       STAT3  STAT3_AP
 2036  FZR1;PSMB9;CDC26;CDC23;ANAPC10;ANAPC4;CDC16;ER...       STAT3  STAT3_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of fibroblast growth factor recepto...  0.8103
 1     prerank  regulation of T cell differentiation (GO:0045580)  0.7269
 2     prerank              phagocytosis, engulfment (GO:0006911)  0.6808
 3     prerank  positive regulation of glucose transmembrane t...  0.6698
 4     prerank  negative regulation of I-kappaB kinase/NF-kapp...  0.6203
 ...       ...                                                ...     ...
 2032  prerank                           translation (GO:0006412) -0.1320
 2033  prerank           spliceosomal snRNP assembly (GO:0000387) -0.1309
 2034  prerank              translational elongation (GO:0006414) -0.1194
 2035  prerank            regulation of RNA splicing (GO:0043484) -0.1120
 2036  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.0968

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8995    0.0000    0.3509     0.2240     6/15   5.41%
 1     1.8359    0.0000    0.4555     0.4670     6/20  11.26%
 2     1.7156    0.0094    1.0000     0.9500     8/20  11.26%
 3     1.7034    0.0103    1.0000     0.9680     3/21   3.66%
 4     1.6993    0.0106    1.0000     0.9740    12/30  14.51%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2305    1.0000    1.0000     1.0000   62/187  38.37%
 2033 -0.2275    1.0000    1.0000     1.0000    37/37  86.96%
 2034 -0.2082    1.0000    1.0000     1.0000   34/101  36.11%
 2035 -0.1905    1.0000    1.0000     1.0000     6/67  14.47%
 2036 -0.1681    1.0000    1.0000     1.0000  120/121  86.96%

                                              Lead_genes Target_Gene     Guide  \
 0                   SULF1;SPRY4;SPRY1;NOG;CREB3L1;SMOC2       CCND1  CCND1_MP
 1                     PRDM1;FOXP3;KAT2A;RUNX1;TCF7;RHOH       CCND1  CCND1_MP
 2       FCGR2B;BIN2;ITGB2;XKR6;RHOBTB1;XKR9;SH3BP1;RHOH       CCND1  CCND1_MP
 3                                   CLIP3;CLTCL1;SORBS1       CCND1  CCND1_MP
 4     MAPKBP1;NLRX1;PER1;PPM1N;RORA;NR1D1;TNFAIP3;OT...       CCND1  CCND1_MP
 ...                                                 ...         ...       ...
 2032  MRPS17;YARS2;FARS2;N6AMT1;QRSL1;LARS2;MARS2;DA...       CCND1  CCND1_MP
 2033  GEMIN7;TGS1;SART3;SNRPF;DDX20;SART1;SNRPB;GEMI...       CCND1  CCND1_MP
 2034  MRPS17;MRPL12;MRPL38;MRPS18A;ERAL1;PTCD3;MRPL1...       CCND1  CCND1_MP
 2035                CLK4;FASTK;RRP1B;MBNL2;YTHDC1;MBNL3       CCND1  CCND1_MP
 2036  CLP1;PRPF18;GEMIN7;YTHDC1;ERAL1;TGS1;BRIX1;SAR...       CCND1  CCND1_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank          regulation of glucose import (GO:0046324)  0.5502
 1     prerank  protein localization to chromosome, telomeric ...  0.6330
 2     prerank         nuclear membrane organization (GO:0071763)  0.5852
 3     prerank  regulation of extrinsic apoptotic signaling pa...  0.5876
 4     prerank  positive regulation of glucose import (GO:0046...  0.5829
 ...       ...                                                ...     ...
 2032  prerank  base-excision repair, AP site formation (GO:00... -0.2105
 2033  prerank  regulation of mitotic metaphase/anaphase trans... -0.2075
 2034  prerank  positive regulation of protein import (GO:1904... -0.2031
 2035  prerank               stress granule assembly (GO:0034063) -0.2026
 2036  prerank  nucleotide-excision repair, DNA gap filling (G... -0.1856

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.8386    0.0000    1.0000     0.2340   8/24  11.26%
 1     1.7559    0.0270    1.0000     0.4120   4/15   9.43%
 2     1.7412    0.0000    0.7957     0.4480  10/18  20.67%
 3     1.6683    0.0408    1.0000     0.6280   5/18   8.03%
 4     1.5525    0.0345    1.0000     0.8490   5/17  11.26%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2755    0.9979    1.0000     1.0000   3/17  24.37%
 2033 -0.2752    0.9990    1.0000     1.0000   8/25  34.16%
 2034 -0.2699    0.9990    1.0000     1.0000  15/27  42.46%
 2035 -0.2675    1.0000    0.9998     1.0000   6/20  36.27%
 2036 -0.2462    1.0000    0.9997     1.0000   2/24  16.76%

                                              Lead_genes Target_Gene     Guide  \
 0     SORBS1;CLTCL1;IRS2;GRB10;OSBPL8;GSK3A;PRKAG2;RHOQ       CCND1  CCND1_AP
 1                                  TERT;PINX1;TPP1;POT1       CCND1  CCND1_AP
 2     GPER1;TOR1AIP1;TMEM43;UBXN2B;TOR1A;TOR1B;NSFL1...       CCND1  CCND1_AP
 3                           SNAI2;TERT;UNC5B;MAPK7;EYA2       CCND1  CCND1_AP
 4                        SORBS1;CLTCL1;IRS2;OSBPL8;RHOQ       CCND1  CCND1_AP
 ...                                                 ...         ...       ...
 2032                                  NEIL3;TERF1;ERCC5       CCND1  CCND1_AP
 2033  RIOK2;ANAPC4;CDC23;DUSP1;CDC16;LCMT1;DLGAP5;CD...       CCND1  CCND1_AP
 2034  SMAD3;MAVS;RBM22;PSEN1;TGFB1;ZPR1;TPR;UBR5;PIK...       CCND1  CCND1_AP
 2035           OGFOD1;YTHDF3;ATXN2L;DDX3X;YTHDF1;YTHDF2       CCND1  CCND1_AP
 2036                                         POLK;XRCC1       CCND1  CCND1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of peptide hormone secretion (GO:00...  0.6651
 1     prerank  positive regulation of cellular component move...  0.7433
 2     prerank  glucose 6-phosphate metabolic process (GO:0051...  0.7149
 3     prerank  regulation of cardiac muscle cell action poten...  0.6981
 4     prerank  regulation of extrinsic apoptotic signaling pa...  0.6871
 ...       ...                                                ...     ...
 2032  prerank          peptide biosynthetic process (GO:0043043) -0.1168
 2033  prerank                  base-excision repair (GO:0006284) -0.1141
 2034  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1120
 2035  prerank                           translation (GO:0006412) -0.1107
 2036  prerank               mitochondrial transport (GO:0006839) -0.1107

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7760    0.0031    1.0000     0.7780   12/31  12.97%
 1     1.7564    0.0076    1.0000     0.8480    3/15   3.70%
 2     1.7342    0.0081    1.0000     0.9110    5/17  15.20%
 3     1.7283    0.0108    0.9523     0.9250    5/18   5.74%
 4     1.6851    0.0026    1.0000     0.9750    5/18   4.76%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1964    1.0000    1.0000     1.0000  16/138  25.46%
 2033 -0.1904    1.0000    1.0000     1.0000   14/46  37.60%
 2034 -0.1874    1.0000    1.0000     1.0000  26/260  20.10%
 2035 -0.1872    1.0000    1.0000     1.0000  23/187  25.53%
 2036 -0.1844    1.0000    1.0000     1.0000   50/51  81.60%

                                              Lead_genes Target_Gene     Guide  \
 0     KCNJ11;CACNA1C;ADRA2A;ABCC8;CACNA2D2;HFE;RAPGE...       STAG2  STAG2_MP
 1                                       LYN;TWIST1;CCR7       STAG2  STAG2_MP
 2                             PGM2L1;SHPK;H6PD;RPE;DERA       STAG2  STAG2_MP
 3                       CACNA1C;FGF13;RANGRF;CAV1;CXADR       STAG2  STAG2_MP
 4                           TERT;SNAI2;UNC5B;EYA2;MAPK7       STAG2  STAG2_MP
 ...                                                 ...         ...       ...
 2032  GGT7;MRPS18A;GGT6;HARS2;FARSB;MRPL27;RRBP1;GGT...       STAG2  STAG2_MP
 2033  ERCC6;NEIL2;POLG;NTHL1;POLB;USP47;ERCC5;TDG;RP...       STAG2  STAG2_MP
 2034  ELAVL2;NOVA1;ZCCHC8;MFAP1;DHX35;METTL14;AQR;SM...       STAG2  STAG2_MP
 2035  GTPBP2;MARS2;MRPS18A;QRSL1;SARS2;EEF2K;HARS2;F...       STAG2  STAG2_MP
 2036  GDAP1;TSPO;BCL2;FBXO7;FLVCR1;AIP;OXA1L;TOMM34;...       STAG2  STAG2_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of cation transmembrane transport (...  0.7290
 1     prerank           glutamate metabolic process (GO:0006536)  0.6933
 2     prerank         primary neural tube formation (GO:0014020)  0.6191
 3     prerank                      limb development (GO:0060173)  0.6792
 4     prerank  regulation of immune effector process (GO:0002... -0.9467
 ...       ...                                                ...     ...
 2032  prerank                   protein methylation (GO:0006479) -0.1500
 2033  prerank                rRNA metabolic process (GO:0016072) -0.1406
 2034  prerank    cellular protein catabolic process (GO:0044257) -0.1412
 2035  prerank  regulation of stem cell differentiation (GO:20... -0.1277
 2036  prerank                       rRNA processing (GO:0006364) -0.0963

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7368    0.0023    1.0000     0.8490    5/17   5.31%
 1     1.7217    0.0023    1.0000     0.8850    9/19  19.99%
 2     1.6750    0.0054    1.0000     0.9720    9/28  10.07%
 3     1.6626    0.0070    1.0000     0.9840    9/18  14.57%
 4    -1.6579    0.0053    0.0518     0.0530    4/16   1.71%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2411    1.0000    1.0000     1.0000    6/29  22.08%
 2033 -0.2353    1.0000    1.0000     1.0000  15/150  19.56%
 2034 -0.2293    1.0000    1.0000     1.0000    5/43  18.30%
 2035 -0.2081    1.0000    1.0000     1.0000    8/71  19.64%
 2036 -0.1613    1.0000    1.0000     1.0000  16/165  20.73%

                                              Lead_genes Target_Gene     Guide  \
 0                       KCNIP3;KCNH2;RANGRF;SCN5A;KCNN2       STAG2  STAG2_AP
 1      GLUD2;GAD1;GLS2;AADAT;OAT;ALDH18A1;GOT2;NAGS;GLS       STAG2  STAG2_AP
 2     PRICKLE1;SKI;MTHFR;DLC1;LRP2;TGFB2;CELSR1;TGFB...       STAG2  STAG2_AP
 3     PTCH1;MEGF8;GREM1;KREMEN2;NOG;BMPR1B;KREMEN1;I...       STAG2  STAG2_AP
 4                           HLA-DRA;C1R;FCGR2B;HLA-DRB1       STAG2  STAG2_AP
 ...                                                 ...         ...       ...
 2032                PRMT5;SNRPB;EHMT2;ICMT;FAM98A;LCMT1       STAG2  STAG2_AP
 2033  DDX47;NVL;EXOSC1;FCF1;WDR75;WDR12;MDN1;HEATR1;...       STAG2  STAG2_AP
 2034                          CTSK;CTSL;CTSV;MYLIP;RNF5       STAG2  STAG2_AP
 2035  LMO1;PUS7;NELFB;PSMD10;NOTCH1;RBM24;PSMD13;PSMD14       STAG2  STAG2_AP
 2036  DDX47;NVL;EXOSC1;FCF1;WDR75;WDR12;MDN1;HEATR1;...       STAG2  STAG2_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of calcium ion-dependent exocytosis...  0.7378
 1     prerank  hematopoietic progenitor cell differentiation ...  0.7199
 2     prerank  regulation of stem cell population maintenance... -0.9551
 3     prerank  positive regulation of peptidyl-lysine acetyla... -0.9388
 4     prerank  negative regulation of signaling receptor acti... -0.9432
 ...       ...                                                ...     ...
 2032  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1226
 2033  prerank                postreplication repair (GO:0006301) -0.1220
 2034  prerank  transcription elongation from RNA polymerase I... -0.1211
 2035  prerank  regulation of transcription from RNA polymeras... -0.1186
 2036  prerank  nucleotide-excision repair, DNA incision, 5&#39;-t... -0.0984

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7676    0.0025    1.0000     0.8000    7/15   9.64%
 1     1.7497    0.0074    1.0000     0.8620    5/16  10.21%
 2    -1.7175    0.0066    0.1458     0.1230    1/15   0.11%
 3    -1.6881    0.0016    0.4506     0.5160    2/18   0.97%
 4    -1.6874    0.0017    0.3089     0.5210    2/17   0.96%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2071    1.0000    1.0000     1.0000  10/160  14.74%
 2033 -0.2071    1.0000    1.0000     1.0000   41/41  87.85%
 2034 -0.2044    1.0000    1.0000     1.0000   16/63  28.07%
 2035 -0.2003    1.0000    1.0000     1.0000   21/65  36.52%
 2036 -0.1664    1.0000    1.0000     1.0000    9/37  31.44%

                                              Lead_genes Target_Gene  \
 0           ADRA2A;SYT17;SYT3;SYT8;CACNA1H;STX1A;SCAMP5     TPD52L1
 1                             FLT1;FLT3;FST;LMBR1L;FLT4     TPD52L1
 2                                                 HMGA2     TPD52L1
 3                                        FOXP3;PPARGC1A     TPD52L1
 4                                              HFE;CBLC     TPD52L1
 ...                                                 ...         ...
 2032  EXOSC10;HELZ2;MTPAP;SAMD4A;TUT1;SMG6;SMG1;PATL...     TPD52L1
 2033  DTL;USP43;POLI;PRIMPOL;POLH;POLK;ISG15;RFC4;UB...     TPD52L1
 2034  ERCC2;MLLT1;SUPT6H;ELP4;CDK7;ELP2;SETD2;MLLT3;...     TPD52L1
 2035  EGLN3;EPAS1;CITED2;PSMB10;NOTCH1;CREBBP;PSMD9;...     TPD52L1
 2036  ERCC2;ERCC5;CUL4A;POLK;CHD1L;DDB1;RFC4;CUL4B;DDB2     TPD52L1

            Guide Direction
 0     TPD52L1_MP        Up
 1     TPD52L1_MP        Up
 2     TPD52L1_MP      Down
 3     TPD52L1_MP      Down
 4     TPD52L1_MP      Down
 ...          ...       ...
 2032  TPD52L1_MP      Down
 2033  TPD52L1_MP      Down
 2034  TPD52L1_MP      Down
 2035  TPD52L1_MP      Down
 2036  TPD52L1_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of T cell activation (GO:0...  0.7990
 1     prerank          cellular glucose homeostasis (GO:0001678)  0.6619
 2     prerank      regulation of cell communication (GO:0010646)  0.7210
 3     prerank  regulation of immune effector process (GO:0002...  0.7640
 4     prerank   regulation of cartilage development (GO:0061035)  0.7532
 ...       ...                                                ...     ...
 2032  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1119
 2033  prerank              mitotic spindle assembly (GO:0090307) -0.1108
 2034  prerank  regulation of cell cycle phase transition (GO:... -0.1016
 2035  prerank                           translation (GO:0006412) -0.0990
 2036  prerank  positive regulation of viral process (GO:0048524) -0.0955

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.9740    0.0000    0.1238     0.0860     9/17  10.15%
 1     1.9367    0.0049    0.1188     0.1570    12/31  16.44%
 2     1.9336    0.0035    0.0838     0.1620     8/22   8.85%
 3     1.8647    0.0000    0.1817     0.4100     6/16   5.94%
 4     1.8612    0.0000    0.1536     0.4300     7/16  10.93%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1730    1.0000    1.0000     1.0000   22/160  26.02%
 2033 -0.1691    1.0000    1.0000     1.0000     4/38  21.53%
 2034 -0.1584    1.0000    1.0000     1.0000    35/85  40.10%
 2035 -0.1521    1.0000    1.0000     1.0000  187/187  90.26%
 2036 -0.1490    1.0000    1.0000     1.0000    53/53  90.50%

                                              Lead_genes Target_Gene  \
 0     HLA-G;JAK3;IL4I1;FOXP3;CD274;FCGR2B;HLA-DRB1;P...     TPD52L1
 1     PPARGC1A;NGFR;PAX2;PIK3R2;NR1D1;PRKAA2;HK2;SLC...     TPD52L1
 2        ANXA1;VEPH1;CXADR;GRK4;CRK;KAZALD1;CAMK2D;MGLL     TPD52L1
 3             HLA-DRA;FCGR2B;SUSD4;PROS1;C5AR1;HLA-DRB1     TPD52L1
 4               BMP2;PTHLH;WNT11;BMPR1B;SCIN;BMP1;TAPT1     TPD52L1
 ...                                                 ...         ...
 2032  DCP1A;PAN2;SAMD4A;DHX34;XRN1;ERI1;MTPAP;XRN2;E...     TPD52L1
 2033                        SPICE1;CLASP2;GOLGA2;WRAP73     TPD52L1
 2034  FBXO5;ZNF16;TFAP4;DBF4B;CDC23;PSMC6;BUB1B;ANAP...     TPD52L1
 2035  IGHMBP2;LARS2;PABPC4;FASTKD2;EEF1E1;GTPBP2;GAT...     TPD52L1
 2036  IFIT1;PKN2;PPARA;VPS4A;TYRO3;ADAR;POLR2F;SRPK1...     TPD52L1

            Guide Direction
 0     TPD52L1_AP        Up
 1     TPD52L1_AP        Up
 2     TPD52L1_AP        Up
 3     TPD52L1_AP        Up
 4     TPD52L1_AP        Up
 ...          ...       ...
 2032  TPD52L1_AP      Down
 2033  TPD52L1_AP      Down
 2034  TPD52L1_AP      Down
 2035  TPD52L1_AP      Down
 2036  TPD52L1_AP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank            regulation of phagocytosis (GO:0050764)  0.8178
 1     prerank          defense response to symbiont (GO:0140546)  0.6071
 2     prerank  positive regulation of response to external st...  0.5984
 3     prerank  positive regulation of response to biotic stim...  0.7314
 4     prerank  negative regulation of microtubule depolymeriz...  0.7270
 ...       ...                                                ...     ...
 2032  prerank           regulation of cell division (GO:0051302) -0.1351
 2033  prerank  regulation of carbohydrate catabolic process (... -0.1338
 2034  prerank       regulation of DNA recombination (GO:0000018) -0.1232
 2035  prerank                 DNA metabolic process (GO:0006259) -0.1199
 2036  prerank  regulation of stem cell differentiation (GO:20... -0.1128

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.0975    0.0000    0.0081     0.0080    5/23   2.34%
 1     1.9453    0.0000    0.0902     0.1390   13/70   7.15%
 2     1.9054    0.0000    0.1270     0.2770    9/63   1.66%
 3     1.8826    0.0000    0.1376     0.3660    3/24   1.66%
 4     1.7658    0.0024    0.5147     0.8480    8/16  18.25%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2260    1.0000    1.0000     1.0000   15/60  29.05%
 2033 -0.2257    1.0000    1.0000     1.0000    4/39  16.19%
 2034 -0.2171    1.0000    1.0000     1.0000   11/27  37.76%
 2035 -0.2081    1.0000    1.0000     1.0000  37/251  21.90%
 2036 -0.1883    1.0000    1.0000     1.0000   22/71  32.61%

                                              Lead_genes Target_Gene   Guide  \
 0                           IL15;TLR2;FCGR2B;CYBA;ABCA7         PKM  PKM_MP
 1     OASL;IFIT1;NLRC5;TLR2;MX2;DDX58;OAS1;ISG15;PLA...         PKM  PKM_MP
 2     OASL;DDX60;IL15;TLR2;IL23A;S100A8;GPSM3;S100A9...         PKM  PKM_MP
 3                                       OASL;DDX60;CYBA         PKM  PKM_MP
 4     TRIM54;FGF13;CAMSAP1;KATNB1;CAMSAP3;CLASP1;MID...         PKM  PKM_MP
 ...                                                 ...         ...     ...
 2032  SMYD5;BBS4;OOEP;FGFR2;TLE6;PRDM15;KLHL21;RAB11...         PKM  PKM_MP
 2033                         SLC2A6;NUP85;NUP155;NUP153         PKM  PKM_MP
 2034  ZRANB3;ALYREF;KDM1A;MSH6;RTEL1;FIGNL1;RAD51AP1...         PKM  PKM_MP
 2035  DFFB;RAD9B;BACH1;POLA1;HELB;PRIMPOL;DNASE1L2;T...         PKM  PKM_MP
 2036  SMYD5;ITCH;NOTCH1;PSMD14;MYB;YTHDF2;PSMB4;HNRN...         PKM  PKM_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                       cell chemotaxis (GO:0060326)  0.6488
 1     prerank  pattern recognition receptor signaling pathway...  0.5592
 2     prerank              apoptotic cell clearance (GO:0043277)  0.6522
 3     prerank          keratinocyte differentiation (GO:0030216)  0.6208
 4     prerank                glial cell development (GO:0021782)  0.6646
 ...       ...                                                ...     ...
 2032  prerank  snRNA transcription by RNA polymerase II (GO:0... -0.1311
 2033  prerank        7-methylguanosine mRNA capping (GO:0006370) -0.1247
 2034  prerank         7-methylguanosine RNA capping (GO:0009452) -0.1247
 2035  prerank                rRNA metabolic process (GO:0016072) -0.1162
 2036  prerank                      ncRNA processing (GO:0034470) -0.0922

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.9173    0.0000    0.2910     0.2090   13/31  15.25%
 1     1.7372    0.0052    1.0000     0.8760   10/36   9.47%
 2     1.6953    0.0000    1.0000     0.9580    6/20   8.80%
 3     1.6617    0.0147    1.0000     0.9910    5/20  10.54%
 4     1.6367    0.0122    1.0000     0.9970    4/17   3.63%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2064    1.0000    1.0000     1.0000   13/66  24.80%
 2033 -0.1949    1.0000    1.0000     1.0000    3/31  19.53%
 2034 -0.1949    1.0000    1.0000     1.0000    3/31  19.53%
 2035 -0.1835    1.0000    1.0000     1.0000  23/150  27.81%
 2036 -0.1448    1.0000    1.0000     1.0000  30/185  28.66%

                                              Lead_genes Target_Gene   Guide  \
 0     CCR10;CCR6;CCR7;HBEGF;PLEKHG5;LEF1;EPHA2;CCL28...         PKM  PKM_AP
 1     CD14;TLR2;S100A9;ALPK1;CTSK;S100A8;IRAK4;TRAF6...         PKM  PKM_AP
 2                      ANXA1;RHOH;ALOX15;XKR6;XKR8;XKR9         PKM  PKM_AP
 3                           ANXA1;CDSN;EPHA2;CSTA;CASP3         PKM  PKM_AP
 4                                 TLR2;S100A9;MDK;CSPG5         PKM  PKM_AP
 ...                                                 ...         ...     ...
 2032  NABP1;SNAPC1;SNAPC2;GTF2A1;INTS1;ELL;TAF6;INTS...         PKM  PKM_AP
 2033                                  GTF2H2;CCNH;CMTR1         PKM  PKM_AP
 2034                                  GTF2H2;CCNH;CMTR1         PKM  PKM_AP
 2035  UTP14A;FCF1;UTP20;EXOSC10;LAS1L;NOL8;BYSL;LYAR...         PKM  PKM_AP
 2036  PUS10;UTP14A;FCF1;UTP20;EXOSC10;LAS1L;NOL8;ZCC...         PKM  PKM_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of immune effector process (GO:0002...  0.7809
 1     prerank  regulation of humoral immune response (GO:0002...  0.7706
 2     prerank  interferon-gamma-mediated signaling pathway (G...  0.5279
 3     prerank  positive regulation of ubiquitin-dependent pro...  0.4835
 4     prerank  cellular nitrogen compound biosynthetic proces...  0.6241
 ...       ...                                                ...     ...
 2032  prerank  regulation of G2/M transition of mitotic cell ... -0.1178
 2033  prerank          mitotic spindle organization (GO:0007052) -0.1137
 2034  prerank            nucleotide-excision repair (GO:0006289) -0.1080
 2035  prerank                     ribosome assembly (GO:0042255) -0.1033
 2036  prerank              mRNA export from nucleus (GO:0006406) -0.1027

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.9562    0.0026    0.1445     0.1190     4/16   2.07%
 1     1.9350    0.0028    0.1032     0.1640     4/17   2.07%
 2     1.6456    0.0140    1.0000     0.9860    17/46  16.79%
 3     1.6301    0.0138    1.0000     0.9930    16/61  20.09%
 4     1.6176    0.0263    1.0000     0.9980     3/20   5.79%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.1870    1.0000    1.0000     1.0000   35/136  30.66%
 2033 -0.1817    1.0000    1.0000     1.0000   42/141  33.07%
 2034 -0.1733    1.0000    1.0000     1.0000  101/101  89.30%
 2035 -0.1651    1.0000    1.0000     1.0000     5/43  24.45%
 2036 -0.1622    1.0000    1.0000     1.0000    41/99  38.60%

                                              Lead_genes Target_Gene     Guide  \
 0                                  C1R;HLA-DRA;C5;C5AR1       XRCC5  XRCC5_MP
 1                                     CCR7;C1R;C5;C5AR1       XRCC5  XRCC5_MP
 2     IRF9;OASL;NCAM1;HLA-DRA;PTAFR;GBP1;CAMK2B;IFNG...       XRCC5  XRCC5_MP
 3     PRICKLE1;TRIB2;DET1;SMAD7;SMURF1;RNF144B;DNAJB...       XRCC5  XRCC5_MP
 4                                      ACER2;ARG2;SPHK2       XRCC5  XRCC5_MP
 ...                                                 ...         ...       ...
 2032  PINX1;PSMB9;PSME3;HAUS8;CEP76;CDC25A;ODF2;CDK5...       XRCC5  XRCC5_MP
 2033  DYNC1I1;SUN2;ARHGEF10;SPC24;B9D2;ZW10;NUP85;CE...       XRCC5  XRCC5_MP
 2034  ERCC8;COPS3;COPS2;COPS7B;ISY1;CUL4A;RFC4;AQR;H...       XRCC5  XRCC5_MP
 2035                         PPAN;BRIX1;MDN1;DHX29;RPF2       XRCC5  XRCC5_MP
 2036  HHEX;GLE1;CPSF4;FYTTD1;MAGOHB;THOC6;NUP85;NUP1...       XRCC5  XRCC5_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of glucose transmembrane t...  0.6837
 1     prerank                   mitotic cytokinesis (GO:0000281)  0.5476
 2     prerank    Golgi to plasma membrane transport (GO:0006893)  0.5210
 3     prerank  positive regulation of organelle organization ...  0.5968
 4     prerank                    glycolytic process (GO:0006096)  0.6117
 ...       ...                                                ...     ...
 2032  prerank          regulation of mRNA stability (GO:0043488) -0.1391
 2033  prerank                         RNA transport (GO:0050658) -0.1362
 2034  prerank  positive regulation of ubiquitin-dependent pro... -0.1300
 2035  prerank                        nuclear export (GO:0051168) -0.1213
 2036  prerank         DNA-dependent DNA replication (GO:0006261) -0.0990

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.7775    0.0000    1.0000     0.7640    5/21   9.37%
 1     1.7647    0.0000    1.0000     0.8120   19/45  19.71%
 2     1.6599    0.0115    1.0000     0.9930   15/42  19.14%
 3     1.6599    0.0137    1.0000     0.9930    7/23  17.77%
 4     1.6350    0.0123    1.0000     0.9960    6/20  14.76%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2325    1.0000    1.0000     1.0000   8/128  10.73%
 2033 -0.2192    1.0000    1.0000     1.0000    7/68  15.93%
 2034 -0.2089    1.0000    1.0000     1.0000   21/61  30.15%
 2035 -0.1959    1.0000    1.0000     1.0000    8/76  15.62%
 2036 -0.1647    1.0000    1.0000     1.0000  39/122  32.40%

                                              Lead_genes Target_Gene     Guide  \
 0                      CLIP3;SORBS1;CLTCL1;NR4A3;CREBL2       XRCC5  XRCC5_AP
 1     ANK3;KIF20A;CIT;CHMP4B;RACGAP1;ANLN;MYH10;ESPL...       XRCC5  XRCC5_AP
 2     BBS2;OPTN;EXOC6B;LLGL1;ANK3;EXOC8;NSF;EXOC2;GG...       XRCC5  XRCC5_AP
 3         PPARGC1A;ANXA1;SMCR8;ATL3;FYCO1;RAB3GAP1;LIG4       XRCC5  XRCC5_AP
 4                        PGAM4;PFKFB2;ENO3;ENO2;HK1;HK2       XRCC5  XRCC5_AP
 ...                                                 ...         ...       ...
 2032  AXIN2;FASTKD3;DCP1A;PSMD9;MEX3D;EXOSC9;SLC11A1...       XRCC5  XRCC5_AP
 2033        SIDT2;THOC1;CDC40;NUP214;MAGOH;MAGOHB;FLOT1       XRCC5  XRCC5_AP
 2034  SIRT2;DVL1;DET1;SMAD7;CEBPA;RNF19B;RAD23A;PRIC...       XRCC5  XRCC5_AP
 2035  RANBP17;THOC1;RITA1;CDC40;NUP214;MAGOH;PHAX;MA...       XRCC5  XRCC5_AP
 2036  WRN;PSMD9;POLE2;PRIMPOL;PRIM1;RPAIN;PURA;POLD1...       XRCC5  XRCC5_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of carbohydrate metabolic ...  0.7801
 1     prerank  positive regulation of ATP metabolic process (...  0.7039
 2     prerank              response to amyloid-beta (GO:1904645) -0.9080
 3     prerank     cellular response to amyloid-beta (GO:1904646) -0.9121
 4     prerank  positive regulation of endopeptidase activity ... -0.9147
 ...       ...                                                ...     ...
 2032  prerank  nucleotide-excision repair, DNA incision, 5&#39;-t... -0.1274
 2033  prerank                      histone exchange (GO:0043486) -0.1254
 2034  prerank  nucleotide-excision repair, DNA incision (GO:0... -0.1274
 2035  prerank    chromatin remodeling at centromere (GO:0031055) -0.1218
 2036  prerank  transcription-coupled nucleotide-excision repa... -0.1147

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.9868    0.0000    0.1477     0.1120   6/15   4.75%
 1     1.9242    0.0000    0.1977     0.2460   6/20   4.75%
 2    -1.7724    0.0087    0.4327     0.3560   6/19   3.04%
 3    -1.7715    0.0088    0.2288     0.3750   6/18   3.04%
 4    -1.7425    0.0072    0.4552     0.7460   3/20   0.94%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2256    1.0000    1.0000     1.0000  37/37  87.31%
 2033 -0.2253    1.0000    1.0000     1.0000   9/34  28.18%
 2034 -0.2252    1.0000    1.0000     1.0000  38/38  87.31%
 2035 -0.2229    1.0000    1.0000     1.0000   6/28  26.55%
 2036 -0.2054    1.0000    1.0000     1.0000  30/73  34.69%

                                              Lead_genes Target_Gene     Guide  \
 0                PRKAA2;PFKFB2;PFKFB4;EGF;MLXIPL;PRKAA1       BRIP1  BRIP1_MP
 1           PRKAA2;PPARGC1A;PFKFB2;PFKFB4;MLXIPL;PRKAA1       BRIP1  BRIP1_MP
 2                     AGER;ATP1A3;LRP1;NGFR;ICAM1;EPHA4       BRIP1  BRIP1_MP
 3                     AGER;ATP1A3;LRP1;NGFR;ICAM1;EPHA4       BRIP1  BRIP1_MP
 4                                        AGER;LYN;EFNA3       BRIP1  BRIP1_MP
 ...                                                 ...         ...       ...
 2032  GTF2H4;NTHL1;RBX1;RPA3;XPA;RFC2;GTF2H5;RPS27A;...       BRIP1  BRIP1_MP
 2033  CENPI;ITGB3BP;RNF8;CENPN;VPS72;CENPW;OIP5;SPTY...       BRIP1  BRIP1_MP
 2034  GTF2H4;NTHL1;RBX1;RPA3;XPA;RFC2;GTF2H5;RPS27A;...       BRIP1  BRIP1_MP
 2035               CENPI;ITGB3BP;CENPV;CENPN;CENPW;OIP5       BRIP1  BRIP1_MP
 2036  GTF2H4;UVSSA;CDK7;ISY1;COPS7B;POLR2F;RBX1;RPA3...       BRIP1  BRIP1_MP

      Direction
 0           Up
 1           Up
 2         Down
 3         Down
 4         Down
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of wound healing (GO:0090303)  0.6488
 1     prerank  negative regulation of oxidative stress-induce...  0.6819
 2     prerank  defense response to Gram-positive bacterium (G...  0.7049
 3     prerank    regulation of spindle organization (GO:0090224)  0.7024
 4     prerank  cellular response to hydrogen peroxide (GO:007...  0.6203
 ...       ...                                                ...     ...
 2032  prerank  regulation of translational initiation (GO:000... -0.1425
 2033  prerank         regulation of mRNA processing (GO:0050684) -0.1384
 2034  prerank  regulation of cellular amine metabolic process... -0.1336
 2035  prerank                        tRNA transport (GO:0051031) -0.1322
 2036  prerank  regulation of cellular amino acid metabolic pr... -0.1287

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.7445    0.0073    1.0000     0.8390   7/25  10.53%
 1     1.7351    0.0000    1.0000     0.8710   5/22  11.45%
 2     1.7175    0.0123    1.0000     0.9120   5/16  12.84%
 3     1.7056    0.0059    1.0000     0.9290   3/16   2.29%
 4     1.6887    0.0037    1.0000     0.9560   6/28  11.45%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.2106    1.0000    1.0000     1.0000   6/59  17.60%
 2033 -0.2019    1.0000    1.0000     1.0000  33/33  86.21%
 2034 -0.1986    1.0000    1.0000     1.0000  19/45  39.25%
 2035 -0.1981    1.0000    1.0000     1.0000  13/34  33.53%
 2036 -0.1911    1.0000    1.0000     1.0000  19/47  39.25%

                                              Lead_genes Target_Gene     Guide  \
 0             ANXA1;HPSE;DMTN;ADRA2A;HBEGF;SMOC2;FERMT1       BRIP1  BRIP1_AP
 1                         GPR37L1;GPR37;FYN;MAPK7;SIRT1       BRIP1  BRIP1_AP
 2                               CAMP;TLR2;LYZ;CHGA;GBP2       BRIP1  BRIP1_AP
 3                                       PARP3;BORA;FSD1       BRIP1  BRIP1_AP
 4                ANXA1;TNFAIP3;MAPK13;MAPK7;OSER1;SIRT1       BRIP1  BRIP1_AP
 ...                                                 ...         ...       ...
 2032            CTIF;IMPACT;GLE1;YTHDF3;EIF4EBP2;EIF4G3       BRIP1  BRIP1_AP
 2033  CPSF4;PTCD2;PABPN1;SRPK1;RBM39;SAFB2;PAPOLA;SF...       BRIP1  BRIP1_AP
 2034  PSME4;PSMB10;PSMD5;PSME3;PSMC6;PSMF1;PSMB7;PSM...       BRIP1  BRIP1_AP
 2035  NUP98;NUP43;NUP35;NUP214;SEC13;NUP37;NUP205;RA...       BRIP1  BRIP1_AP
 2036  PSME4;PSMB10;PSMD5;PSME3;PSMC6;PSMF1;PSMB7;PSM...       BRIP1  BRIP1_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                     ear morphogenesis (GO:0042471)  0.7447
 1     prerank  positive regulation of Ras protein signal tran...  0.6317
 2     prerank  positive regulation of histone acetylation (GO...  0.6812
 3     prerank                       eye development (GO:0001654)  0.5991
 4     prerank  regulation of tyrosine phosphorylation of STAT...  0.5792
 ...       ...                                                ...     ...
 2032  prerank    ribosomal large subunit biogenesis (GO:0042273) -0.1426
 2033  prerank               RNA export from nucleus (GO:0006405) -0.1201
 2034  prerank                       mRNA processing (GO:0006397) -0.1177
 2035  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1144
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1137

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8151    0.0000    1.0000     0.6220     6/15  11.23%
 1     1.8095    0.0034    0.6555     0.6530     5/30   3.02%
 2     1.7301    0.0027    1.0000     0.9200     7/21  16.04%
 3     1.7161    0.0102    1.0000     0.9480     8/34  10.32%
 4     1.7152    0.0000    0.8178     0.9490     5/34   2.87%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2331    1.0000    1.0000     1.0000    14/52  31.98%
 2033 -0.2031    1.0000    1.0000     1.0000    20/97  26.67%
 2034 -0.1983    1.0000    1.0000     1.0000  101/284  37.10%
 2035 -0.1908    1.0000    1.0000     1.0000   45/121  40.59%
 2036 -0.1888    1.0000    1.0000     1.0000  160/160  88.79%

                                              Lead_genes Target_Gene     Guide  \
 0                   ATP6V1B1;PAX2;NOG;PAX8;TWIST1;EPHB2       GATA3  GATA3_MP
 1                        RASGRF1;LYN;COL3A1;RTN4R;AUTS2       GATA3  GATA3_MP
 2             PPARGC1A;MUC1;FOXP3;PIH1D1;SPHK2;LIF;KAT7       GATA3  GATA3_MP
 3     CACNA1C;COL5A2;CPAMD8;PAX2;BMPR1B;SH3PXD2B;BLO...       GATA3  GATA3_MP
 4                             IL15;LYN;PTK6;ERBB4;PIBF1       GATA3  GATA3_MP
 ...                                                 ...         ...       ...
 2032  SDAD1;MDN1;RPL26L1;RSL24D1;RPF1;PES1;NSA2;EIF6...       GATA3  GATA3_MP
 2033  POLDIP3;NUP62CL;U2AF1L4;NUP205;MCM3AP;SEH1L;NU...       GATA3  GATA3_MP
 2034  SNIP1;ZCCHC8;POLDIP3;CMTR1;DHX35;RBM4B;RBM6;CD...       GATA3  GATA3_MP
 2035  SNUPN;GEMIN5;MDN1;EIF2D;ISY1;NCBP1;RSL24D1;DDX...       GATA3  GATA3_MP
 2036  SAMD4A;DIS3L2;CNOT3;RC3H1;EXOSC10;MTPAP;DHX34;...       GATA3  GATA3_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  negative regulation of protein-containing comp...  0.5840
 1     prerank                 transferrin transport (GO:0033572)  0.5792
 2     prerank           neuron projection extension (GO:1990138)  0.6619
 3     prerank  negative regulation of protein binding (GO:003...  0.5379
 4     prerank  negative regulation of signaling receptor acti...  0.6829
 ...       ...                                                ...     ...
 2032  prerank  termination of RNA polymerase II transcription... -0.1564
 2033  prerank  regulation of protein targeting to mitochondri... -0.1524
 2034  prerank  SCF-dependent proteasomal ubiquitin-dependent ... -0.1513
 2035  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1411
 2036  prerank  mitochondrial ATP synthesis coupled electron t... -0.1020

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8907    0.0000    0.5124     0.3420    9/35  13.77%
 1     1.8435    0.0061    0.4452     0.5130    3/29   4.09%
 2     1.8246    0.0000    0.3641     0.5930    7/23  11.63%
 3     1.8191    0.0000    0.2871     0.6080    6/50   4.96%
 4     1.7919    0.0000    0.3113     0.7010    2/17   0.14%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2282    1.0000    1.0000     1.0000   21/34  46.33%
 2033 -0.2262    1.0000    1.0000     1.0000   11/33  39.46%
 2034 -0.2235    1.0000    1.0000     1.0000   33/76  42.11%
 2035 -0.2075    1.0000    1.0000     1.0000  22/112  28.17%
 2036 -0.1501    1.0000    1.0000     1.0000   27/65  49.84%

                                              Lead_genes Target_Gene     Guide  \
 0     DKK1;OPRD1;LDLRAD4;SORL1;PMEPA1;SMAD6;SVIP;PRK...       GATA3  GATA3_AP
 1                                 HFE;ATP6V0A4;ATP6V1B1       GATA3  GATA3_AP
 2             FLRT3;NRP2;SLC9A6;MAP1B;ALCAM;SPG11;AUTS2       GATA3  GATA3_AP
 3                       HFE;DKK1;EFHB;SORL1;IFIT1;TTBK2       GATA3  GATA3_AP
 4                                              HFE;CBLC       GATA3  GATA3_AP
 ...                                                 ...         ...       ...
 2032  CSTF3;SYMPK;CLP1;MED18;CSTF2;CPSF4;PCF11;NCBP1...       GATA3  GATA3_AP
 2033  FZD5;ATG13;SAE1;FBXW7;HAX1;USP36;CSNK2A2;UBE2J...       GATA3  GATA3_AP
 2034  FBXO31;FBXO48;FBXW4;FBXL6;PSMF1;FBXL8;PSME4;AM...       GATA3  GATA3_AP
 2035  PKP1;MOV10;NUP214;RC3H1;PSMF1;DCP1A;PNPT1;ZC3H...       GATA3  GATA3_AP
 2036  COX10;NDUFA9;NDUFAF1;SDHD;COA6;COX6C;NDUFS3;UQ...       GATA3  GATA3_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  regulation of chromosome organization (GO:0033...  0.5132
 1     prerank  DNA synthesis involved in DNA repair (GO:0000731)  0.3593
 2     prerank  alternative mRNA splicing, via spliceosome (GO...  0.6121
 3     prerank  regulation of histone H3-K4 methylation (GO:00...  0.4924
 4     prerank  establishment of mitotic spindle localization ...  0.4745
 ...       ...                                                ...     ...
 2032  prerank  cotranslational protein targeting to membrane ... -0.3215
 2033  prerank  positive regulation of B cell activation (GO:0... -0.3273
 2034  prerank  anaphase-promoting complex-dependent catabolic... -0.2912
 2035  prerank  regulation of cellular amide metabolic process...  0.2290
 2036  prerank  positive regulation of translational initiatio... -0.2721

          NES NOM p-val FDR q-val FWER p-val  Tag %  Gene %  \
 0     1.7069    0.0000    0.7312     0.0690   8/20  17.69%
 1     1.5629    0.0000    1.0000     0.2190   8/37  10.74%
 2     1.5396    0.0500    1.0000     0.2610  10/15  28.55%
 3     1.4392    0.0000    1.0000     0.4220   7/17  26.26%
 4     1.2647    0.0000    1.0000     0.7230   9/26  16.90%
 ...      ...       ...       ...        ...    ...     ...
 2032 -0.4659    1.0000    1.0000     1.0000  75/92  55.47%
 2033 -0.4632    1.0000    1.0000     1.0000   1/22  21.93%
 2034 -0.4223    1.0000    1.0000     1.0000  13/77  32.81%
 2035  0.3775    1.0000    1.0000     0.9980  26/26  77.15%
 2036 -0.3763    0.9990    0.9999     1.0000   4/15  33.81%

                                              Lead_genes Target_Gene    Guide  \
 0             SETMAR;SMG6;BUB1;SMG5;PIF1;LIG4;UPF1;MAPT        ARNT  ARNT_MP
 1         POLH;ISG15;SIRT1;USP43;UBE2L6;POLK;POLI;SPRTN        ARNT  ARNT_MP
 2     SCNM1;RSRC1;HNRNPM;DDX17;DHX9;DDX5;CDK13;SLU7;...        ARNT  ARNT_MP
 3          AUTS2;PAXIP1;PIH1D1;SMAD4;KDM1A;CTNNB1;WDR61        ARNT  ARNT_MP
 4     ESPL1;UBXN2B;NDC80;CLASP2;PAFAH1B1;PLK1;CDK5RA...        ARNT  ARNT_MP
 ...                                                 ...         ...      ...
 2032  SEC61A1;SRP19;ARL6IP1;RPS5;RPLP2;RPL12;UBA52;R...        ARNT  ARNT_MP
 2033                                               CD74        ARNT  ARNT_MP
 2034  PSMB9;ANAPC10;PSME4;PSME3;CDC16;PSMD1;PSMC2;PS...        ARNT  ARNT_MP
 2035  SAMD8;METTL18;METAP1;PICALM;ATXN2;RBM4B;PKP3;P...        ARNT  ARNT_MP
 2036                            MTOR;HABP4;LARP1;POLR2G        ARNT  ARNT_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035        Up
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  establishment of protein localization to extra...  0.7338
 1     prerank  peptidyl-L-cysteine S-palmitoylation (GO:0018230)  0.7035
 2     prerank  peptidyl-S-diacylglycerol-L-cysteine biosynthe...  0.7035
 3     prerank                protein palmitoylation (GO:0018345)  0.6453
 4     prerank                     protein secretion (GO:0009306)  0.5894
 ...       ...                                                ...     ...
 2032  prerank  regulation of mRNA catabolic process (GO:0061013) -0.1379
 2033  prerank  regulation of stem cell differentiation (GO:20... -0.1376
 2034  prerank  internal peptidyl-lysine acetylation (GO:0018393) -0.1317
 2035  prerank  positive regulation of protein dephosphorylati... -0.1305
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1203

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     2.0506    0.0000    0.0511     0.0350    7/27  10.01%
 1     1.8854    0.0031    0.1821     0.3240    5/20   7.82%
 2     1.8854    0.0031    0.1821     0.3240    5/20   7.82%
 3     1.8294    0.0036    0.2833     0.5530    7/26   7.82%
 4     1.8044    0.0048    0.3132     0.6650   11/38  10.01%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2245    1.0000    1.0000     1.0000  40/112  39.54%
 2033 -0.2225    1.0000    1.0000     1.0000    8/71  20.83%
 2034 -0.2206    1.0000    1.0000     1.0000    4/24  25.39%
 2035 -0.2146    1.0000    1.0000     1.0000    7/25  32.86%
 2036 -0.1961    1.0000    1.0000     1.0000  20/160  25.02%

                                              Lead_genes Target_Gene    Guide  \
 0          TVP23C;RCN3;TANGO6;STEAP3;MON1A;TVP23B;RAB12        ARNT  ARNT_AP
 1                  CLIP3;GOLGA7B;ZDHHC18;ZDHHC11;ZDHHC3        ARNT  ARNT_AP
 2                  CLIP3;GOLGA7B;ZDHHC18;ZDHHC11;ZDHHC3        ARNT  ARNT_AP
 3     CLIP3;GOLGA7B;ZDHHC18;PORCN;ZDHHC17;ZDHHC11;ZD...        ARNT  ARNT_AP
 4     TVP23C;RCN3;ANXA1;TANGO6;MAFA;STEAP3;PORCN;MON...        ARNT  ARNT_AP
 ...                                                 ...         ...      ...
 2032  ZC3H14;GTPBP1;PCBP4;RC3H1;IGF2BP2;NUP214;PSMD5...        ARNT  ARNT_AP
 2033  NOTCH1;PSMD5;METTL3;ITCH;SETD1A;PSME3;PSMD14;N...        ARNT  ARNT_AP
 2034                              KAT6A;BAG6;KAT5;KAT6B        ARNT  ARNT_AP
 2035            SYMPK;DLC1;MAGI2;CDCA2;PIN1;PTBP1;SPPL3        ARNT  ARNT_AP
 2036  SMG6;CTIF;SMG8;PAN2;CNOT10;RC3H1;SMG1;SAMD4A;M...        ARNT  ARNT_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank                        axon extension (GO:0048675)  0.7486
 1     prerank  regulation of cellular protein localization (G...  0.5979
 2     prerank  negative regulation of protein tyrosine kinase...  0.6975
 3     prerank           striated muscle contraction (GO:0006941)  0.7055
 4     prerank  positive regulation of G1/S transition of mito...  0.6483
 ...       ...                                                ...     ...
 2032  prerank  regulation of transcription from RNA polymeras... -0.1286
 2033  prerank                recombinational repair (GO:0000725) -0.1249
 2034  prerank         DNA-dependent DNA replication (GO:0006261) -0.1256
 2035  prerank  interleukin-1-mediated signaling pathway (GO:0... -0.1135
 2036  prerank  transcription-coupled nucleotide-excision repa... -0.1091

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8535    0.0028    0.7687     0.3950    6/17   5.75%
 1     1.8449    0.0057    0.4327     0.4290    9/41   8.20%
 2     1.7521    0.0034    0.9106     0.8220    4/20   5.21%
 3     1.7137    0.0030    1.0000     0.9220    4/15   6.85%
 4     1.7019    0.0032    0.9201     0.9410    3/21   8.90%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1954    1.0000    1.0000     1.0000   28/75  38.25%
 2033 -0.1936    1.0000    1.0000     1.0000    6/68  17.17%
 2034 -0.1930    1.0000    1.0000     1.0000  43/122  37.97%
 2035 -0.1720    1.0000    1.0000     1.0000   27/80  37.64%
 2036 -0.1691    1.0000    1.0000     1.0000   24/73  35.64%

                                              Lead_genes Target_Gene     Guide  \
 0                    SLIT2;SLC9A6;MAP1B;AUTS2;ULK1;NRP2       RBM47  RBM47_MP
 1     HFE;TRIM46;MAP2;PRKAA2;GPC3;MAP1A;RAB11FIP5;GP...       RBM47  RBM47_MP
 2                                CBLC;PTK6;SH3BP5L;CBLB       RBM47  RBM47_MP
 3                           SCN5A;KCNH2;ARHGEF11;CCDC78       RBM47  RBM47_MP
 4                                      ANXA1;EGFR;LSM10       RBM47  RBM47_MP
 ...                                                 ...         ...       ...
 2032  ATF3;LIMD1;BACH1;STOX1;PSMD5;MAPK7;DDIT3;PSMD1...       RBM47  RBM47_MP
 2033              MCM9;SAMHD1;NABP1;RAD51B;SMC5;ZFYVE26       RBM47  RBM47_MP
 2034  PRIMPOL;MCMDC2;TEFM;PSMD5;ORC6;MCM10;WDHD1;POL...       RBM47  RBM47_MP
 2035  NOD1;IL1R1;PSMD5;IRAK4;TRAF6;PSMD14;EGR1;PSME3...       RBM47  RBM47_MP
 2036  POLK;COPS7A;POLR2A;COPS4;POLR2B;XRCC1;LIG1;PCN...       RBM47  RBM47_MP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  positive regulation of chemokine production (G...  0.6575
 1     prerank  regulation of plasma membrane bounded cell pro...  0.6599
 2     prerank                       mismatch repair (GO:0006298)  0.6039
 3     prerank  negative regulation of microtubule polymerizat...  0.6068
 4     prerank  positive regulation of B cell activation (GO:0...  0.6134
 ...       ...                                                ...     ...
 2032  prerank  cellular response to ionizing radiation (GO:00... -0.1443
 2033  prerank           nucleocytoplasmic transport (GO:0006913) -0.1449
 2034  prerank  negative regulation of mitotic cell cycle phas... -0.1461
 2035  prerank  regulation of stem cell differentiation (GO:20... -0.1112
 2036  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.0874

          NES NOM p-val FDR q-val FWER p-val    Tag %  Gene %  \
 0     1.8100    0.0043    1.0000     0.6040     8/24   9.04%
 1     1.7165    0.0150    1.0000     0.9030     4/18   2.31%
 2     1.6937    0.0267    1.0000     0.9450     4/27   6.56%
 3     1.6907    0.0047    1.0000     0.9480     4/24   2.39%
 4     1.6492    0.0124    1.0000     0.9840     5/22   7.98%
 ...      ...       ...       ...        ...      ...     ...
 2032 -0.2166    1.0000    1.0000     1.0000    12/43  33.25%
 2033 -0.2163    1.0000    1.0000     1.0000    16/38  38.10%
 2034 -0.2153    1.0000    1.0000     1.0000     2/74   5.17%
 2035 -0.1633    1.0000    1.0000     1.0000    14/71  31.85%
 2036 -0.1284    1.0000    1.0000     1.0000  158/160  84.51%

                                              Lead_genes Target_Gene     Guide  \
 0               CD74;TWIST1;TLR2;OAS1;HMOX1;MAVS;MBP;C5       RBM47  RBM47_AP
 1                            NTNG1;FCGR2B;FRMD7;CCDC88A       RBM47  RBM47_AP
 2                                  TREX1;MSH5;MLH3;MCM9       RBM47  RBM47_AP
 3                               TRIM54;CLIP3;FGF13;MAP2       RBM47  RBM47_AP
 4                         CD74;CLCF1;TP53BP1;IRS2;EPHB2       RBM47  RBM47_AP
 ...                                                 ...         ...       ...
 2032  MAPK14;SPIDR;ATR;RAD9A;RAD51AP1;TLK2;BLM;INO80...       RBM47  RBM47_AP
 2033  SNUPN;AAAS;HTATIP2;NXT2;SMN1;NEMF;DDX20;GEMIN2...       RBM47  RBM47_AP
 2034                                      DCUN1D3;PINX1       RBM47  RBM47_AP
 2035  ITCH;OCIAD1;SETD1A;PUS7;TCF12;METTL3;LMO1;ABL1...       RBM47  RBM47_AP
 2036  DIS3L2;RC3H1;PAN3;EXOSC10;HELZ2;DCP1A;PDE12;SM...       RBM47  RBM47_AP

      Direction
 0           Up
 1           Up
 2           Up
 3           Up
 4           Up
 ...        ...
 2032      Down
 2033      Down
 2034      Down
 2035      Down
 2036      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank             cellular response to heat (GO:0034605)  0.6931
 1     prerank  positive regulation of MAP kinase activity (GO...  0.5790
 2     prerank                         wound healing (GO:0042060)  0.5583
 3     prerank              regulation of exocytosis (GO:0017157)  0.6004
 4     prerank  regulation of cardiac muscle cell action poten...  0.6774
 ...       ...                                                ...     ...
 2032  prerank                      ncRNA processing (GO:0034470) -0.1146
 2033  prerank    ribonucleoprotein complex assembly (GO:0022618) -0.1134
 2034  prerank  positive regulation of establishment of protei... -0.1137
 2035  prerank  nuclear-transcribed mRNA catabolic process (GO... -0.1075
 2036  prerank  negative regulation of G2/M transition of mito... -0.0868

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8975    0.0000    0.3280     0.2060    6/31  10.94%
 1     1.7393    0.0000    1.0000     0.8490   13/44  10.14%
 2     1.7031    0.0043    1.0000     0.9460   15/45  16.83%
 3     1.6987    0.0138    1.0000     0.9530    5/32   7.55%
 4     1.6978    0.0081    0.9657     0.9550    4/18   4.03%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.1869    1.0000    1.0000     1.0000  15/185  15.95%
 2033 -0.1840    1.0000    1.0000     1.0000  23/121  27.13%
 2034 -0.1801    1.0000    1.0000     1.0000   18/52  33.38%
 2035 -0.1752    1.0000    1.0000     1.0000  12/160  18.82%
 2036 -0.1370    1.0000    1.0000     1.0000   23/56  38.71%

                                              Lead_genes Target_Gene  \
 0                      ANO1;HSPA6;TRPV4;HMOX1;MAPT;SLU7      NAP1L1
 1     FLT1;MAP3K10;DIRAS2;DIRAS1;PDGFC;TNFRSF11A;TRA...      NAP1L1
 2     COL3A1;HPSE;NOG;GATA4;HMOX1;EPB41L4B;RAB3A;PLE...      NAP1L1
 3                        ANXA1;CADPS2;CADPS;RAB8B;RAB3A      NAP1L1
 4                            CACNA1C;FGF13;RANGRF;CXADR      NAP1L1
 ...                                                 ...         ...
 2032  INTS9;FARS2;SMAD1;RCL1;TEX10;AGO1;AGO3;FCF1;MR...      NAP1L1
 2033  RBM5;CLP1;ABT1;SMN1;DDX39B;BOP1;SETX;ERAL1;DDX...      NAP1L1
 2034  SREBF2;BAP1;USP36;UBE2L3;CSNK2A2;ATG13;NMT1;GS...      NAP1L1
 2035  DCP1A;SAMD4A;AGO1;PAN3;MTPAP;ATM;CNOT10;SMG6;E...      NAP1L1
 2036  PINX1;NABP1;USP47;VPS4A;PSMD11;PSMD7;PSMD1;AVE...      NAP1L1

           Guide Direction
 0     NAP1L1_MP        Up
 1     NAP1L1_MP        Up
 2     NAP1L1_MP        Up
 3     NAP1L1_MP        Up
 4     NAP1L1_MP        Up
 ...         ...       ...
 2032  NAP1L1_MP      Down
 2033  NAP1L1_MP      Down
 2034  NAP1L1_MP      Down
 2035  NAP1L1_MP      Down
 2036  NAP1L1_MP      Down

 [2037 rows x 13 columns],
          Name                                               Term      ES  \
 0     prerank  activation of protein kinase B activity (GO:00...  0.7264
 1     prerank    positive regulation of endocytosis (GO:0045807)  0.6708
 2     prerank  positive regulation of lymphocyte proliferatio...  0.6461
 3     prerank  positive regulation of lipid kinase activity (...  0.7179
 4     prerank  positive regulation of wound healing (GO:0090303)  0.6357
 ...       ...                                                ...     ...
 2032  prerank        mRNA splicing, via spliceosome (GO:0000398) -0.1359
 2033  prerank  RNA splicing, via transesterification reaction... -0.1317
 2034  prerank  microtubule cytoskeleton organization involved... -0.1277
 2035  prerank  negative regulation of gene expression, epigen... -0.1235
 2036  prerank         Fc receptor signaling pathway (GO:0038093) -0.0915

          NES NOM p-val FDR q-val FWER p-val   Tag %  Gene %  \
 0     1.8941    0.0000    0.5093     0.2820    9/20  17.31%
 1     1.8580    0.0000    0.4240     0.4220    8/28   9.90%
 2     1.8066    0.0037    0.5482     0.6460    4/28   1.05%
 3     1.7655    0.0088    0.6687     0.8260    5/16   6.71%
 4     1.7643    0.0034    0.5406     0.8300   11/25  22.74%
 ...      ...       ...       ...        ...     ...     ...
 2032 -0.2175    1.0000    1.0000     1.0000  60/260  33.44%
 2033 -0.2110    1.0000    1.0000     1.0000  37/239  27.42%
 2034 -0.2085    1.0000    1.0000     1.0000  22/116  24.55%
 2035 -0.2029    1.0000    1.0000     1.0000   22/22  87.68%
 2036 -0.1480    1.0000    1.0000     1.0000   13/93  26.55%

                                              Lead_genes Target_Gene  \
 0     NTRK3;CCDC88A;PRR5;ADRA2A;ADRA2C;MLST8;GAS6;PI...      NAP1L1
 1             HFE;LRP1;CLIP3;APOE;GPC3;F2RL1;APPL2;DLL1      NAP1L1
 2                                  ANXA1;IL15;JAK3;CD74      NAP1L1
 3                            CCR7;PTK2B;FLT1;PRKD1;FLT3      NAP1L1
 4     ANXA1;HPSE;HBEGF;ADRA2A;FERMT2;FERMT1;CLDN1;PR...      NAP1L1
 ...                                                 ...         ...
 2032  USP49;CWF19L2;ELAVL2;RBM41;SMN1;DHX35;U2AF1;U2...      NAP1L1
 2033  USP49;CWF19L2;ELAVL2;RBM41;DHX35;U2AF1;U2AF1L4...      NAP1L1
 2034  DYNC1I1;KNTC1;CENPI;BUB1;NEK6;DCTN6;INCENP;KIF...      NAP1L1
 2035  MTF2;JARID2;MPHOSPH8;DNMT3B;DNMT3A;EED;SUZ12;C...      NAP1L1
 2036  TEC;LYN;TRAF6;PSME4;MALT1;PSMD9;TAB2;PSMD10;PL...      NAP1L1

           Guide Direction
 0     NAP1L1_AP        Up
 1     NAP1L1_AP        Up
 2     NAP1L1_AP        Up
 3     NAP1L1_AP        Up
 4     NAP1L1_AP        Up
 ...         ...       ...
 2032  NAP1L1_AP      Down
 2033  NAP1L1_AP      Down
 2034  NAP1L1_AP      Down
 2035  NAP1L1_AP      Down
 2036  NAP1L1_AP      Down

 [2037 rows x 13 columns]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gsea_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">gsea_results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gsea_results</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">gsea_results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">successful_guides</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;guide_id&quot;</span><span class="p">][</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;successfulKD&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;True&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#filter for only genes in the whippet siuccessful KD</span>
<span class="n">gsea_results_df</span> <span class="o">=</span> <span class="n">gsea_results_df</span><span class="p">[</span><span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">successful_guides</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Clean up pathway names a bit (optional)</span>
<span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;Pathway&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;Term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot; Homo sapiens.*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;Condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;P1&quot;</span> <span class="k">if</span> <span class="s2">&quot;_MP&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">else</span> <span class="s2">&quot;P2&quot;</span><span class="p">)</span>

<span class="c1"># Filter to significant pathways</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">gsea_results_df</span><span class="p">[(</span><span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;NOM p-val&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gsea_results_df</span><span class="p">[</span><span class="s2">&quot;FDR q-val&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Keep only pathways that appear in ‚â•2 target genes (shared)</span>
<span class="n">pathway_counts</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Pathway&quot;</span><span class="p">)[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">shared_pathways</span> <span class="o">=</span> <span class="n">pathway_counts</span><span class="p">[</span><span class="n">pathway_counts</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">sig_shared</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="n">sig</span><span class="p">[</span><span class="s2">&quot;Pathway&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">shared_pathways</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># This is your ‚Äúsignificant shared list‚Äù</span>
<span class="n">sig_shared</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;significant_shared_pathways.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sig_shared</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="c1">#save sig</span>
<span class="n">sig</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;figures/significant_genes.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          Name                                               Term      ES  \
4075   prerank  positive regulation of potassium ion transport...  0.7394
8155   prerank  positive regulation of cellular component move... -0.9718
8160   prerank  negative regulation of endopeptidase activity ... -0.9330
10185  prerank  positive regulation of biosynthetic process (G...  0.7262
16299  prerank  positive regulation of phospholipase activity ... -0.9546

          NES NOM p-val FDR q-val FWER p-val Tag % Gene %  \
4075   1.8924    0.0025    0.2356     0.2740  4/16  5.02%
8155  -1.6374    0.0000    0.0601     0.0600  3/15  0.59%
8160  -1.6019    0.0064    0.1928     0.4290  5/20  2.34%
10185  1.9967    0.0000    0.0651     0.0590  5/25  3.00%
16299 -1.6885    0.0050    0.1416     0.1250  3/15  1.78%

                                   Lead_genes Target_Gene     Guide Direction  \
4075              GABBR2;ADRA2A;KCNMB4;KCNMB3         SP1    SP1_MP        Up
8155                          TWIST1;CCR7;LYN       TGIF1  TGIF1_MP      Down
8160   SERPINB8;RECK;SERPINI1;SPINK2;SERPINE2       TGIF1  TGIF1_MP      Down
10185        MLXIPL;CREB3L1;SORBS1;SIRT4;WNT4       TGIF1  TGIF1_AP        Up
16299                        FLT1;NTRK3;AGTR1        P4HB   P4HB_MP      Down

                                                 Pathway Condition
4075   positive regulation of potassium ion transport...        P1
8155   positive regulation of cellular component move...        P1
8160   negative regulation of endopeptidase activity ...        P1
10185  positive regulation of biosynthetic process (G...        P2
16299  positive regulation of phospholipase activity ...        P1
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#use pathway_counts to count the number of pathways with the number fo genes</span>
<span class="n">pathway_counts_count</span> <span class="o">=</span> <span class="n">pathway_counts</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">pathway_counts_count</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">pathway_counts_count</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of Gene Ontology Biological Process Pathways&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Pseudobulk Perturbations per Pathway&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:matplotlib.category:Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
/var/folders/r_/bqnt2f_d6919cz7v1yzx2ykc0000gn/T/ipykernel_22880/1666908462.py:5: FutureWarning:

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(y=pathway_counts_count.values, x=pathway_counts_count.index, palette=&#34;viridis&#34;)
INFO:matplotlib.category:Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_25_1.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_25_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find the average difference NES between P1 and P2 for each gene</span>
<span class="n">nes_diff_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">sig</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">gene_df</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="n">sig</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gene</span><span class="p">]</span>
    <span class="c1"># separate P1 and P2</span>
    <span class="n">p1_df</span> <span class="o">=</span> <span class="n">gene_df</span><span class="p">[</span><span class="n">gene_df</span><span class="p">[</span><span class="s2">&quot;Condition&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;P1&quot;</span><span class="p">]</span>
    <span class="n">p2_df</span> <span class="o">=</span> <span class="n">gene_df</span><span class="p">[</span><span class="n">gene_df</span><span class="p">[</span><span class="s2">&quot;Condition&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;P2&quot;</span><span class="p">]</span>

    <span class="c1">#just calculate thge mean NES difference</span>
    <span class="n">mean_nes_p1</span> <span class="o">=</span> <span class="n">p1_df</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">mean_nes_p2</span> <span class="o">=</span> <span class="n">p2_df</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">nes_diff</span> <span class="o">=</span> <span class="n">mean_nes_p1</span> <span class="o">-</span> <span class="n">mean_nes_p2</span>
    <span class="n">nes_diff_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Target_Gene&quot;</span><span class="p">:</span> <span class="n">gene</span><span class="p">,</span>
        <span class="s2">&quot;Mean_NES_P1&quot;</span><span class="p">:</span> <span class="n">mean_nes_p1</span><span class="p">,</span>
        <span class="s2">&quot;Mean_NES_P2&quot;</span><span class="p">:</span> <span class="n">mean_nes_p2</span><span class="p">,</span>
        <span class="s2">&quot;NES_Difference&quot;</span><span class="p">:</span> <span class="n">nes_diff</span>
    <span class="p">})</span>
<span class="n">nes_diff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">nes_diff_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nes_diff_df</span><span class="p">)</span>
<span class="c1">#plot the NES difference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1">#order difference nes_diff_df</span>
<span class="n">nes_diff_df</span> <span class="o">=</span> <span class="n">nes_diff_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;NES_Difference&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#remove genes with nan values</span>
<span class="n">nes_diff_df</span> <span class="o">=</span> <span class="n">nes_diff_df</span><span class="p">[</span><span class="n">nes_diff_df</span><span class="p">[</span><span class="s2">&quot;NES_Difference&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nes_diff_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;NES_Difference&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Target Gene&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean NES Difference (P1 - P2)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average NES Difference Between P1 and P2 Across Shared Pathways&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1">#save as a pdf</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;figures/mean_NES_difference_P1_P2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   Target_Gene  Mean_NES_P1  Mean_NES_P2  NES_Difference
0          SP1       1.8865          NaN             NaN
1        TGIF1      -1.6060       1.9967         -3.6027
2         P4HB      -1.6885          NaN             NaN
3        NCOR2          NaN      -1.6075             NaN
4       JARID2      -1.4687      -1.6524          0.1836
5         ESR1       1.9448       0.7594          1.1854
6        PA2G4      -1.6153          NaN             NaN
7        GPBP1          NaN       1.9496             NaN
8        DHX30          NaN      -0.2122             NaN
9         SAFB          NaN      -1.4168             NaN
10        CHD8          NaN      -1.5998             NaN
11       SIN3A      -0.9079      -1.7137          0.8058
12       PSMC5      -1.7132       1.8945         -3.6077
13      GTF2F1       1.9189      -1.5914          3.5103
14        ADAR      -0.8903          NaN             NaN
15       NR2F2      -1.5661          NaN             NaN
16        BZW1       1.0284      -1.5607          2.5891
17         SET      -0.4655          NaN             NaN
18     MYBBP1A       1.8961      -1.6009          3.4971
19        CUX1       1.9624       2.0318         -0.0695
20         NBN          NaN       1.8661             NaN
21        CALR       1.5437          NaN             NaN
22       STAG2          NaN      -1.6416             NaN
23         PKM       1.2322      -1.5604          2.7926
24       BRIP1       0.7132      -1.5030          2.2162
25       GATA3          NaN      -1.4402             NaN
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/r_/bqnt2f_d6919cz7v1yzx2ykc0000gn/T/ipykernel_22880/2520638475.py:27: FutureWarning:

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(data=nes_diff_df, x=&#34;Target_Gene&#34;, y=&#34;NES_Difference&#34;, palette=&#34;coolwarm&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_26_2.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_26_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#run for a single gene</span>
<span class="k">for</span> <span class="n">gene_of_interest</span> <span class="ow">in</span> <span class="n">nes_diff_df</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">gsea_esr1_df</span><span class="p">,</span><span class="n">pre_res_ap</span><span class="p">,</span> <span class="n">pre_res_mp</span> <span class="o">=</span> <span class="n">run_gsea_for_gene</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">gene_of_interest</span><span class="p">)</span>
    <span class="c1">#add together res2d from pre_res_ap and pre_res_mp</span>
    <span class="n">pre_res_ap</span><span class="o">.</span><span class="n">res2d</span><span class="p">[</span><span class="s2">&quot;Promoter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;P2&quot;</span>
    <span class="n">pre_res_mp</span><span class="o">.</span><span class="n">res2d</span><span class="p">[</span><span class="s2">&quot;Promoter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;P1&quot;</span>
    <span class="n">combined_res2d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pre_res_ap</span><span class="o">.</span><span class="n">res2d</span><span class="p">,</span> <span class="n">pre_res_mp</span><span class="o">.</span><span class="n">res2d</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">gseapy.scipalette</span><span class="w"> </span><span class="kn">import</span> <span class="n">SciPalette</span>
    <span class="n">sci</span> <span class="o">=</span> <span class="n">SciPalette</span><span class="p">()</span>
    <span class="n">NbDr</span> <span class="o">=</span> <span class="n">sci</span><span class="o">.</span><span class="n">create_colormap</span><span class="p">()</span>
    <span class="c1">#add new column name &#39;Adjusted P-value&#39; from FDR q-val</span>
    <span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;Adjusted P-value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;NOM p-val&quot;</span><span class="p">]</span>
    <span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;NES&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">,</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span>
    <span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;Promoter_Direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;Promoter&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;Direction&quot;</span><span class="p">]</span>
    <span class="n">combined_res2d</span> <span class="o">=</span> <span class="n">combined_res2d</span><span class="p">[(</span><span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;NOM p-val&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">combined_res2d</span><span class="p">[</span><span class="s2">&quot;FDR q-val&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">dotplot</span><span class="p">(</span><span class="n">combined_res2d</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Promoter_Direction&#39;</span><span class="p">,</span>
                    <span class="n">x_order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;P1_Up&quot;</span><span class="p">,</span><span class="s2">&quot;P1_Down&quot;</span><span class="p">,</span><span class="s2">&quot;P2_Up&quot;</span><span class="p">,</span><span class="s2">&quot;P2_Down&quot;</span><span class="p">],</span>
                    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;GSEA Dotplot for </span><span class="si">{</span><span class="n">gene_of_interest</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">NbDr</span><span class="o">.</span><span class="n">reversed</span><span class="p">(),</span>
                    <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">show_ring</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="c1">#make the size larger for plt.savefig</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gsea_dotplot_</span><span class="si">{</span><span class="n">gene_of_interest</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
    <span class="c1">#save plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_28_0.png" src="../../_images/scripts_3_analysis_scripts_8_perturbseq_differentialexpression_28_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_comp</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">comp_gene_list</span><span class="p">))</span>
<span class="n">all_comp</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">MP</span><span class="o">.</span><span class="n">columns</span>
<span class="n">all_comp</span><span class="p">[</span><span class="s2">&quot;Promoter&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">all_comp</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_comp</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">all_comp</span><span class="p">[</span><span class="s2">&quot;Guide&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">all_comp_mean</span><span class="o">=</span><span class="n">all_comp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;logfoldchanges&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>
<span class="n">all_comp_mean</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">all_comp_mean</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">,</span><span class="s2">&quot;logfoldchanges_mean&quot;</span><span class="p">]</span>
<span class="n">all_comp</span><span class="o">=</span><span class="n">all_comp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_comp_mean</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">)</span>
<span class="n">all_comp_mean</span><span class="o">=</span><span class="n">all_comp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Target_Gene&#39;</span><span class="p">:</span><span class="s2">&quot;count&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">:</span><span class="s2">&quot;Count&quot;</span><span class="p">})</span>
<span class="n">all_comp_mean</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">all_comp</span><span class="o">=</span><span class="n">all_comp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_comp_mean</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">)</span>
<span class="n">all_comp</span><span class="o">=</span><span class="n">all_comp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Guide&quot;</span><span class="p">)</span>
<span class="n">all_comp</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">loc</span><span class="o">+</span><span class="s2">&quot;files/singlecell_shortread_analysis/differential_exp_list_full.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Mutual_Exclusivity&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;Overlap_Gene_Num&quot;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;MP_Gene_Num&quot;</span><span class="p">]</span><span class="o">+</span><span class="nb">all</span><span class="p">[</span><span class="s2">&quot;AP_Gene_Num&quot;</span><span class="p">])</span>

<span class="n">n_term</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;alt-prom-crispr-fiveprime/reference/all_pivot_simple_nterm.txt&quot;</span><span class="p">)</span>
<span class="n">n_term</span><span class="o">=</span><span class="nb">all</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">n_term</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;Gene_symbol&quot;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">)</span>

<span class="n">n_term</span><span class="o">=</span><span class="n">n_term</span><span class="p">[[</span><span class="s2">&quot;MP_Gene_Num&quot;</span><span class="p">,</span><span class="s2">&quot;AP_Gene_Num&quot;</span><span class="p">,</span><span class="s2">&quot;Overlap_Gene_Num&quot;</span><span class="p">,</span><span class="s2">&quot;Mutual_Exclusivity&quot;</span><span class="p">,</span><span class="s2">&quot;Ensembl_ID&quot;</span><span class="p">,</span><span class="s2">&quot;Gene_symbol&quot;</span><span class="p">,</span><span class="s2">&quot;Nterminus_Change&quot;</span><span class="p">]]</span>
<span class="c1"># all_comp_pivot</span>
<span class="n">all_comp_all</span><span class="o">=</span><span class="n">all_comp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">n_term</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Target_Gene&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;Gene_symbol&quot;</span> <span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">all_comp_all</span><span class="o">=</span><span class="n">all_comp_all</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Nterminus_Change&quot;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="7_cellphase_model.html" class="btn btn-neutral float-left" title="Cell Assignment Model from FUCCI-Matched Single-Cell Paper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="9A_cnv_score.html" class="btn btn-neutral float-right" title="Investigating Copy Number Variation Across KD Populations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Helen King.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>